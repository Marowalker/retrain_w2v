
==== Front
Biophys JBiophys. JBiophysical Journal0006-34951542-0086The Biophysical Society S0006-3495(15)01165-010.1016/j.bpj.2015.11.008Cell BiophysicsDisentangling Random Motion and Flow in a Complex Medium Koslover Elena F. 1Chan Caleb K. 1Theriot Julie A. theriot@stanford.edu123∗1 Department of Biochemistry, Stanford University School of Medicine, Stanford, California2 Department of Microbiology and Immunology, Stanford University School of Medicine, Stanford, California3 Howard Hughes Medical Institute, Stanford University School of Medicine, Stanford, California∗ Corresponding author theriot@stanford.edu02 2 2016 02 2 2016 110 3 700 709 20 8 2015 5 11 2015 © 2016 The Authors2016This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).We describe a technique for deconvolving the stochastic motion of particles from large-scale fluid flow in a dynamic environment such as that found in living cells. The method leverages the separation of timescales to subtract out the persistent component of motion from single-particle trajectories. The mean-squared displacement of the resulting trajectories is rescaled so as to enable robust extraction of the diffusion coefficient and subdiffusive scaling exponent of the stochastic motion. We demonstrate the applicability of the method for characterizing both diffusive and fractional Brownian motion overlaid by flow and analytically calculate the accuracy of the method in different parameter regimes. This technique is employed to analyze the motion of lysosomes in motile neutrophil-like cells, showing that the cytoplasm of these cells behaves as a viscous fluid at the timescales examined.

Editor: Douglas Robinson.
==== Body
Introduction
Single-particle tracking has become a widespread method for studying the microrheology of complex fluids, including mucus (1), active gels (2), and the interior of living cells (3, 4). In the latter case, the motion of tracer particles provides valuable information about material properties and active fluctuations in the cytoplasm, as well as how these properties vary with cytoskeletal structure (5), metabolic activity (6, 7), differentiation state (8), and metastatic potential (9).

A common approach to analyzing particle trajectories is to calculate the mean-squared displacement (MSD) of the particles over different time intervals, averaged over time and ensemble of particles. The shape of the MSD curve depends on the material properties of the medium and the time correlation of forces acting upon the particles. For particles subjected to thermal forces in a purely viscous medium, the MSD scales linearly with time as MSD∼t. In a viscoelastic medium, thermally driven particles exhibit fractional Brownian motion with subdiffusive scaling, MSD∼tα, where α<1 (10). In the presence of persistent forces or flows in the medium, the MSD exhibits a superdiffusive component, with a ballistic scaling (MSD∼t2) for constant flows. For long times, strong flows, or large (slowly diffusing) particles, the ballistic motion dominates over the thermal motion of the particle, obscuring the high-frequency component that carries information about the material properties of the medium.

In the context of a complex dynamic environment, such as the interior of a living cell, the stochastic motion of particles is determined by a combination of thermal and actively generated forces as well as the frictional resistance of the medium. Although the relative contribution and time variation of the active forces remains a matter of debate (6, 11, 12), it is acknowledged that studying passive particle motion in a cell yields valuable insight regarding the intracellular physical environment. To quantify such stochastic motion, however, it is necessary first to disentangle it from the bulk, slowly varying flows that can occur in many cell types.

In this work, we present a technique for analyzing the high-frequency stochastic motion of particles under thermal (or similarly correlated) forces in the presence of spatially heterogeneous underlying flow of the medium. Our method, termed BNEW (Brownian noise extracted with wavelets), relies on wavelet analysis (13) to subtract out slowly varying components of the motion from individual particle trajectories. Appropriate rescaling of the remaining data allows for accurate extraction of a diffusion coefficient and scaling exponent, α, even in the presence of significant and complex flow.

As an example application, we study the stochastic motion of lysosomes within the cytoplasm of motile HL60 neutrophil-like cells. Although previous single-particle tracking studies have demonstrated a viscous cytoplasm in some stationary cell types (8, 14) and a viscoelastic one in others (15, 16, 17), the microscopic material properties within such rapidly moving cells remain uncharacterized. HL60 cells crawl on a two-dimensional surface, with significant changes in shape engendering internal flow and deformation of the cytoplasmic contents. This flow of the cytoplasmic medium precludes use of the usual approach to extracting microrheological information from single-particle tracks, but makes this system an ideal candidate for the BNEW method. We use this technique to demonstrate that organelle motion in HL60 cells is consistent with motion through a viscous cytoplasm, with an effective viscosity ∼50 times that of water, over the timescales examined (>50 ms).

Materials and Methods
Culturing of HL60 cells
Neutrophil-like HL60 cells were maintained in RPMI media (22400, Invitrogen, Carlsbad, CA), supplemented with 10% fetal bovine serum (FBS) (Gemini, Elizabeth, NJ) and antibiotic-antimycotic drugs (15240, Gibco, Grand Island, NY). The cultured cells were incubated at 37°C in 5% CO2 and passaged once every 2–3 days to a density of 2×105 cells/mL. To differentiate the HL60 cells, cells were diluted in RPMI full media containing 1.3% dimethylsulfoxide (61097, Acros, Morris Plains, NJ) with an initial density of 2×105 cells/mL. For all experiments, only cells differentiated for 5–6 days were used.

Lysosome labeling in HL60 cells
Before the agarose gel preparation step for the two-dimensional (2D) cell migration assay, about 105 differentiated HL60 cells were spun down at 500×g for 5–10 min and resuspended in 1 mL of L-15 media (21083-027, Gibco). Stock 1m M LysoTracker Deep Red (L12492, Molecular Probes, Eugene, OR) was diluted 1:10 to 100 μM in dimethylsulfoxide, and 1 μL of this 1:10 labeling solution was added to the L-15 cell suspension to reach a final concentration of 100 nM. The label-containing cell suspension was then incubated at 37°C for 30 min before being repelleted at 500×g for 5–10 min and resuspended in 1 mL of L-15 in preparation for being used in the under-agarose assay.

Under-agarose 2D cell migration assay
In this assay, differentiated HL60 cells were confined to migrate in a quasi-2D environment between an agarose pad and a fibronectin-coated coverslip. To cast the agarose pad, we first prepared a 2% low-melting-point agarose solution (16520, Invitrogen) by dissolving the agarose powder in heated L-15 media, and the solution was kept in a 37°C waterbath until use (solution A). We then prepared a 2× stock solution of L-15 media (21083-027, Gibco) with 20% FBS (solution B). f-MLP (F3506, Sigma-Aldrich, St. Louis, MO) was added as a chemoattractant to solution B at a final concentration of 2 nM to induce chemokinesis. Solutions A and B were then mixed at a 1:1 ratio and pipetted immediately to a mold to cast the agarose pad. The agarose was kept at room temperature for at least 20 min to solidify. For regular time-lapse imaging, we used agarose pads with a minimal thickness of ∼2 mm.

The LysoTracker-labeled cell suspension was spun down at 500×g for 5–10 min, and then concentrated to a final volume of 10 μL by removing the supernatant (cell concentration = 104 cells/μL). The concentrated cell solution was then added to the center of a coverslip that was precoated with 10 μg/mL fibronectin (F2006, Sigma-Aldrich). The solidified agarose pad was overlaid above the 10 μL cell solution. The gel-covered coverslip was transferred to a microscope adaptor and then used for time-lapse imaging. Typically, the agarose pad would start compressing the cells within 20 min. After the cells were fully confined under the pad, the apparent cell area would increase, and the brightness of the phase halo around the cell would decrease in phase-contrast images. Imaging was initiated only after the cells were fully confined under this definition. The ambient temperature was maintained at 37°C with a temperature-controlled chamber (Haisen Tech, Guangdong, China).

Fixation of LysoTracker-labeled HL60 cells
LysoTracker-labeled HL60 cells undergoing 2D chemokinesis were fixed and used as a control for localization error calculations (Section S10 in the Supporting Material). Differentiated HL60 cells were labeled with LysoTracker and prepared for the under-agarose 2D migration assay. After the cells were fully confined, cell migration was allowed to continue under agarose for 5 min before 1 mL of cytoskeleton buffer (CSK: 100 mM HEPES, pH 7.0, 138 mM KCl, 3 mM MgCl2, 2 mM EGTA, and 320 mM sucrose), containing 3.7% formaldehyde and 0.05% glutaraldehyde, was added directly on top of the agarose pad, followed by a fixation period of 20 min. The CSK buffer was then aspirated and replaced with 1× phosphate-buffered saline, and the cells were imaged under the same settings as the under-agarose 2D cell migration assay.

Microscopy
To capture intracellular lysosome motion with high spatiotemporal resolution, time-lapse images were acquired using a Nikon Eclipse Ti epifluorescent microscope with a 100× oil-immersion objective and a 5.5 megapixel high-speed, high-sensitivity sCMOS camera, the Andor Zyla 5.5 (Andor, Belfast, United Kingdom). Acquisition rate was set to 20 frames/s (exposure time = 50 ms) with a region of interest of 1392 × 1040 pixels. A temperature and humidity control unit (Haisen Tech) was installed with the microscope to maintain a constant temperature of 37°C during the entire imaging session.

Periodic overlaying of the phase-contrast and fluorescent channels in some of the image stacks (see, e.g., Fig. 4
a) was achieved by programming an Arduino Uno microcontroller board (Arduino, Somerville, MA) as hardware interface between the Andor Zyla camera and the T-Cube LED driver (Thorlabs, Newton, NJ), which controlled the transmitted LED light source. During the imaging of fluorescently labeled lysosomes, the Arduino board would track the number of exposures made and turn on the LED light source for a specific duration after a predetermined number of exposures. Both the LED-on duration and the interval between consecutive LED-on sessions were programmable from the Arduino board.

A stage micrometer was used to determine the conversion factor of 1 pixel (px) = 0.13 μm.

Image processing
Approximate contours of individual cells were segmented from each image using Otsu thresholding, with the thresholding level scaled down by a factor of 0.3–0.5, as manually determined for each image stack to achieve accurate segmentation based on background fluorescence. Segmentation was carried out every 20 frames (1 s intervals), with spline interpolation of the cell contour for the intervening images. For several of the videos, intermittent phase-contrast images were taken every 200 frames (10 s intervals) to obtain a more accurate approximation of the cell contour (see Fig. 4, a and b). Phase images were segmented using the directional gradient vector flow algorithm (18), with manual adjustment near the lamellipod region.

Within the segmented regions (dilated by 50 px on all sides), individual lysosomes were identified by standard particle tracking algorithms as described by Crocker and Grier (19). Publicly available code (20) was used to apply a bandpass filter (with cutoffs at 1 px and 8 px (1 μm)), identify local maxima, and pick out centroids of intensity peaks. Identified features were filtered to retain only those with an eccentricity <0.3, a maximal intensity in the top 10% of the image values, an intensity per pixel above 30% of the maximal image intensity, and a total intensity above the 80th percentile (for squared regions of size 8 × 8 px).

Linking of features into particle trajectories was carried out using the same software package (20). To further remove artifacts, only trajectories of at least 40 time steps were retained for further analysis. A maximal step size of 6 px (0.77 μm) was imposed, and trajectories were split at all missed frames. Only those cells with at least 100 particle trajectories were used for the BNEW analysis. Of 120 imaged cells, 93 cells satisfied this criterion and were included in the analysis.

Trajectories were thresholded to remove the most rapidly moving particles (generally corresponding to regions of unusually high flow), using a wavelet-based method previously described for identifying actively transported organelles (21). Smoothed local velocities were defined using third-order Savitsky-Golay wavelets with a span of n=20 (see Section S2). For each cell, the threshold for locally smoothed velocity magnitude was set at twice the standard deviation for all particles within that cell. Trajectories were broken up whenever a particle exceeded the smoothed velocity threshold, with on average 8% of the total trajectory length for each cell falling above the threshold.

The cell frame of reference (see Fig. 4, c and d) was found by cross-correlating rectangular regions surrounding each cell between every 10th frame of the fluorescent images (time intervals of 0.5 s).

Results
Extracting Brownian motion with wavelet analysis
We describe the BNEW technique for analyzing particle trajectories composed of stochastic Brownian (or fractional Brownian) motion overlaid on slowly varying drift. This method relies on leveraging the separation of velocity correlation timescales to characterize the scaling and diffusion coefficient associated with the high-frequency stochastic component of the motion. Standard methods for dedrifting particle trajectories rely on averages of many particles, all assumed to be undergoing the same drift (22). The BNEW method makes no such assumption, since it relies on correcting for the flow in each individual trajectory before recompiling the data to quantify the collective statistics of the stochastic motion. This method is thus ideal for the analysis of stochastic motion in the presence of complex, spatially inhomogeneous flows (e.g., Fig. 1
a).

Specifically, we consider the motion of particles with 2D trajectories given by (1) p→k−p→0=Δ∑i=0k−1(u→i+v→i)+ξ→k−ξ→0, where p→k is the position of the particle at time step k, Δ is the size of the time step, u→i is the drift velocity at time step i, v→i is the velocity associated with Brownian motion, and ξk is the localization error. We begin by assuming that the stochastic velocities, v→i, are characteristic of diffusive Brownian motion and are thus independent and normally distributed, with mean 0 and variance 2DΔ in each dimension. Similarly, the localization errors, ξk, are assumed to be independently normally distributed with mean 0 and variance ϵ2 in each dimension. In the absence of drift, the MSD of the particle trajectories is given by (2) 〈|p→k−p→0|2〉=4Dtα+4ϵ2, with the scaling exponent α=1 under the assumption of uncorrelated stochastic velocities.

On timescales over which it remains approximately constant, the drift velocity, u→, will contribute a ballistic term (∼t2) to the total MSD. If the magnitude of the drift is large enough, this term will dominate over diffusion, making it impractical to characterize the diffusive component of the motion by the usual linear fitting of the MSD curve (Fig. 1
b). The goal of the method described here is to obtain an estimate of the scaling, α, the diffusion coefficient, D, and the localization error, ϵ, from such trajectories, by correcting for the drift velocity, u→.

A common signal-processing technique for extracting approximate velocities from noisy data is that of wavelet analysis (13, 21). This procedure involves taking a sliding window over each trajectory and using a linear combination of data points within that window to approximate the velocity of the particle: (3) v→iw=∑j=−nnwjp→i+j, where 2n+1 is the window size. A number of different wavelet shapes, {wj}, can be used for this purpose, and the procedure is equivalent to smoothing the data or applying a low-pass filter.

To provide a meaningful local velocity estimate, the wavelet coefficients must satisfy the constraints (4) ∑j=−nnwj=0and∑j=−nnjwj=1. The commonly used Haar wavelet for velocity approximation (Section S1) and the Savitsky-Golay wavelets often used for data smoothing and differentiation (Section S2) all share these properties. Different wavelet shapes smooth the data to a different extent for a given span and involve more or less sharp cutoffs between the low-frequency passband and the high-frequency stopband when viewed as low-pass filters (23).

To characterize the high-frequency stochastic motion of the particle, we subtract out the smoothed curve resulting from the wavelet analysis and focus on the adjusted tracks, [p→k(n)=p→k−∑i=0k−1v→iw], that remain (Fig. 1, c and d). If the drift velocity remains approximately constant over the span of the wavelet, then the contribution of the drift to the particle motion is effectively removed by this procedure.

Any wavelet that satisfies the constraints in Eq. 4 can be equivalently defined by a set of coefficients associated with trajectory steps between consecutive time points (s→i=p→i+1−p→i). That is, we can find coefficients wˆj such that, for any trajectory, the velocity approximation at point i is given by (5) v→iw=∑j=−nnwjp→i+j=∑j=−nn−1wˆjs→i+j. Specifically, the coefficients wˆj=−∑l=−njwl satisfy this property. Furthermore, the second constraint in Eq. 4 ensures that ∑j=−nn−1wˆj=1.

The adjusted trajectories after subtracting out the smoothed motion from the wavelet analysis are then given by (6) p→k(n)−p→0(n)=∑i=0k−1(s→i−v→iw)=∑i=0k−1[s→i−∑j=−nn−1wˆjs→i+j]=∑i=−nk+n−2cˆis→i=Δ∑i=−nk+n−2cˆi(u→i+v→i)+∑i=−nk+n−1ciξ→i, where (7) cˆi=hi−∑j=max(−n,i−k+1)min(n−1,i)wˆj,  (8) hi={1for0≤i<k0otherwise,ci={−cˆi,fori=−ncˆi−1−cˆi,for−n<i≤k+n−2cˆi−1,fori=k+n−1. As a sum of independent, normally distributed random variables, the adjusted trajectory points are also normally distributed. If we assume that the drift velocity is constant (u→i=u→), then the mean of p→k(n)−p→k(n) vanishes due to the constraints on the wavelet coefficients (Eq. 4). The MSD of the adjusted trajectories is given by (9) MSDk(n)=〈|p→k(n)−p→0(n)|2〉=4DΔAk(n)+4ϵ2Bk(n), where the average is over both time and ensemble of particles and the functions (10) Ak(n)=∑i=−nk+n−2cˆi2,Bk(n)=12∑i=−nk+n−1ci2 are fully determined by the shape and span of the wavelet used. For the commonly employed Haar wavelet (13), these functions are calculated in closed form (Section S1). More complicated wavelet shapes can be handled by performing the summations in Eqs. 7, 8, and 10 numerically (implemented in the Supporting Material). The adjusted MSD (Eq. 9) is plotted together with simulated data in Fig. 1
e. The MSDk(n) increases for short times, but flattens out for times >2n, since the smoothed track cannot deviate far from the original data.

Although the span, n, of the wavelet has a large effect on the adjusted MSD curves, these curves can be rescaled using Eq. 9 to give (11) MSDˆk(n)=4DΔtˆk+4ϵ2, where MSDˆk(n)=MSDk(n)/Bk(n) and tˆk=Ak(n)/Bk(n) is a rescaled dimensionless time. This transformation results in curves from all different wavelet spans collapsing onto a single universal line (Fig. 1
f). The diffusion coefficient and localization error can then be obtained by a linear regression of the data processed with several different wavelet spans (2≤n≤nmax). To avoid edge effects, the first and last nmax data points of each track are excluded from the calculation of the rescaled adjusted MSD.

We note that one of the fundamental strengths of the BNEW method is that each particle trajectory is analyzed independently, with the underlying flow approximated separately for each particle. In principle, this method can thus be applied for quantifying the high-frequency motion of individual particles. In practice, however, subtracting out the smoothed particle motion necessarily discards data on long-time particle behavior. The regression results are then much more sensitive to the noise inherent in finite sampling. Thus, obtaining an accurate characterization of the particle motion requires either recording very long trajectories or performing an ensemble average over many trajectories (as is the case for all results shown here). This ensemble average, however, can be performed over particles embedded in a spatially heterogeneous flow.

Characterizing subdiffusive motion
We next turn our attention to the case where the stochastic motion is subdiffusive. Subdiffusion can arise in a number of situations, including confinement, transient binding events, or motion in a viscoelastic medium (24). Here, we focus on the latter case, which has been shown to be applicable to the bacterial (4) and eukaryotic (16, 17, 25) cytoplasm, as well as the eukaryotic nucleoplasm (26). Particles in a viscoelastic medium undergo fractional Brownian motion, with negative velocity correlations that decay as a power law in time [〈v→(t)·v→(t+τ)〉=2Dα(α−1)|τ|α−2] (10). The MSD associated with such motion is given by MSD=4Dtα, and we refer to the scaling exponent, α, as the viscoelastic scaling throughout this work. The limiting case of α→1 recovers classical diffusive motion.

We show that the BNEW method can also be applied to trajectories with fractional Brownian motion overlaid on an approximately constant drift (Section S3). In this case, the rescaled MSDˆk(n) collapses on an approximate power-law curve for all wavelet spans and for time separations, k, that are small relative to span n (Fig. 1
d). We fit the rescaled MSD as a function of rescaled time, tˆ, to the power law: (12) MSDˆk(n)=4DˆΔαtˆkα+4ϵˆ2Dˆ=D f(α)ϵˆ2=ϵ2+DΔαg(α)2, where α,Dˆ, and ϵˆ are the fitted parameters. The functions f(α) and g(α) depend on the wavelet shape, as well as the range of time separations, k, used for fitting (Section S3). By fitting to this functional form, we can extract the characteristic exponent α of the fractional Brownian motion, as well as the effective diffusion coefficient, D, and localization error, ϵ. The BNEW method thus permits a characterization of the underlying medium as viscous or viscoelastic while correcting for the presence of flow.

Validation with nonconstant drift
The BNEW method provides an accurate characterization of stochastic motion in the case where the drift velocity is approximately constant over the time span of the wavelet. Before applying it to real data, however, it is important to validate this approach in the presence of time-varying drift. For concreteness, we consider the case where the drift velocity, u→i, can be described as a 2D persistent random walk, characterized by correlation time τ and magnitude γ (Section S4). Such a random walk has an exponentially decaying velocity correlation; more complicated motion with several characteristic correlation times may be approximated as a sum over multiple persistent random walks (Section S9). We calculate the accuracy of the parameters αfit, D fit, and ϵ
fit, as obtained by fitting the rescaled MSD curve to a power law (Section S5). In particular, we consider the relative bias in the parameters, defined as 〈χfit−χ〉/χ and the root mean-squared error, defined as 〈(χfit−χ)2〉/χ, where χ is each of the fitted parameters. Here, we focus on the case of purely diffusive stochastic motion (α=1).

To simplify the parameter space, we nondimensionalize all time units by the time step, Δ, and all length units by the localization error, ϵ, leaving three dimensionless parameters: drift magnitude, γ˜=γΔ/ϵ, drift correlation time, τ˜=τ/Δ, and diffusion coefficient, D˜=DΔ/ϵ2. The time-varying drift velocity is not fully removed by the BNEW procedure and leads to a bias in the estimation of α and D (Fig. 2, a and b). This effect is more pronounced when using larger wavelet spans (n), so that the drift velocity deviates significantly over the span of the wavelet. Restricting to shorter spans, however, limits the range of rescaled times, tˆk, used in the analysis and thus leads to increased sampling error in the fitted parameters. The balance between these effects results in an optimal value of maximum span, nmax, to be used for the fits (Fig. 2, a and b). We note that the optimal span depends on the shape of the wavelet, with wavelets that perform more aggressive smoothing yielding a higher value of nmax. We select the wavelet shape (SG-3, the third-order Savitzky-Golay filter) used for all subsequent analyses based on minimizing the overall error in the fitted scaling parameter, αfit (Section S6). In the case where the drift velocity decorrelates much more slowly than the frame rate, a wide range of nmax will give consistent results for the estimated parameters characterizing the high-frequency stochastic motion.

The bias and error in the fit parameters depend on the relative magnitude of the stochastic motion and the drift velocity (Fig. 2, c and d), as well as the persistence time of the drift. When the persistence time is long (τ˜>10), the MSD due to drift over one time step can be expanded into a term associated with constant drift (γ˜2) and a first-order correction (γ˜2/τ˜). The former term is effectively removed by the BNEW procedure. The relative bias in the fit parameters is then dependent on the displacement due to diffusion relative to the remaining displacement from drift. That is, the bias is determined by the compound parameter τ˜D˜/γ˜2 (Fig. 2, e and f). To decrease bias below 10% for all fitted parameters, it is sufficient to have D˜τ˜/γ˜2>40. When the bias is small, the overall error in the fit parameters is dominated by sampling error that depends entirely on the magnitude of diffusion relative to the localization error (D˜), as well as the number of tracks sampled.

We further compare the performance of the BNEW method with the traditional approach of fitting the short-time portion of the total MSD curve, where the ballistic contribution from the drift velocity is least pronounced. For a wide range of parameters, BNEW outperforms the standard approach, yielding significantly less bias and error in the fitted parameters (Fig. 3). These calculations validate the ability of our methodology to accurately characterize stochastic motion in situations where there is sufficient drift velocity to dominate the overall MSD.

In the case where the stochastic component of the trajectories corresponds to fractional Brownian motion (α<1), time-varying drift leads to a larger bias in the parameter estimation, and the BNEW method is applicable for a more limited range of parameters (Section S8). Nonetheless, it remains a substantially more accurate means of characterizing the stochastic motion than the traditional alternative of fitting ordinary MSD curves (Fig. S11).

A MATLAB software implementation of the BNEW method is provided in the Supporting Material.

Application to organelle movement in motile cells
As a biologically relevant example, we apply the BNEW method to analyze the trajectories of lysosomes in motile neutrophil-like HL60 cells. These organelles form a convenient endogenous probe of intracellular mechanics because they are punctate, numerous, and well dispersed throughout the cell. By analyzing the high-frequency component of the lysosome motion, we demonstrate that the cytoplasm of these cells behaves primarily as a viscous fluid over the timescales examined, with organelles undergoing apparent diffusion in the cytoplasm.

HL60 cells were placed in a 2D environment, confined under an agarose pad (27), in a uniform concentration of chemoattractant (see Materials and Methods). Under such conditions, these cells exhibit undirected but relatively persistent motility, with concomitant fluctuations in cell shape as they crawl (Fig. 4
b). Lysosomes within the cells were fluorescently labeled (Fig. 4
a), and the migrating cells were imaged with a time step of Δ=0.05 s.

The motion of the lysosomes is dominated by the overall migration of the cell, as well as the intracellular flows and cell shape deformation (Fig.4, b and c). This effect complicates the microrheological analysis of such tracks, making it impractical to characterize the viscosity or viscoelasticity of the intracellular medium using the MSD alone, even after correcting for whole-cell rigid body motion (Fig. 4
d). The BNEW method, however, makes it possible to extract material properties based on the high-frequency stochastic component of the motion,while filtering out the slowly varying flow. Trajectories for all particles within each cell are pooled together to obtain sufficient statistics, due to the limited length of individual trajectories (mean length 118 time steps).

The rescaled, corrected mean squared displacement, MSDˆk(n), for particles in several representative cells is shown in Fig. 4
e. We use a maximal wavelet span of nmax=17 for the BNEW analysis, a value selected based on a characterization of the population average drift velocities for particles in all cells pooled together (Section S9). The linear scaling of the MSDˆk(n) is consistent with diffusive motion of particles in a purely viscous medium.

We repeated the BNEW analysis for a population of 93 HL60 cells. After applying BNEW analysis to each cell, we calculated the distribution of the estimated scaling parameter (αfit), diffusion coefficient (Dfit), and localization error (ϵfit) among the population of cells (Fig. 5). Because we do not know a priori whether the stochastic motion of the particles in individual cells is diffusive or subdiffusive, we limit the time separations used in the fits to kmax=0.74 to avoid bias in the fitted scaling coefficient, α, for the subdiffusive case (Section S3). This conservative approach results in more noisy estimates, which may be partially responsible for the broad distribution of results over the entire population of cells.

The diffusion coefficient for lysosomes averaged among all cells has a value of <Dfit> = 0.018 μm2/s, with a population standard deviation of 0.014 μm2/s. This value is consistent with previous microrheological measurements of the diffusion coefficient within chemotaxing PMN cells (28). In general, lysosome size varies widely, with a typical diameter of about 0.5 μm (29). Using the Stokes-Einstein equation for the diffusion coefficient of a sphere (30), (D=kT/(6πRη)), gives an effective viscosity of η ≈ 50 cP, or ∼50 times that of water. We note, however, that this approximation assumes thermally driven particle motion, and that the actual viscosity may be significantly higher given a higher effective temperature due to actively generated forces (6, 31).

The population averaged localization error was calculated as <ϵfit> = 0.015 μm, consistent with control measurements in a fixed cell (Section S10). We note that the fitted parameters from running BNEW analysis on the full set of tracks from all cells pooled together (Fig. 5
a) are close to the average of individual cell measurements, confirming the robustness of the analysis.

The scaling exponent of the high-frequency component of motion extracted with the BNEW method is peaked around αfit=1.02, indicating that the average motion of lysosomes in the cytoplasm of most HL60 cells is consistent with diffusion in a purely viscous medium. However, the breadth of the distribution for αfit, as well as Dfit, is far wider than would be expected based on simulated trajectory results, implying that the biological variability of individual cells is responsible for the broad range of values. Of particular interest are those cells with low values of αfit, implying a potentially distinct cytoplasmic environment that leads to subdiffusive motion. Identifying the biophysical root of the difference in particle behavior within such cells, as compared to the majority of HL60 cells, is a promising avenue for further research. In this case, the BNEW method serves as a metric for identifying unusual cell subpopulations meriting further study.

Discussion
The BNEW method enables the characterization of high-frequency motion from single-particle trajectories that are confounded by the presence of flow in the underlying medium. Because approximations of the flow velocity are subtracted out from individual tracks, no assumptions are imposed on the spatial structure of the flow. This method yields accurate approximations of the viscoelastic scaling modulus and the diffusion coefficient, provided the flow velocity varies slowly compared to the frame rate (see Fig. 2, e and f, for accuracy criteria).

Characterizing the stochastic component requires focusing on the short-time, high-frequency regime. For single-particle tracking experiments, the minimal timescale of observation is limited in practice to the millisecond regime, both by the camera frame rate and the spatial resolution in locating particles. Although other techniques, such as fluorescence correlation spectroscopy (32) and dynamic light scattering (33), are available for probing shorter timescales, they require significantly more complex experimental setup and are necessarily restricted to averages over the behavior of many particles. The BNEW method, on the other hand, requires only video microscopy of labeled particles, and is applicable to the analysis of individual long particle trajectories, provided sufficient data can be obtained through time averaging.

Prior studies aimed at analyzing short- versus long-timescale behavior in the trajectories of whole moving cells have made use of the Fourier-transformed velocity autocorrelation function to isolate different components of the motion (34). In principle, this technique could be extended to particles moving through a viscoelastic medium by taking the discrete Fourier transform of the known velocity correlation function for such motion (35). The BNEW method, however, provides a related but more general approach, using wavelet analysis instead of Fourier transforms to perform the high-pass filtering of particle trajectories. In fact, the Fourier transform of a signal can be formulated as a particular wavelet shape with span equal to the full length of the signal. Wavelet analysis, however, is more naturally amenable to studying behaviors that are localized in time, and is thus the preferred choice for analyzing complex nonstationary signals (36). Furthermore, the limited span of the wavelets used makes it possible to combine data from trajectories of different lengths and to perform the analytic error analysis shown in Fig. 2.

The BNEW method enables characterization of material properties in nonquiescent media. Potential applications include not only the cytoplasm of moving cells, but also mucus and other biofluids in the presence of flow. The BNEW technique can also be used to correct for stage drift and flow effects in situations where only a small number of particles are visualized simultaneously, limiting the efficiency of standard dedrifting methods (22). In principle, the method described here can be extended to correct for persistent flow in other metrics used to analyze particle trajectories, such as the velocity autocorrelation function. Extension to two-particle or multiparticle correlative tracking data is also possible, although this would require additional assumptions about the spatial structure of the underlying flow.

Author Contributions
E.F.K. designed research, analyzed data, developed computational tools, and wrote the article. C.K.C designed and performed experiments. J.A.T. designed research and wrote the article.

Supporting Citations
References (37, 38, 39, 40, 41, 42, 43, 44) appear in the Supporting Material.

Supporting Material
Document S1. Supporting Materials and Methods, Software, and fourteen figures
 Document S2. Article plus Supporting Material
 

Acknowledgments
We thank Rikki M. Garner, Ahmad N. Nabhan, and Miranda Stratton for assistance with pilot experiments; and Stephanie C. Weber and Andrew J. Spakowitz for helpful comments on the manuscript.

E.F.K. was supported by the James S. McDonnell Foundation Postdoctoral Fellowship Award in Complex Systems; C.K.C. was supported by the Stanford Cellular and Molecular Biology Training grant (T32-GM007276); J.A.T. was funded by the Howard Hughes Medical Institute and the Stanford Center for Systems Biology (P50-GM107615).

This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Supporting Materials and Methods, Software, and fourteen figures are available at http://www.biophysj.org/biophysj/supplemental/S0006-3495(15)01165-0.

Figure 1 Schematic of the BNEW method for decoupling high-frequency stochastic motion from flow, as applied to simulated particle trajectories. (a) Particles undergoing diffusive Brownian motion (red, α=1,D=5) and subdiffusive, fractional Brownian motion (green, α=0.5,D=5) were simulated in the presence of a flow field (black arrows), with localization error ϵ=1. Example trajectories are shown (from 400 total trajectories of length 200 time steps each). (b) The MSD for simulated particles. Superlinear scaling is a result of the underlying flow. Dashed lines indicate the MSD with no drift present for diffusive (red) and subdiffusive (green) motion. (c and d) Decomposition of the particle trajectories into the smoothed component (c) and the high-frequency component, p→k(n) (d). Two high-frequency trajectories are shown for diffusive (red and magenta) and subdiffusive (green and yellow) motion. Smoothing was done using Haar wavelets with span n=12. (e) Adjusted MSD obtained with BNEW analysis for tracks with diffusive stochastic motion. Dashed black lines show the analytical solution (Eq. 9). (f) Rescaled adjusted MSD, as defined in Eq. 11, plotted on linear axes. Black lines indicate power-law fits to the data, with the given fit parameters. To see this figure in color, go online.

Figure 2 Errors in characterizing high-frequency stochastic motion with the BNEW method. (a) Bias and total error in the fitted scaling parameter, αfit, as a function of maximal wavelet span. Dashed curves give the relative bias, [〈αfit−α〉/α], and solid curves the relative error [〈(αfit−α)2〉/α], calculated as described in Section S5, for drift correlation times of 100 time steps (blue) and 500 time steps (red). Curves shown are calculated for γ˜=1,D˜=3. (b) Corresponding curves for bias and error in Dfit. (c and d) Dependence of relative error in αfit and Dfit on dimensionless drift magnitude, γ˜, and diffusion constant, D˜. All values are calculated with τ˜=100andnmax=17. Dashed black lines mark a constant value of D˜/γ˜2. (e and f) Relative bias (dashed curves) and error (solid curves) plotted as a function of the compound parameter, τ˜D˜/γ˜2. Persistence-time values of 10≤τ˜≤5000 were used for each curve. SG-3 wavelets were used throughout, and error calculations are done for 400 tracks of length 200 time points each, assuming diffusive stochastic motion (α=1). Analogous calculations for the fitted localization error (ϵfit) are shown in Fig. S6. To see this figure in color, go online.

Figure 3 Comparison of error in fit parameters for high-frequency stochastic motion, using the BNEW method (solid lines) and ordinary MSD curves (dashed lines), as a function of drift magnitude, γ˜, for a constant diffusion coefficient D˜=3 (left panel) and as a function of diffusion coefficient, D˜, for a constant γ˜=1 (right panel). Drift is assumed to have a dimensionless correlation time of τ˜=100. Errors shown are for 400 tracks of length 200 time steps. BNEW analysis was done using SG-3 wavelets with spans of 2≤n≤17. Errors for plain MSD curves were obtained from fits to 1≤k≤3, the smallest number of points for fitting a power law. This fitting range minimizes error in the presence of drift (see Section S7). To see this figure in color, go online.

Figure 4 Analysis of lysosome trajectories in an HL60 cell. (a) Example cell with lysotracker labeling, imaged in consecutive frames with phase contrast in addition to fluorescence (left) and with fluorescence only (right). (b) Migrating cell shape over time. (c) Example lysosome trajectories in the lab frame of reference and in the cell frame of reference. (d) Mean-squared displacement for all tracked lysosomes in the example cell, in the lab frame (blue) and the cell frame (green). The mean-squared change in interparticle distances is shown in red. Dashed lines indicate scaling as a guide to the eye. (e) Rescaled, adjusted MSD after BNEW analysis for the example cell (red), and for other representative cells (blue, green, and cyan). Wavelet smoothing was done with SG-3 wavelets for spans of 2≤n≤17. Black lines indicate power-law fits to Eq. 12 with the given scaling coefficients, αfit. To see this figure in color, go online.

Figure 5 Statistics from BNEW analysis of lysosome motion in a population of 93 HL60 cells, with an average of 391 tracks each and an average track length of 118 time steps. SG-3 wavelets with spans of 2≤n≤17 and time separations of 1≤k≤⌊0.74n⌋ were used for the BNEW analysis. (a) Rescaled MSD from BNEW analysis of all tracks pooled together. The black line shows a power-law fit with the given parameters. (b) Histogram of scaling coefficients (αfit) for pooled lysosome tracks from each individual cell. The population average (〈αfit〉) and standard deviation (σαfit) are as shown. (c) Histogram of diffusion coefficients (Dfit) from individual cells. (d) Histogram of fitted localization errors (ϵfit) from individual cells. Cases with ϵfit=0 were excluded from the ensemble average and standard deviation calculations for the localization error. To see this figure in color, go online.
==== Refs
References
1 Schuster B.S.  Suk J.S.  Hanes J.   Nanoparticle diffusion in respiratory mucus from humans without lung disease Biomaterials 34 2013 3439 3446 23384790 
2 Mizuno D.  Tardin C.  Mackintosh F.C.   Nonequilibrium mechanics of active cytoskeletal networks Science 315 2007 370 373 17234946 
3 Wirtz D.   Particle-tracking microrheology of living cells: principles and applications Annu. Rev. Biophys. 38 2009 301 326 19416071 
4 Weber S.C.  Spakowitz A.J.  Theriot J.A.   Bacterial chromosomal loci move subdiffusively through a viscoelastic cytoplasm Phys. Rev. Lett. 104 2010 238102 20867274 
5 Kole T.P.  Tseng Y.  Wirtz D.   Intracellular mechanics of migrating fibroblasts Mol. Biol. Cell 16 2005 328 338 15483053 
6 Weber S.C.  Spakowitz A.J.  Theriot J.A.   Nonthermal ATP-dependent fluctuations contribute to the in vivo motion of chromosomal loci Proc. Natl. Acad. Sci. USA 109 2012 7338 7343 22517744 
7 Parry B.R.  Surovtsev I.V.  Jacobs-Wagner C.   The bacterial cytoplasm has glass-like properties and is fluidized by metabolic activity Cell 156 2014 183 194 24361104 
8 Daniels B.R.  Masi B.C.  Wirtz D.   Probing single-cell micromechanics in vivo: the microrheology of C. elegans  developing embryos Biophys. J. 90 2006 4712 4719 16581841 
9 Gal N.  Weihs D.   Intracellular mechanics and activity of breast cancer cells correlate with metastatic potential Cell Biochem. Biophys. 63 2012 199 209 22555560 
10 Deng W.  Barkai E.   Ergodic properties of fractional Brownian-Langevin motion Phys. Rev. E Stat. Nonlin. Soft Matter Phys. 79 2009 011112 19257006 
11 MacKintosh F.C.  Levine A.J.   Nonequilibrium mechanics and dynamics of motor-activated gels Phys. Rev. Lett. 100 2008 018104 18232824 
12 MacKintosh F.C.   Active diffusion: the erratic dance of chromosomal loci P Natl Acad Sci 109 2012 7138 7139 
13 Percival D.B.  Walden A.T.   Wavelet Methods for Time Series Analysis vol. 4 2006 Cambridge University Press Cambridge, United Kingdom 
14 Chevry L.  Colin R.  Berret J.-F.   Intracellular micro-rheology probed by micron-sized wires Biomaterials 34 2013 6299 6305 23746859 
15 Yamada S.  Wirtz D.  Kuo S.C.   Mechanics of living cells measured by laser tracking microrheology Biophys. J. 78 2000 1736 1747 10733956 
16 Valentine M.T.  Perlman Z.E.  Weitz D.A.   Mechanical properties of Xenopus  egg cytoplasmic extracts Biophys. J. 88 2005 680 689 15501931 
17 Wessel A.D.  Gumalla M.  Schmidt C.F.   The mechanical properties of early Drosophila  embryos measured by high-speed video microrheology Biophys. J. 108 2015 1899 1907 25902430 
18 Seroussi I.  Veikherman D.  Keren K.   Segmentation and tracking of live cells in phase-contrast images using directional gradient vector flow for snakes J. Microsc. 247 2012 137 146 22591174 
19 Crocker J.C.  Grier D.G.   Methods of digital video microscopy for colloidal studies J. Colloid Interface Sci. 179 1996 298–296 
20 Kilfoil, M. Matlab particle pretracking and tracking, and 2D feature finding. http://people.umass.edu/kilfoil/downloads.html.
21 Chen K.  Wang B.  Granick S.   Diagnosing heterogeneous dynamics in single-molecule/particle trajectories with multiscale wavelets ACS Nano 7 2013 8634 8644 23971739 
22 Rowlands C.J.  So P.T.   On the correction of errors in some multiple particle tracking experiments Appl. Phys. Lett. 102 2013 021913 
23 Schafer R.W.   What is a Savitzky-Golay filter? IEEE Signal Process. Mag. 28 2011 111 117 
24 Weber S.C.  Thompson M.A.  Theriot J.A.   Analytical tools to distinguish the effects of localization error, confinement, and medium elasticity on the velocity autocorrelation function Biophys. J. 102 2012 2443 2450 22713559 
25 Tolić-Nørrelykke I.M.  Munteanu E.-L.  Berg-Sørensen K.   Anomalous diffusion in living yeast cells Phys. Rev. Lett. 93 2004 078102 15324280 
26 Guigas G.  Kalla C.  Weiss M.   Probing the nanoscale viscoelasticity of intracellular fluids in living cells Biophys. J. 93 2007 316 323 17416631 
27 Renkawitz J.  Schumann K.  Sixt M.   Adaptive force transmission in amoeboid cell migration Nat. Cell Biol. 11 2009 1438 1443 19915557 
28 Felder S.  Kam Z.   Human neutrophil motility: time-dependent three-dimensional shape and granule diffusion Cell Motil. Cytoskeleton 28 1994 285 302 7954856 
29 Bandyopadhyay D.  Cyphersmith A.  Payne C.K.   Lysosome transport as a function of lysosome diameter PLoS One 9 2014 e86847 24497985 
30 Berg H.C.   Random Walks in Biology 1993 Princeton University Press Princeton, NJ 
31 Guo M.  Ehrlicher A.J.  Weitz D.A.   Probing the stochastic, motor-driven properties of the cytoplasm using force spectrum microscopy Cell 158 2014 822 832 25126787 
32 Weiss M.  Hashimoto H.  Nilsson T.   Anomalous protein diffusion in living cells as seen by fluorescence correlation spectroscopy Biophys. J. 84 2003 4043 4052 12770908 
33 Pecora R.   Dynamic light scattering measurement of nanometer particles in liquids J. Nanopart. Res. 2 2000 123 131 
34 Li L.  Cox E.C.  Flyvbjerg H.   “Dicty dynamics”: Dictyostelium motility as persistent random motion Phys. Biol. 8 2011 046006 21610290 
35 Weber S.C.  Theriot J.A.  Spakowitz A.J.   Subdiffusive motion of a polymer composed of subdiffusive monomers Phys. Rev. E Stat. Nonlin. Soft Matter Phys. 82 2010 011913 20866654 
36 Polikar R.   The story of wavelets IMACS/IEEE CSCC Proc., 3rd, Athens, Greece 3 1999 5481 5486 
37 Savitzky A.  Golay M.J.   Smoothing and differentiation of data by simplified least squares procedures Anal. Chem. 36 1964 1627 1639 
38 Kroese D.P.  Botev Z.I.   Spatial process simulation Schmidt V.   Lectures on Stochastic Geometry, Spatial Statistics and Random Fields, Volume 2: Analysis, Modeling and Simulation of Complex Structures 2013 Springer International Cham, Switzerland 369 404 
39 Turchin P.   Quantitative Analysis of Movement: Measuring and Modeling Population Redistribution in Animals and Plants 1998 Sinauer Sunderland, MA 
40 Selmeczi D.  Mosler S.  Flyvbjerg H.   Cell motility as persistent random motion: theories from experiments Biophys. J. 89 2005 912 931 15951372 
41 Bouchiat C.  Wang M.D.  Croquette V.   Estimating the persistence length of a worm-like chain molecule from force-extension measurements Biophys. J. 76 1999 409 413 9876152 
42 Yamakawa H.   Helical Wormlike Chains in Polymer Solutions 2012 Springer New York 
43 Kariya T.  Kurata H.   Generalized Least Squares 2004 John Wiley & Sons New York 
44 Michalet X.   Mean square displacement analysis of single-particle trajectories with localization error: Brownian motion in an isotropic medium Phys. Rev. E Stat. Nonlin. Soft Matter Phys. 82 2010 041914 21230320

