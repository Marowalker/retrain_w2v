
==== Front
Biophys JBiophys. JBiophysical Journal0006-34951542-0086The Biophysical Society S0006-3495(18)30585-X10.1016/j.bpj.2018.05.009Systems BiophysicsMolecular Filters for Noise Reduction Laurenti Luca luca.laurenti@cs.ox.ac.uk1∗Csikasz-Nagy Attila 23Kwiatkowska Marta 1Cardelli Luca 141 Department of Computer Science, University of Oxford, Oxford, United Kingdom2 Randall Division of Cell and Molecular Biophysics and Institute of Mathematical and Molecular Biomedicine, King’s College London, London, United Kingdom3 Pázmány Péter Catholic University, Budapest, Hungary4 Microsoft Research, Cambridge, United Kingdom∗ Corresponding author luca.laurenti@cs.ox.ac.uk19 6 2018 19 6 2018 114 12 3000 3011 13 2 2018 4 5 2018 © 2018 Biophysical Society.2018Biophysical SocietyThis is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).Living systems are inherently stochastic and operate in a noisy environment, yet despite all these uncertainties, they perform their functions in a surprisingly reliable way. The biochemical mechanisms used by natural systems to tolerate and control noise are still not fully understood, and this issue also limits our capacity to engineer reliable, quantitative synthetic biological circuits. We study how representative models of biochemical systems propagate and attenuate noise, accounting for intrinsic as well as extrinsic noise. We investigate three molecular noise-filtering mechanisms, study their noise-reduction capabilities and limitations, and show that nonlinear dynamics such as complex formation are necessary for efficient noise reduction. We further suggest that the derived molecular filters are widespread in gene expression and regulation and, particularly, that microRNAs can serve as such noise filters. To our knowledge, our results provide new insight into how biochemical networks control noise and could be useful to build robust synthetic circuits.

Editor: Alexander Berezhkovskii.
==== Body
Main Text
Biochemical processes such as gene expression are inherently stochastic and must control noise, which presents itself as stochastic fluctuations. These fluctuations can be extrinsic, arising from interactions occurring with other processes in the environment, or intrinsic, resulting from the random timing of the reactions themselves (1, 2, 3, 4, 5, 6). Molecular processes transform noisy input signals from the environment into output signals through a number of stages, with signals represented by chemical species and each stage implemented by a molecular reaction network. Because each stage can compound the noise, to obtain a reliable final output, natural systems must integrate mechanisms that, directly or indirectly, reduce noise or otherwise confine it. Examples include signaling cascades, which have been shown to reduce extrinsic fluctuations (7), and the role microRNA plays in attenuating the noise of protein expression (8).

Noise reduction has been studied extensively in electronics (9), and certain noise-filtering principles have been successfully applied to molecular systems (10, 11, 12). For instance, negative feedback and feed-forward loops have been shown to reduce noise (13, 14), and fundamental limits for noise suppression of feedback loops have been derived using techniques from control and information theory (15). Analogs of mechanisms from signal processing such as low-pass filters, which transduce low-frequency signals while attenuating high-frequency signals, have also been observed in biochemical systems (16). However, these are not always true low-pass filters: a low-pass filter must preserve the low frequencies and, for example, not amplify them while attenuating the high frequencies. Moreover, the classical theory of filters in electronics does not account for intrinsic noise. Therefore, difficulties arise when implementing such filters in terms of stochastic biochemical networks, because it is not clear how intrinsic noise may affect their noise-reduction performance (1, 2, 4, 6).

Inspired by the concept of low-pass filters, we study the noise-reduction capabilities of molecular filters in a stochastic setting. We propose three fundamental filter modules and their implementation as stochastic chemical reaction networks. We account for intrinsic as well as extrinsic noise and derive principles holding for filters when embedded in a general biochemical network, which may include multiple feed-forward and feedback loops. First, we consider linear filters (Fig. 1
A), implemented by means of at most unimolecular reactions, and we show that in the case of positive correlation between the elements of the network, they are limited by Poisson levels, that is, the variance of the output signal is lower bounded by its mean. We then show how the presence of feedback loops may improve the performance of linear filters below Poisson levels. Specific models of linear filters have already been studied in the context of closed models of gene expression (17, 18). Here, although still providing exact analysis based on the solution of the chemical master equation (CME), we generalize the analysis in the referenced works, also taking into account the more general and common case in which the dynamics of the other components of the networks are left unspecified and possibly involving nonlinearity and feedback loops. The limitations in the noise-suppression capabilities of linear filters motivate us to consider nonlinear filters. We introduce a nonlinear filter mechanism given by the coexpression of two species that then bind together, called the annihilation module (Fig. 1
B), which we demonstrate is able to reduce noise to below Poisson levels. We then propose the annihilation filter (Fig. 1
C), which combines the properties of the linear filter and annihilation module. We show how the annihilation filter in particular can greatly reduce molecular noise. We observe that coexpression and nonlinear degradation are key requirements for such noise reduction. This is important to stress, as theoretical analysis is usually restricted to linear degradation (15). Using analytical, numerical, and stochastic simulation techniques, we demonstrate how the different filters improve the robustness of the systems in which they are embedded.Figure 1 Molecular filters (top row) along with plausible biological examples in which such components can be found (middle row). We stress that for many of these examples, it has yet to be verified experimentally that those systems behave as our filters. We simply present them here to facilitate understanding (see Discussion). Dashed arrows represent catalytic production/activation effects and continuous arrows molecular transitions. (A) An example of a first-order low-pass filter implemented by means of slow production and degradation reactions is shown (linear filter, Eq. 1). These networks are present both at the translation and transcription level to increase robustness of gene expression. (B) An example of an annihilation module (Eq. 7) given by coexpression of two species that are then degraded together is shown. These networks may be a model for a class of microRNA-regulated gene expression, in which mRNA and the target protein are coexpressed. (C) An example of an annihilation filter (Eq. 10) based on the annihilation module is shown. Such a system may be a suitable model for the c-Myc|E2F1|hsa-miR-20a circuit with its extension to E2F2 (40) under the assumption that E2F1 activates E2F2, except for the feed-forward loop between (A) and (C), which has no influence on noise reduction. We stress that this assumption needs further experiments to be confirmed. (D) Biological systems in which the filters may play a role in reducing noise are given.



Finally, we discuss how the molecular filters we derive are prevalent in gene expression. For instance, the linear filter, implemented by simply producing and degrading a species at a slow enough rate, is a low-pass filter mechanism widely deployed in gene expression to increase robustness at both the transcription and translation level (18). Moreover, we find that the annihilation module and annihilation filter are sound models of microRNA-regulated gene expression in the case of correlated expression of microRNAs with the target gene. This supports the hypothesis that microRNA may play a role in increasing the robustness and precision of gene expression. We stress how the focus of this study is not to offer new models of particular molecular processes, but to identify fundamental and general mechanisms that, at the molecular level, can reduce noise and to understand their properties and limitations. Thus, to our knowledge, our results provide new insight into how biochemical networks control noise.

Materials and Methods
Detailed information about the modeling framework and mathematical derivations can be found in the Supporting Materials and Methods. Chemical reaction network (CRN) and linear noise approximation (LNA) simulations have been performed using the Microsoft Visual GEC tool (19). Details on the code can be found in Supporting Materials and Methods, Section G.

Results
We first investigate filters composed from linear reactions and show their limitations; then we discuss nonlinear filters, showing how nonlinearities can improve the performances in terms of noise reduction. The techniques used are detailed in the Materials and Methods.

Linear filters and their limits in noise suppression
To model biological regulatory networks, we focus on the underlying molecular interactions represented as CRNs. A CRN is a set of biochemical species that interact according to the reaction laws. Input and output signals are modeled as biochemical species. In this study, species A will always represent the input signal/species. We assume A is a noisy input with the noise identified by its Fano factor (ratio between variance and mean). Thus, a molecular filter is a CRN with input A and whose output has a reduced Fano factor compared to A but still maintains certain features of its time evolution. In this study, we focus on filters that maintain the same long-term behavior of A while reducing its Fano factor.

The CRN F (Eq. 1), which we call a linear filter, is composed of a production and a degradation reaction with output species B: (1) F:A→k1A+BB→k2, where k1,k2∈R>0 are the rate parameters. We consider the general scenario in which the linear filter F (Eq. 1) is embedded within an arbitrarily complex, possibly nonlinear reaction network with the only constraint that the output species B is changed only by the reactions in F. We do allow B to act as a catalyst in an arbitrary number of reactions and A to interact with the larger network with no constraint. This scenario is very general and includes the case in which A is a function of B with feedback loops.

Classical frequency analysis
The transfer function of F is obtained by applying the Fourier transform to the mass action rate equation corresponding to B (20, 21). As B is changed only by reaction in F, we obtain dΦB(t)dt=k1ΦA(t)−k2ΦB(t), where ΦA and ΦB are the deterministic signals modeling the time evolution of A and B. In the frequency domain, we get iωΦˆB(ω)=k1ΦˆA(ω)−k2ΦˆB(ω), where ω is the angular frequency and ΦˆB(ω),ΦˆA(ω) are the Fourier transforms of signals ΦB and ΦA. For k1 = k2, we obtain (2) ΦˆB(ω)ΦˆA(ω)=11+iωk1. 

Equation 2 is the transfer function of a first-order low-pass filter (see Supporting Materials and Methods, Section A). This network attenuates frequencies higher than the cutoff frequency by introducing a delay and integrating the fast dynamics. From Eq. 2, the cutoff frequency is exactly ω¯=k1. This means that the higher the value of k1, the less noise is filtered out, but the faster B tracks A.

Stochastic analysis
The classical frequency analysis of F, based on the Fourier transform of the rate equations, does not take into account the intrinsic noise introduced by the reactions firing in F; it only considers the extrinsic noise modeled as fast fluctuations of the input. However, the intrinsic noise cannot simply be neglected, as it may drive the behavior of biological systems (16). This is the case in gene expression, in which low molecular counts are often involved and deterministic modeling is generally unsatisfactory (3, 22). To resolve this, we need to consider the continuous time Markov chain induced by F, whose transient evolution is described by the CME (23). The evolution of the moments of the CME can be described as a (possibly infinite) set of ordinary differential equations, so-called moment equations (24, 25) (Supporting Materials and Methods, Section B). We quantify the noise with the Fano factor (ratio between expectation and variance) and, under the general scenario described in the previous section, using moment equations, the transient evolution of the expectation of B at time t can be computed exactly as dE[B(t)]dt=k1E[A(t)]−k2E[B(t)], where E[A(t)] is the expectation of A at time t. We call limt→∞E[A(t)]=E[A]∞ the steady-state solution of E[A], and we assume it exists and is finite. The steady-state solution of B, E[B]∞ can then be derived by solving (dE[B(t)]/dt)=0, which results in (3) E[B]∞=k1k2E[A]∞. 

Equation 3 guarantees that the expected value of B always tracks the expectation of A, no matter which biochemical system is producing A and what happens in the rest of the system.

Importantly, for V[A]∞ (the variance of A at steady state), we can derive the following exact relation (4) V[B]∞=E[B]∞+k1k2Cov[A,B]∞, where Cov[A,B]∞=E[AB]∞−E[A]∞E[B]∞ is the covariance of A and B at steady state, with E[AB]∞ the expectation of A B at steady state. A full derivation of Eqs. 3 and 4 is shown in the Supporting Materials and Methods, Section C. The idea is that even though B can participate in other reactions as a catalyst and A may be a nonlinear function of B, in Eq. 3, all the nonlinearities disappear, whereas in Eq. 4, these are included in the term Cov[A,B]∞. Equation 4 shows that for any input signal, the filtered signal B has variance that is equal to its mean plus the covariance between A and B. Assuming A and B are non-negatively correlated, then we have E[AB]∞≥E[A]∞E[B]∞. As a result, in the case of non-negative correlation between A and B, for any k1,k2∈R≥0, the following lower bound holds: (5) FB≥1, where FB is the Fano factor of B at steady state. The above lower bound has already been observed and studied in the context of specific closed models of gene expression for which mRNA and protein are positively correlated (17, 18, 26). However, in the more general scenario we consider, we can observe that Eq. 5 holds only in the case of non-negative correlation of the species, meaning that a simple birth-death process of a downstream component cannot reduce the noise of an input signal below Poisson levels.

A and B being non-negatively correlated is natural, because A catalyzes the production of B. In fact, in Supporting Materials and Methods, Section C, we show that for a large class of systems, A and B are effectively positively correlated. However, in the following example, we show that a negative feedback loop between B and A may change the sign of their correlation, potentially leading to noise reduction to below Poisson levels. Thus, our analysis gives a further explanation of why negative feedback regulation in gene expression may be a widely selected mechanism to reduce noise and increase robustness (13) (see Discussion).

In example 1, we consider the following CRN, in which there is feedback between A and B and L is an auxiliary species: (6) →1LL→100L+A+A;A→0.1A→0.01A+B;B→0.01;B+L→kfB, where kf > 0 is a rate constant, that is, feedback between A and B is present. The strength of the feedback can be controlled by changing the rate kf. B can be thought of as a protein that inhibits its expression. The above CRN meets the condition of validity of Eqs. 3 and 4. Thus, Eq. 3 guarantees that for any possible initial condition and value of kf, E[B]∞=E[A]∞, whereas Eq. 4 guarantees that FB=E[A]∞+Cov[A,B]∞. Thus, to compute the Fano factor of B at steady state, we need to estimate Cov[A,B]∞. The system is nonlinear. As a consequence, Cov[A,B]∞ cannot be computed exactly but can be estimated using the LNA. We obtain that, for kf > 0.277368, Cov[A,B]∞<0. Thus, FB < 1 This shows how strong feedback can reduce the Fano factor of B to below Poisson levels. However, strong feedback means strong repression of the mean of B and A by Eq. 3. To confirm the mathematical analysis, in Fig. 2, for different values of kf, we plot a single stochastic simulation of B compared with a signal with the same mean of B but affected by Poisson noise.Figure 2 For the CRN in Eq. 6, we plot a stochastic simulation of B for three different values of kf and assuming initial condition of all the species are 0. In all the plots, P is a signal with Poisson noise such that E[P]∞=E[A]∞. When the feedback is weak (kf = 0.00277), the Fano factor of B is greater than one. For kf = 0.277, our analysis predicts a Fano factor for B of ∼1. When the feedback is strong (kf = 20.277), the Fano factor of B is smaller than 1, but there is also a strong repression of E[B]∞.



One might think that greater noise reduction compared to the linear filter Eq. 1 can be obtained by considering higher-order low-pass filters (i.e., low-pass filters whose transfer function has order greater than 1). However, because such filters (in the case of real and nonpositive roots) can be implemented as cascades of linear filters (Supporting Materials and Methods, Section C), in which all components are therefore limited by Poisson noise, their noise-reduction performance is similarly limited. An example of such a mechanism can be found in multistep models of gene expression (26), in which protein expression is a sequence of linear reactions, thus limited by Eq. 4. Another example can be observed in signaling cascades, such as the mitogen-activated protein kinase cascade (27), in which nonlinear filtering mechanisms are necessary to reduce stochastic fluctuations of a downstream process below Poisson levels (7).

Correlated production and degradation can reduce noise below Poisson levels
The noise filtering capability of linear filters can be improved by using higher-order reactions. The simplest second-order reaction is complex formation. We show how complex formation of two molecules that are positively correlated in their expression can indeed work as an efficient noise filter. The following network, which we call the annihilation module (Fig. 1
B), is based on the binding and degradation of two parallel synthesized molecules. The annihilation module can be described by the following two reactions: (7) M:A→r1A+B+C;B+C→r2, where A is the input and B (or equivalently C) is the output. In this module, B and C are coexpressed, and then they inhibit each other. To study how the annihilation module behaves with respect to intrinsic and extrinsic noise, we consider a general birth-death process A affected by Poisson noise. That is, A is generated and removed by the following reactions: →kpA;A→kd. 

Thus, we have E[A(t)]=V[A(t)],t∈R≥0. Because Eq. 7 is nonlinear, a general and exact analysis as in the linear case cannot be performed, as the moment equations cannot be solved. Consequently, we make use of the LNA (23, 28) and derive an analytical solution for the expectation and Fano factor of B at steady state for such an input process A. We get (see Supporting Materials and Methods, Section D) (8) E[B]∞=r1E[A]∞r2 and (9) FB=2r13/2r2kpkd+4r1r2kp−r1kd2−kd38r1r2kp−2kd3, where FB stands for the Fano factor of B at steady state. Assuming r1=rγ and r2=r, with r,γ∈R>0, then for r→0, we have FB=(1/2), thus halving the variance with respect to Poisson noise. Moreover, for r→∞, we have FC=(2+n/4), where n=(E[B]∞/E[A]∞). This leads to a surprising result: for n = 1, that is, E[B]∞=E[A]∞ (perfect tracking of the mean), the Fano factor is always smaller than 1 for arbitrarily large values of r1 and r2. Thus, M can reduce the noise even without introducing a delay in its buffering action. This can be justified because this architecture, in which B and C are coexpressed, enables attenuation of the low-frequency components of the input signal. Therefore, we obtain noise reduction even if the high-frequency components are not necessarily attenuated (Supporting Materials and Methods, Section D).

We note that, in the annihilation module, the steady-state value of the output signal is proportional not to the steady-state value of the input signal but to its square root (Eq. 8). This may be beneficial in molecular networks, in which it may help maintain regulatory stability under changes in initial conditions. However, this mechanism would not be appropriate in cases in which the long-term evolution of the upstream component should be followed, because changes to the input would not be followed proportionally (Fig. 3
B).Figure 3 Comparison of the actions of F (linear filter, Eq. 1), M (annihilation module, Eq. 7), and A (annihilation filter, Eq. 10) on noisy input A generated by reactions →kpA+A;A→kd (top row). (Middle row) Plots of expectation and standard deviation of the respective species until time 1200 are shown, as estimated by the linear noise approximation (LNA). (Bottom row) Plots of the effect of each filter obtained from a single stochastic simulation until time 4000 are shown. (A) The linear filter (Eq. 1), for k1 = 0.0064, k2 = 0.0064, introduces a delay to buffer stochastic fluctuations and reduce the noise, but only to Poisson levels. (B) For r1=0.005,r2=0.00005, the annihilation module (Eq. 7) improves noise-reduction performance but cannot proportionally follow changes in the input. In fact, Eq. 8 predicts that the expectation of the output of the annihilation module changes with the square root of input. Thus, changes on the average value of the input are attenuated in the output. (C) For r1=100,r2=1000,r3=0.000055, the annihilation filter (Eq. 10) not only improves the noise reduction capabilities compared to the other modules but also proportionally follows changes in the input.



The annihilation module is closely related to the incoherent feed-forward loop motif (14), in which two species are coexpressed and one inhibits the other. However, in Supporting Materials and Methods, Section D, we show that an incoherent feed-forward loop motif with mass action kinetics cannot reduce the noise below Poisson levels. Hence, having B and C degraded together is essential for efficient noise reduction.

The annihilation module and the annihilation filter (see next section) are also related to the antithetical integral feedback motif (10). The main similarity lies in the fact that all these modules have an annihilation reaction, thus suggesting a key role for such a reaction in dealing with noisy dynamics. However, we stress here how the mechanisms differ: a key requirement of both our filters for efficient noise reduction is the coexpression of the molecules that will participate in the annihilation reaction. This requirement cannot be implemented in the antithetical integral feedback schema. Moreover, the antithetical integral feedback motif is known to increase the noise of the controlled network (29). In fact, we argue that one of the reasons why the noise increases in the antithetical integral feedback is that the species that undergo an annihilation reaction are not coexpressed. To illustrate this point, in Fig. 4, we compare two networks: one is the annihilation filter, the other is identical to the annihilation filter except for the fact that B and D are not coexpressed but only positively correlated in their expression. The two networks, deterministically, behave identically (they have same rate equations). However, interestingly, the stochastic behavior is completely different, thus demonstrating the importance of coexpression.Figure 4 We consider two networks with the same rate equations that differ only in how B and D are expressed. For both figures, we plot a stochastic simulation of an input signal A affected by Poisson noise with the output of the filter. (A) considers the annihilation filter (Eq. 10). (B) considers a network that is identical to the one in (A), except for the fact that B and D are not coexpressed.



Annihilation filter suppresses molecular noise
We propose a general architecture, called the annihilation filter, which is based on the annihilation module but also guarantees E[C]∞=sE[A]∞ for a given constant s, independently of E[A]∞ (in what follows, without any loss of generality, we assume s = 1). We show how the annihilation filter can asymptotically reduce molecular noise to zero, that is, for appropriate limiting values for the rates, the Fano factor of the output converges to zero (Eq. 15).

Our annihilation filter, A, is illustrated in Fig. 3
C. A is composed of the following reactions: (10) A:A→r1A+B+DD→r1EB+E→r2B+A→r3A+CE+C→r3. 

A is the input species and C is the output-filtered species. The first three reactions are similar to the annihilation module, but with an additional delay introduced by the reaction D→r1E. Equation 3 guarantees that D is a copy of A, and the number of times that D molecules have been produced or destroyed is stored respectively in B and E. As the role of these reactions is to act as a sensor, high values of r1 are more informative than small ones. If r2 is large enough, the count of C is modified not any time a B or E molecule is produced but just by their difference. The fourth and fifth reactions increase or decrease C. The rate r3 controls the delay introduced by the filter and thus also the noise reduction.

Because the system is nonlinear, to study the noise-reduction capabilities of the annihilation filter, we make use of the LNA. We assume A is a general input process with extrinsic noise modeled by a Poisson process. That is, A is generated and removed by the following reactions: →kpA;A→kd. 

Thus, we have E[A(t)]=V[A(t)],t∈R≥0. Using the LNA equations, we can derive the following conditions (Supporting Materials and Methods, Section E): (11) E[A]∞=E[D]∞,  (12) E[C]∞=E[D]∞E[B]∞E[E]∞,  (13) 0=r1E[D]∞−r2E[B]∞E[E]∞−r3E[E]∞E[C]∞, and (14) E[B(t)]−E[E(t)]=E[B(0)]−E[E(0)]+E[D(t)]−E[C(t)]. 

Assuming the same initial concentration of B, E, at steady state, C will always track A independently of the value of r1,r2,r3. That is, E[A]∞=E[C]∞.

We can now study the Fano factor of C at steady state, FC. To do that, we assume r2=(γ/r),r3=r, where γ, r are constants. For the annihilation filter to work as an efficient noise filter, as we discussed, we need large r2 and small r3. Thus, we study FC for r→0. Under this limit, we obtain the following elegant form for the Fano factor of C: limr→0FC=kpkp+r1. 

Hence, we have that (15) limr1→∞(limr→0FC)=0. 

Thus, by increasing r1, the noise can be made arbitrarily small, showing how this architecture has ideal noise-reduction capabilities: independently of the intrinsic noise introduced, the total noise can be made arbitrarily close to 0.

Note that in the CRN (29), it is assumed that some reactions have same rates. This assumption allows us to obtain simpler analytic results. To show that the above analysis also remains valid in the more general scenario in which the reactions have different rates, we consider the following CRN, modifying (29): (16) A:A→r1,1A+B+DD→r1,2EB+E→r2B+A→r3,1A+CE+C→r3,2. 

In Fig. 5, we compute FC and E[C]∞ for different values of r1,1,r1,2, and r3,1,r3,2. It is easy to observe that Eq. 15 is confirmed: if r1,1,r1,2 are big enough compared to r3,1,r3,2 the Fano factor will decrease, converging to a value of 0. Nevertheless, if r1,1≠r1,2 or r3,1≠r3,2, the noise will still be reduced, but this will affect E[C]∞, which may be different from E[A]∞.Figure 5 For the CRN in Eq. 16, the figure shows how the Fano factor of (C), FC, and the mean value of (C) at steady state, E[C]∞, depend on r1,1,r1,2 and r3,1,r3,2. For all figures, we consider an input species (A) such that E[A]∞=100 and (A) is affected by Poisson noise. It is possible to observe that as predicted by the theoretical analysis, the Fano factor tends to decrease either when both r1,1,r1,2 increase or when both r3,1,r3,2 decrease. Interestingly, note that FC tends to be smaller when there is a strong suppression of the mean. Thus, when a low number of molecules is involved, the noise has more influence on the behavior of the system. (A and C) We plot FC and E[C]∞ for r1,1=r1,2=10 and r2=100. The nonlinearity of the reactions involved is such that FC and E[C]∞ are robust with respect to parameter variation. (B and D) We plot FC and E[C]∞ for r3,1=r3,2=0.001 and r2=100. In this case, E[C]∞ changes linearly with the rates. FC tends to increase when there is a strong amplification of E[C]∞.



The first two reactions of the annihilation filter (Eq. 10) can be thought of as a model for coexpression of molecules B and E at different rates. Such a model of coexpression can be generalized as having B and E coexpressed and then interacting after a pathway of linear reactions. For instance, this is the case for mRNA and microRNA, which, when coexpressed, undergo a series of maturation steps before interacting (26, 30). In Fig. 6, we show that these auxiliary reactions do not influence the noise-reduction capabilities of the annihilation filter.Figure 6 (A) Annihilation filter for an input process A affected by Poisson noise. (B) A generalization of the annihilation filter in which coexpression of molecules requires more intermediate steps is shown. Reaction rates are chosen such that E[A]∞=E[C]∞. We can observe that the Fano factor of the output remains constant for both networks.



Numerical analysis
Although the mathematical analysis performed on linear filters is exact and general, for the annihilation module and annihilation filter, our claims are based on the LNA and for birth-death input processes. This is because those filters are nonlinear; hence, exact analysis based on the moment equations is not possible. Thus, we need to support our results about the noise-suppression capabilities of such networks with stochastic simulations of such filters for different classes of input. To do that, in Fig. 3, we consider a step-like perturbation, and in Supporting Materials and Methods, Section F, we consider oscillatory inputs. In both cases, the annihilation filter outperforms the other filters: for the same delay introduced, it suppresses more noise at the high frequencies while still maintaining similar long-term behavior. However, the annihilation module does not follow the long-term behavior of the input proportionally. In fact, Eq. 8 predicts that the expectation of the output of the annihilation module changes with the square root of input. Thus, changes of the input are attenuated in the output.

To further confirm the mathematical analysis, using stochastic simulations, we compare the power spectral density (PSD) (see Materials and Methods) of the input species affected by Poisson noise with the PSD of the output species of the annihilation filter (Eq. 10) and of the linear filter (Eq. 1), both for the same input (see Fig. 7
A). We can see that both filters are indeed low-pass filters in the sense that they attenuate the high frequencies. However, although they behave similarly at the high frequencies, the linear filter is less robust to intrinsic noise, and such intrinsic noise amplifies the low frequencies, resulting in noise reduction being lower bounded by Poisson dynamics. That is, the reactions of the linear filter introduce slow and medium time variations of the output, leading to an amplification of the low-frequency components of its spectrum. The annihilation filter enables a much better reduction of the intrinsic noise, leading to a smaller amplification of the low frequencies. The connection between the noise of a process and its PSD is explained in detail in the Supporting Materials and Methods, Section A).Figure 7 (A) Power spectral density (PSD) of input affected by Poisson noise (green), compared with the output of the linear filter (Eq. 1) applied on such input (blue) and of the annihilation filter (Eq. 10) (red). For the linear filter, we fix the following parameters k1 = k2 = 0.008, whereas for the annihilation filter, we have r1=1,r2=10,r3=0.00008. The Poisson input is generated by the following reactions: →100Input;Input→1. The power spectrum is estimated using the Blackman-Tukey spectral estimate algorithm with frequency deep resolution (49), as implemented in MATLAB over 300,000 data points with a sampling time of 0.1 s. For each system, we plot the 99% confidence interval. (B) The Fano factors of the annihilation module (blue), annihilation filter (yellow), and linear filter (red) for an input affected by Poisson noise (dotted line) are shown. The outputs of the filters are constrained to have the same expectation as the input species at steady state. The plots are of the function of the remaining free rate parameters. The Fano factor is estimated by means of the LNA.



In Fig. 7
B, we consider again an input species A affected by Poisson noise, and, on this input, we compare the action of the annihilation filter (Eq. 10), annihilation module (Eq. 7), and linear filter (Eq. 1). To reduce the number of free variables in the system, we constrain the output of the filters to have the same mean as A. Then we plot the Fano factor as a function of the remaining free rate parameters. As expected, our key observations are that the annihilation module is the only mechanism that guarantees noise reduction for any value of the parameter rate, confirming the theoretical result of Eq. 9 that it is able to reduce the noise even without introducing a delay in its buffering action. Also, for an arbitrarily long delay, the annihilation filter converges to a Fano factor of 0, showing the ability of this network to remove all the noise (variance tends to 0 when delay tends to infinity). On the other hand, the linear filter converges to a Fano factor of 1, corresponding to Poisson levels, thus confirming Eq. 5.

Discussion
Gene and protein expression can work as linear filters
Gene expression is often modeled as a two- or three-stage process, in which mRNA is transcribed from a transcription factor TF and the protein P is translated from the mRNA (31): TF→kmTF+mRNA;mRNA→dm;mRNA→kPmRNA+P;P→dP. Under this modeling assumption, the linear filtering mechanism (Eq. 1) may be present both at the transcription (top two reactions) and translation level (bottom two reactions) to buffer noise and increase robustness by slowing down transcription or translation. At the transcription level, inefficient transcription that follows fast promoter activation is a mechanism that has been widely observed to buffer fluctuations in the mRNA time evolution (32). At the translation level, the linear filtering mechanism reduces the noise in protein expression, as supported by experimental evidence in Bacillus subtilis and Saccharomyces cerevisiae (33, 34). Equation 4 guarantees that independently of the presence of an arbitrary number of feed-forward or feedback loops between P and transcription factor or mRNA, we have (17) V[P]∞=E[P]∞+kPdPCov[mRNA,P]∞. 

Thus, if mRNA and protein are positively correlated, then the stochastic fluctuations in protein expression cannot be reduced below Poisson levels, and this limit is approached for slow translation. Hence, Eq. 17 may explain why in yeast and Escherichia coli, the translation rates tend to be slower than the transcription rates (32, 35) and also suggests that mechanisms to induce a negative correlation between protein and mRNA may have been selected to enhance robustness. This is the case for negative feedback, which may thus enable noise reduction below Poisson levels, as again confirmed by experimental evidence (13). We note that a more realistic model of gene expression requires representation of transcription and translation as multistep processes. However, because such processes can still be modeled as a sequence of first-order reactions (26), our analysis and the linear-filter mechanism still apply.

MicroRNAs can serve as annihilation filters
Slow translation/transcription is a very simple mechanism of noise reduction. Because gene expression involves low molecular counts and highly stochastic signals, different (and more complex) network architectures may have been selected to deal with scenarios in which greater noise reduction is needed (36). A simple example can be found in microRNA-regulated post-transcriptional regulation. MicroRNAs (miRNAs) are short RNAs that are widely conserved in biological networks (37). In animals, it is common that miRNAs and their target mRNAs are coexpressed or positively correlated in their expression (38, 39, 40). For example, c-Myc induces the expression of the miRNAs miR-17-5p and miR-20a together with their target E2F1 (41). Furthermore, the system in which miRNAs repress gene expression by binding with the target mRNAs and either inhibiting translation of mRNA or promoting mRNA decay (42, 43) leads to a pattern that can be modeled with the annihilation module (Fig. 1
B). Although it is well accepted that miRNAs confer robustness on gene expression (8, 38, 44), it is still not clear what aspects of their inhibitory mechanisms are used to gain efficient noise reduction (45), and previous analysis has focused on miRNAs that are not coexpressed with the target proteins (8). One hypothesis is that coexpression of miRNAs with their targets has a role in increasing robustness of gene expression (36). This is also supported by experimental evidence (46). Our mathematical analysis confirms such a hypothesis and shows that correlated expression of miRNAs and mRNA, followed by translational repression of the mRNA when bound to the microRNA, may lead to noise reduction below Poisson levels. This result suggests that microRNA regulation may have been selected to postregulate highly noisy genes. One specific example of such a pattern can be found in the Drosophila eye, where miR-7 and its target protein are coexpressed and experimental studies have suggested the role of miR-7 in buffering fluctuations (39, 47). A particular network involving miR-7 and verified experimentally in (47) is shown in Fig. 8. This network is responsible for sensory organ precursor fate. An annihilation module between Ato, miR-7, and E(slp) genes may have a role in increasing robustness. We stress that it has yet to be verified experimentally that miR-7 works as an annihilation filter, especially because of the lack of experiments concerning the joint degradation of microRNA and mRNA in different organisms (48).Figure 8 The network controlling sensory organ precursor fate (47). miR-7 participates in an annihilation module highlighted in black. The annihilation module is also interconnected with a double-negative feedback loop between Ato and E(spl), with miR-7 as an effector of Ato and E(spl) directly inhibiting Ato.



We have also found that the annihilation filter (Eq. 10) may be a suitable model for the c-Myc|E2F1|hsa-miR-20a circuit, with its extension to E2F2 in the case when E2F1 activates E2F2 (40, 41) (Fig. 1
C). This may suggests that miR-20a, by repressing both E2F1 and E2F2, confers greater robustness on E2F2 expression. We note, however, that there is no experimental evidence yet for whether E2F1 activates or represses E2F2. Note that the annihilation filter link between A (c-Myc) and C (E2F2) is not present here: its role is to regulate the mean of the output, but it has no influence on noise reduction.

In conclusion, we analyzed three simple molecular noise filters and derived their properties and limitations. These filters can be related to biological mechanisms. We show, for example, that gene expression with slow translation/transcription can reduce noise but only down to Poisson levels (Eq. 17), even when considering linear multiple-step models (26). In contrast, the annihilation module (Eq. 7), which relies on coexpression and joint degradation, can drive the noise below Poisson levels. Such mechanisms can be related to microRNA regulated systems, in which a key requirement for effective noise reduction is the coexpression of mRNA with its miRNAs. Our analysis suggests how a trade-off between performance and resources arises: simpler circuits can reduce less noise but also require fewer resources. In this sense, it is interesting to emphasize that complex noise reduction mechanisms, such as the annihilation module, tend to be found in highly regulated systems. In fact, coexpression of mRNA and microRNA, followed by translation inhibition, is a pattern that is common in animals but much less prevalent in plants (42).

Although biological systems deal with noise in a variety of ways, in this study, we focused on scenarios in which noise should be controlled. It remains an interesting endeavor to similarly discover and analyze the basic principles that allow biological systems to exploit noise functionally and use it to their benefit (2). We believe that a systematic analysis of noise reduction in molecular systems, together with evidence of widespread noise-reduction capabilities in biological systems such as in gene expression, are fundamental to obtaining new insights into the structure and evolutionary origin of noise-reduction mechanisms.

Author Contributions
L.C, A.C.-N., and L.L. designed the research. L.L. performed the research. All authors contributed to analysis, interpretation of the outcomes, and preparation of the manuscript.

Supporting Material
Document S1. Supporting Materials and Methods and Figs. S1–S8
 Document S2. Article plus Supporting Material
 

Acknowledgments
The authors thank Alessandro Abate and Neil Dalchau for comments on a draft of the manuscript.

L.C. is partially funded by a Royal Society Professorship grant RP120138.

Supporting Materials and Methods and eight figures are available at http://www.biophysj.org/biophysj/supplemental/S0006-3495(18)30585-X.
==== Refs
References
1 Balázsi G.  van Oudenaarden A.  Collins J.J.   Cellular decision making and biological noise: from microbes to mammals Cell 144 2011 910 925 21414483 
2 Eldar A.  Elowitz M.B.   Functional roles for noise in genetic circuits Nature 467 2010 167 173 20829787 
3 Ethier S.N.  Kurtz T.G.   Markov Processes: Characterization and Convergence Volume 282 2009 John Wiley & Sons Hoboken, NJ 
4 Kaern M.  Elston T.C.  Collins J.J.   Stochasticity in gene expression: from theories to phenotypes Nat. Rev. Genet 6 2005 451 464 15883588 
5 McAdams H.H.  Arkin A.   Stochastic mechanisms in gene expression Proc. Natl. Acad. Sci. USA 94 1997 814 819 9023339 
6 Raj A.  van Oudenaarden A.   Nature, nurture, or chance: stochastic gene expression and its consequences Cell 135 2008 216 226 18957198 
7 Thattai M.  van Oudenaarden A.   Attenuation of noise in ultrasensitive signaling cascades Biophys. J 82 2002 2943 2950 12023217 
8 Schmiedel J.M.  Klemm S.L.  van Oudenaarden A.   Gene expression. MicroRNA control of protein expression noise Science 348 2015 128 132 25838385 
9 Sedra A.S.  Smith K.C.   Microelectronic Circuits Volume 1 1998 Oxford University Press New York 
10 Briat C.  Gupta A.  Khammash M.   Antithetic integral feedback ensures robust perfect adaptation in noisy biomolecular networks Cell Syst 2 2016 15 26 27136686 
11 Samoilov M.  Arkin A.  Ross J.   Signal processing by simple chemical systems J. Phys. Chem. A 106 43 2002 10205 10221 
12 Zechner C.  Seelig G.  Khammash M.   Molecular circuits for dynamic noise filtering Proc. Natl. Acad. Sci. USA 113 2016 4729 4734 27078094 
13 Becskei A.  Serrano L.   Engineering stability in gene networks by autoregulation Nature 405 2000 590 593 10850721 
14 Mangan S.  Alon U.   Structure and function of the feed-forward loop network motif Proc. Natl. Acad. Sci. USA 100 2003 11980 11985 14530388 
15 Lestas I.  Vinnicombe G.  Paulsson J.   Fundamental limits on the suppression of molecular fluctuations Nature 467 2010 174 178 20829788 
16 Rao C.V.  Wolf D.M.  Arkin A.P.   Control, exploitation and tolerance of intracellular noise Nature 420 2002 231 237 12432408 
17 Munsky B.  Neuert G.  van Oudenaarden A.   Using gene expression noise to understand gene regulation Science 336 2012 183 187 22499939 
18 Thattai M.  van Oudenaarden A.   Intrinsic noise in gene regulatory networks Proc. Natl. Acad. Sci. USA 98 2001 8614 8619 11438714 
19 Pedersen M.  Phillips A.   Towards programming languages for genetic engineering of living cells J. R. Soc. Interface 6 Suppl 4 2009 S437 S450 19369220 
20 Horn F.  Jackson R.   General mass action kinetics Arch. Ration. Mech. Anal 47 2 1972 81 116 
21 Stein E.M.  Weiss G.   Introduction to Fourier Analysis on Euclidean Spaces (PMS-32) Volume 32 2016 Princeton university press Princeton, NJ 
22 McAdams H.H.  Arkin A.   It’s a noisy business! Genetic regulation at the nanomolar scale Trends Genet 15 1999 65 69 10098409 
23 Van Kampen N.G.   Stochastic Processes in Physics and Chemistry Volume 1 1992 Elsevier New York 
24 Engblom S.   Computing the moments of high dimensional solutions of the master equation Appl. Math. Comput 180 2 2006 498 515 
25 Singh A.  Hespanha J.P.   Approximate moment dynamics for chemically reacting systems IEEE Trans. Automat. Contr 56 2 2011 414 418 
26 Pedraza J.M.  Paulsson J.   Effects of molecular memory and bursting on fluctuations in gene expression Science 319 2008 339 343 18202292 
27 Seger R.  Krebs E.G.   The MAPK signaling cascade FASEB J 9 1995 726 735 7601337 
28 Cardelli L.  Kwiatkowska M.  Laurenti L.   Stochastic analysis of chemical reaction networks using linear noise approximation Biosystems 149 2016 26 33 27816736 
29 Briat, C., A. Gupta, and M. Khammash. 2017. Variance reduction for antithetic integral control of stochastic reaction networks. arXiv, arXiv:1711.08291, https://arxiv.org/abs/1711.08291.
30 Bartel D.P.   MicroRNAs: genomics, biogenesis, mechanism, and function Cell 116 2 2004 281 297 14744438 
31 Shahrezaei V.  Swain P.S.   Analytical distributions for stochastic gene expression Proc. Natl. Acad. Sci. USA 105 2008 17256 17261 18988743 
32 Raser J.M.  O’Shea E.K.   Noise in gene expression: origins, consequences, and control Science 309 2005 2010 2013 16179466 
33 Blake W.J.  KAErn M.  Collins J.J.   Noise in eukaryotic gene expression Nature 422 2003 633 637 12687005 
34 Ozbudak E.M.  Thattai M.  van Oudenaarden A.   Regulation of noise in the expression of a single gene Nat. Genet 31 2002 69 73 11967532 
35 Fraser H.B.  Hirsh A.E.  Eisen M.B.   Noise minimization in eukaryotic gene expression PLoS Biol 2 2004 e137 15124029 
36 Hornstein E.  Shomron N.   Canalization of development by microRNAs Nat. Genet 38 Suppl 2006 S20 S24 16736020 
37 Bartel D.P.   MicroRNAs: target recognition and regulatory functions Cell 136 2009 215 233 19167326 
38 Ebert M.S.  Sharp P.A.   Roles for microRNAs in conferring robustness to biological processes Cell 149 2012 515 524 22541426 
39 Posadas D.M.  Carthew R.W.   MicroRNAs and their roles in developmental canalization Curr. Opin. Genet. Dev 27 2014 1 6 24791686 
40 Re A.  Corá D.  Caselle M.   Genome-wide survey of microRNA-transcription factor feed-forward regulatory circuits in human Mol. Biosyst 5 2009 854 867 19603121 
41 O’Donnell K.A.  Wentzel E.A.  Mendell J.T.   c-Myc-regulated microRNAs modulate E2F1 expression Nature 435 2005 839 843 15944709 
42 Ameres S.L.  Zamore P.D.   Diversifying microRNA sequence and function Nat. Rev. Mol. Cell Biol 14 2013 475 488 23800994 
43 Krol J.  Loedige I.  Filipowicz W.   The widespread regulation of microRNA biogenesis, function and decay Nat. Rev. Genet 11 2010 597 610 20661255 
44 Kasper D.M.  Moro A.  Nicoli S.   MicroRNAs establish uniform traits during the architecture of vertebrate embryos Dev. Cell 40 2017 552 565.e5 28350988 
45 Bakker R.  Carthew R.W.   MicroRNAs make a difference in cardiovascular robustness Dev. Cell 40 2017 515 516 28350982 
46 Strovas T.J.  Rosenberg A.B.  Seelig G.   MicroRNA-based single-gene circuits buffer protein synthesis rates against perturbations ACS Synth. Biol 3 2014 324 331 24847681 
47 Li X.  Cassidy J.J.  Carthew R.W.   A microRNA imparts robustness against environmental fluctuation during development Cell 137 2009 273 282 19379693 
48 Baccarini A.  Chauhan H.  Brown B.D.   Kinetic analysis reveals the fate of a microRNA following target regulation in mammalian cells Curr. Biol 21 2011 369 376 21353554 
49 Stoica P.  Moses R.L.   Spectral Analysis of Signals Volume 452 2005 Pearson Prentice Hall Upper Saddle River, NJ

