
==== Front
BiometrikaBiometrikabiometBiometrika0006-34441464-3510Oxford University Press 10.1093/biomet/asx034asx034ArticlesIdentification and estimation of causal effects with outcomes truncated by death Wang Linbo *
* 
Department of Biostatistics, Harvard School of Public Health, 677 Huntington Avenue, Boston, Massachusetts 02115, U.S.A.
linbowang@g.harvard.edu
Zhou Xiao-Hua *
* 
Department of Biostatistics, University of Washington, Seattle, Washington 98195, U.S.A.
azhou@u.washington.edu
Richardson Thomas S. *
* 
Department of Statistics, University of Washington, Seattle, Washington 98195, U.S.A.
thomasr@u.washington.edu
9 2017 11 7 2017 01 9 2018 104 3 597 612 17 5 2016 © 2017 Biometrika Trust2017Summary
It is common in medical studies that the outcome of interest is truncated by death, meaning that a subject has died before the outcome could be measured. In this case, restricted analysis among survivors may be subject to selection bias. Hence, it is of interest to estimate the survivor average causal effect, defined as the average causal effect among the subgroup consisting of subjects who would survive under either exposure. In this paper, we consider the identification and estimation problems of the survivor average causal effect. We propose to use a substitution variable in place of the latent membership in the always-survivor group. The identification conditions required for a substitution variable are conceptually similar to conditions for a conditional instrumental variable, and may apply to both randomized and observational studies. We show that the survivor average causal effect is identifiable with use of such a substitution variable, and propose novel model parameterizations for estimation of the survivor average causal effect under our identification assumptions. Our approaches are illustrated via simulation studies and a data analysis.

Causal inferenceInstrumental variableModel parameterizationPrincipal stratificationSurvivor average causal effectNational Institutes of Health10.13039/100000002
==== Body
1. Introduction
In medical studies, researchers are often interested in evaluating risk factors for a non-mortality outcome. However, this outcome may be truncated by death and hence undefined if some subjects die before the follow-up assessment. For example, suppose we are interested in estimating the effect of smoking on memory decline in an aged population. If a subject dies before the follow-up memory test is administered, then his/her memory score at the follow-up visit is undefined. Direct comparisons between smokers and non-smokers among observed survivors are subject to selection bias, as non-smokers are more likely to survive to the follow-up assessment, and survival is associated with memory decline (Rosenbaum, 1984; Robins & Greenland, 1992). More fundamentally, direct comparisons between observed survivors are not causally interpretable, as they compare outcomes from different subpopulations at baseline (Rubin, 2006). Robins (1986, § 12.2) proposed estimating the average causal effect in the always-survivor group, the group of subjects who would survive if they chose to receive either exposure at baseline. The always-survivor group was later termed a principal stratum by Rubin (1998) and Frangakis & Rubin (1999, 2002), and the contrast within this group is the survivor average causal effect. This contrast is causally interpretable because membership of the always-survivor group is defined at baseline, and since these subjects always survive, their subsequent outcomes under both treatments are well-defined. Alternative estimands are discussed by Kurland et al. (2009) and Weuve et al. (2012).

The survivor average causal effect is not identifiable without further assumptions (Zhang & Rubin, 2003). Large-sample bounds for the survivor average causal effect have been derived under minimal assumptions (Zhang & Rubin, 2003; Imai, 2008; Long & Hudgens, 2013). In order to identify this effect, it is common to perform a sensitivity analysis by assuming a class of identification conditions indexed by a sensitivity parameter (Gilbert et al., 2003; Hayden et al., 2005; Shepherd et al., 2006; Egleston et al., 2007; Jemiai et al., 2007; Chiba & VanderWeele, 2011).

Alternatively, identification of the survivor average causal effect can be based on covariate information. For example, Tchetgen Tchetgen (2014) introduced a variant of the survivor average causal effect that is identified when risk factors of survival are available in post-exposure follow-ups. The resulting causal contrast is for a principal stratum defined in terms of particular post-exposure risk factors. Hence, in principle, the causal estimand can differ depending on the set of post-exposure risk factors used in the analysis. Ding et al. (2011) took a different approach to identifying the survivor average causal effect in a randomized study setting. They proposed a semiparametric identification method based on a baseline variable whose distribution is informative of the membership of the always-survivor group. Using this baseline variable, they showed that the survivor average causal effect was identifiable under their assumptions. However, as pointed out by Tchetgen Tchetgen (2014), their assumptions essentially require that there be no common causes of the survival and outcome processes, which is very unlikely even in randomized studies.

In this article, we relax the identification assumptions of Ding et al. (2011) by employing more detailed covariate information. In contrast to the estimand of Tchetgen Tchetgen (2014), our causal parameter is defined independently of the covariates incorporated in the analysis. Furthermore, the proposed approach is applicable to both randomized trials and observational studies, and allows for measured common causes of the survival and outcome processes. We also discuss possible violations of, and alternative approaches to, our identification model. To estimate the survivor average causal effect in practice, we impose additional distributional assumptions. This is challenging for two reasons. First, unlike the standard observational study setting, in our identification framework the baseline covariates may be common causes between any pair of treatment, survival and outcome. As we explain in § 4, this unique role for baseline covariates makes the standard propensity score methods inappropriate in our setting. Second, novel model parameterizations are needed to make our distributional assumptions compatible with our identification assumptions.

2. Data structure, notation and causal estimand
Consider a medical study with a single follow-up visit. Let Z be the exposure indicator and let W denote covariates observed at baseline. We assume that each subject has two potential survival outcomes, S(1) and S(0), defined as the survival statuses at the follow-up visit that would have been observed had the subject been exposed and unexposed, respectively. Similarly, we let Y(1) and Y(0) denote the potential non-mortality outcomes under exposure and nonexposure, respectively. We assume that for z=0, 1, Y(z) takes real values only if S(z)=1. We extend the definition of Y(z) so that it takes the constant value * if S(z)=0.

We use G to denote the survival type as defined in Table 1, in which L represents live and D represents die. One can see from Table 1 that there exists a one-to-one mapping between the survival type and the bivariate potential survival {S(1),S(0)}, so G can be interpreted as an abbreviation for {S(1),S(0)}.


Table 1 
Patient survival types 


S(1)
	
S(0)
	Survival type	
G
	Description	
1	1	Always-survivor	
LL
	The subject always survives, regardless of exposure status	
1	0	Protected	
LD
	The subject survives if exposed, but dies if not exposed	
0	1	Harmed	
DL
	The subject dies if exposed, but survives if not exposed	
0	0	Doomed	
DD
	The subject always dies, regardless of exposure status	



We adopt the axiom of consistency such that the observed outcome Y satisfies Y=ZY(1)+(1-Z)Y(0) and the observed survival S satisfies S=ZS(1)+(1-Z)S(0). The observed samples Oi=(Zi,Wi,Si,Yi)(i=1,…,N) are independently drawn from an infinite superpopulation.

Throughout this article, we assume that there is no interference between study subjects with respect to both the survival S and the non-mortality outcome Y, and that there is only one version of exposure (Rubin, 1980).


Rubin (2000) noted that the survivors observed in the exposed group are from a mixture of the always-survivor and protected strata, while the survivors observed in the nonexposed group are from a mixture of always-survivor and harmed strata. As a result, direct comparisons between different exposure groups among observed survivors are not causally meaningful, as these people are from different subpopulations at baseline. To address this issue, since the always-survivor stratum is the only group for which Y(1) and Y(0) both take real values, we define our causal estimand to be the average causal effect in this stratum:
 ΔLL=E{Y(1)−Y(0)∣G=LL}. 

This estimand is also known as the survivor average causal effect.

3. Identification of the survivor average causal effect
3.1. The identification problem
Although causally interpretable, the survivor average causal effect is in general not identifiable as it depends on the potential outcomes Y(1),Y(0),S(1) and S(0). Furthermore, it is not identifiable even under assumptions that are sufficient for identification in other causal contexts:

Assumption 1 (Monotonicity). S(1)≥S(0) almost surely.

The monotonicity assumption may be plausible in some observational studies. For example, in studies evaluating the effect of smoking on memory decline, it is widely believed that smoking is bad for overall health and hence overall survival. This assumption tends to be questionable in randomized clinical trials with acute diseases, because typically a clinical trial would be unethical if the researchers believe that one treatment benefits survival a priori. To address this issue, we relax this assumption later in § 3.4.

Assumption 2 (S-ignorability). The treatment assignment is independent of the potential survival statuses given the observed covariates W, so that Z⫫S(z)∣W for z=0, 1.

Assumption 3 (Y-ignorability). The treatment assignment in the always-survivor stratum is independent of the potential outcomes given observed covariates W, so that Z⫫Y(z)∣W,G=LL for z=0, 1.

Assumptions 2 and 3 are similar to the weakly ignorable treatment assignment assumption (see, e.g., Imbens, 2000). Under Assumption 3, we have
 (1) E{Y(z)∣G=LL} =EW(μz,LL,WπLL∣W)EW(πLL∣W), 
where μz,g,W=E(Y∣Z=z,G=g,W) and πg∣W=pr(G=g∣W). Under Assumptions 1 and 2, Z⫫{S(1),S(0)}∣W, so the W-specific survival-type probabilities are identified by
 (2) πLL∣W=pr(S=1∣Z=0,W),πLD∣W=pr(S=1∣Z=1,W)−pr(S=1∣Z=0,W); μ0,LL,W can be identified by
 (3) μ0,LL,W=E(Y∣Z=0,S=1,W). 

However, μ1,LL,W is not identifiable from the observed data. In fact, as noted by Zhang & Rubin (2003), the observed data in the group {i:Zi=1,Si=1,Wi=wi} can be written as a mixture of two distributions from the LL and LD strata:
 F(y∣Z=1,S=1,W)=∑g=LL,LDpg∣1,W,s=1F(y∣Z=1,G=g,W), 
where F denotes the cumulative distribution function, and for g=LL or LD, pg∣z,W,s=1≡pr(G=g∣W)/pr(S=1∣Z=z,W) is identifiable from data. Unless the mixing probability pLL∣1,w,s=1 is 1 or 0, μ1,LL,W is only partially identifiable in that there is a range of values for μ1,LL,W that are compatible with the observed data distribution.

3.2. Identifying the survivor average causal effect using a substitution variable
To identify the survivor average causal effect, without loss of generality we assume that the baseline covariates W can be written as (X,A). We propose an identification framework in which the role of X is similar to a confounder while that of A is similar to an instrument. Specifically, we make the following assumptions on A and X:

Assumption 4 (Exclusion restriction). A⫫Y(1)∣Z=1,G,X;

Assumption 5 (Substitution relevance). A⧸⊥⊥G∣Z=1,S=1,X.

The survival type G is a latent baseline variable that satisfies Assumptions 4 and 5. For this reason, any variable A satisfying Assumptions 4 and 5 is called a substitution variable for G. The conditions for a substitution variable are similar to those for an instrumental variable (Angrist et al., 1996). Specifically, Assumption 4 is similar to the exclusion restriction assumption in an instrumental variable analysis in that they both capture the notion of A having no direct effect on Y, and Assumption 5 is similar to the instrumental relevance assumption; in particular, they both require that A be a relevant variable. We clarify that, similar to the instrumental relevance assumption, Assumption 5 needs to hold for all possible values of X. As we illustrate in § 3.3, even in a randomized study setting, the inclusion of covariate information X makes Assumptions 4 and 5 more plausible.

Theorem 1 below states that the survivor average causal effect is identifiable with a substitution variable for the survival type. Proofs of the theorems can be found in the Supplementary Material.

Theorem 1. 
Under Assumptions 1–5, ΔLL is identifiable. 

When A takes more than two values, ΔLL may be over-identified. In this case, one may falsify our identification assumptions using specification tests such as the Sargan–Hansen test (Hansen, 1982).

3.3. A nonparametric structural equation model with independent errors
The key assumptions in our identification model are Assumptions 2–4. These are implied by a certain nonparametric structural equation model with independent errors (Pearl, 2009), given by
 (4) X =fX(ϵX),A=fA(X,ϵA),Z=fZ(X,A,ϵZ),S =fS(X,A,Z,ϵS),Y=fY(X,Z,S,ϵY), 
where the error terms ϵX,ϵA,ϵZ,ϵS and ϵY are jointly independent. Here the error terms can be interpreted as the set of one-step-ahead counterfactuals; for example, ϵZ can be interpreted as {Z(a,x)​:a∈A,x∈X}, where A and X are the sample spaces for A and X, respectively. Figure 1 gives the simplest causal diagram associated with (4). There is no directed edge from A to Y, encoding the notion that A has no direct effect on Y. We remark that Assumptions 2–4 also follow from (4) with dependent errors that allow for unmeasured confounding between nodes in Fig. 1. See the Supplementary Material for examples.

Fig. 1. The simplest causal diagram associated with the structural equations (4).

In contrast to the identification assumptions in Ding et al. (2011), we include baseline covariates X in our identification framework. Our approach is applicable to observational studies, since we allow for the edge X→Z. Moreover, we allow for edges X→S and X→Y, thereby avoiding the assumption that there are no common causes of the survival and outcome processes, which is very restrictive even for randomized studies.

Remark 1. The assumptions of a nonparametric structural equation model with independent errors cannot be tested, even in principle, via any randomized experiment on the measured variables (Robins & Richardson, 2010).

3.4. Alternatives to the individual-level monotonicity assumption
We now consider alternative stochastic monotonicity assumptions in place of the individual-level Assumption 1. These alternatives were used by Roy et al. (2008) in the context of noncompliance and by Lee et al. (2010) in the context of truncation by death.

We characterize the association between the potential survivals S(1) and S(0) by
 ρ(W)=pr(G=LL∣W)−pr{S(1)=1∣W}pr{S(0)=1∣W}min[pr{S(1)=1∣W},pr{S(0)=1∣W}]−pr{S(1)=1∣W}pr{S(0)=1∣W}. 

Note that ρ(W) is no larger than 1 and differs from the correlation between S(1) and S(0) by a nonnegative identifiable factor. In particular, the sign of ρ(W) coincides with the sign of the conditional correlation cor{S(1),S(0)∣W}. In practice, one might be willing to assume that the potential survivals under active treatment and control are not negatively correlated, such that
 pr{S(1)=1∣S(0)=1,W}≥pr{S(1)=1∣S(0)=0,W} 
almost surely. This gives rise to the following stochastic monotonicity assumption.

Assumption 6 (Stochastic monotonicity). We have that 0≤ρ(W)≤1 almost surely.

Note that ρ(W)=0 if and only if conditional on observed covariates W, S(1) is not correlated with S(0). On the other hand, ρ(W)=1 if and only if pr(G=LL∣W)=min[pr{S(1)=1∣W},pr{S(0)=1∣W}]. We emphasize that Assumption 6 does not reduce to Assumption 1 when ρ(W)=1; in particular, assuming a value for ρ(W)∈[0, 1] does not specify which treatment is more beneficial for survival. This is particularly appealing when the monotonicity assumption is not plausible a priori due to ethical reasons.

Theorem 2 states that under Assumptions 2–6, if we further assume that Assumptions 4 and 5 hold in the control arm, then given ρ(W), the survivor average causal effect is identifiable from the observed data. The additional conditional independence condition (i) in Theorem 2 also follows from the structural equation model (4) with independent errors.

Theorem 2. 
Suppose that Assumptions 2–6 hold and that:(i) A⫫Y(0)∣Z=0,G,X;

(ii) for all x∈X, A⧸⊥⊥G∣Z=0,S=1,X=x. 




Then ΔLL is identifiable given ρ(W). 

3.5. Relaxing the exclusion restriction assumption
In practice, the ignorability assumptions, Assumptions 2 and 3, may be questionable if there are unmeasured confounders between the exposure Z and either the survival S or the non-mortality outcome Y. Similarly, the exclusion restriction assumption, Assumption 4, may be questionable if the set of observed covariates X is not rich enough to contain all common causes of the non-mortality outcome and any one of the treatment, substitution variable and survival. There is extensive literature on relaxing the ignorability assumptions for causal inference in observational studies (see, e.g., Rosenbaum & Rubin, 1983; Imbens, 2003; Ding & Vanderweele, 2014), which may be applied here with slight modifications. Hence, in this article, we focus on alternative assumptions to relax the exclusion restriction assumption.

Specifically, we propose an alternative no-interaction assumption, which says that when conditioning on the baseline variables X, neither Z nor G modifies the effect of A on Y.

Assumption 7 (No interaction). For all x,a0 and a1,
 (5) E(Y∣Z=1,G=LD,X=x,A=a1)−E(Y∣Z=1,G=LD,X=x,A=a0)  (6)  =E(Y∣Z=1,G=LL,X=x,A=a1)−E(Y∣Z=1,G=LL,X=x,A=a0)  (7)  =E(Y∣Z=0,G=LL,X=x,A=a1)−E(Y∣Z=0,G=LL,X=x,A=a0). 

In contrast, Assumption 4, implies that the comparisons in (5) and (6) are both zero.

This no-interaction assumption may be plausible when the substitution variable affects the outcome independently of other disease processes. For example, suppose that one is interested in studying the effects of statin usage on memory decline, taking baseline dementia status as the substitution variable. It is likely that baseline dementia status will affect the outcome directly, as memory decline is irreversible: subjects with dementia are more likely to experience a decline in memory. However, it seems reasonable to assume that neither statin usage, which is typically due to high blood cholesterol levels, nor the latent survival statuses, which largely reflect baseline cholesterol levels, would interact, on the additive scale, with the process of memory decline.

To relax Assumption 4 in the absence of X, Ding et al. (2011) also assumed that (5) is equal to (6). Moreover, they placed linearity assumptions on E(Y∣Z=1,G,A) and required that the substitution variable A have at least three categories or be continuous. Both assumptions may be overly restrictive in practice; for instance, they may not hold in the example of statin usage and memory decline described above, taking A to be dementia status at baseline. This is because current knowledge on dementia suggests that baseline cognitive status has a nonlinear influence on the deterioration of cognitive score (see, e.g., Sperling et al., 2014); in addition, baseline dementia status is often coded as a binary variable. To mitigate the need for basing identification on a linearity assumption and allow for binary substitution variables, we instead assume that (6) is equal to (7); that is, Z is not an effect modifier for the conditional effect of A on Y. This is similar in spirit to the no-interaction assumption in causal mediation analysis (e.g., Robins, 2003). In particular, it is guaranteed to hold under the strong null of no treatment effect of Z on Y.

The inclusion of baseline covariates in Assumption 7 has important implications for the design of studies with truncation by death: every possible cause of the outcome should be measured, if feasible, to try to ensure that no residual effect modification remains within strata defined by X.

Theorem 3 states that if we replace the exclusion restriction assumption, Assumption 4, with Assumption 7, then the survivor average causal effect is still identifiable.

Theorem 3. 
Under Assumptions 1–3, 5 and 7, ΔLL is identifiable. 

4. Model parameterization
In the previous section we showed that the survivor average causal effect is identifiable under various identification assumptions. When the covariates W take only a few discrete values within each level of X, the identification formulae in the proofs of Theorems 1–3 imply plug-in estimators in the case of binary A and generalized method of moment estimators in the case where A takes more than two discrete values (Hansen, 1982; Ding et al., 2011). When the covariates W are continuous or high-dimensional, however, we need to impose additional distributional assumptions. We first note that the identification assumptions imply certain constraints on the observed data law, as described in Proposition 1.

Proposition 1. 
(I) The assumptions of Theorem 1 imply the following constraints on the law of (Z,S,Y,W): (8) pr(S=0∣Z=1,X,A)≤pr(S=1∣Z=1,X,A);  (9) for all x,E(Y∣Z=1,S=1,X=x,A=a) is bounded as a function of a;  (10) for all x,pr(S=1∣Z=0,X=x,A=a)pr(S=1∣Z=1,X=x,A=a) is not constant as a function of a. 

(II) The assumptions of Theorem 2 imply (9) and that (11) for all x,E(Y∣Z=0,S=1,X=x,A=a) is bounded as a function of a. 

(III) The assumptions of Theorem 3 imply (8) and that (12)  for all x,E(Y∣Z=1,S=1,X=x,A=a)−E(Y∣Z=0,S=1,X=x,A=a) is bounded as a function of a. 




To ensure that the modelling assumptions are compatible with the constraints in Proposition 1, we avoid imposing distributional assumptions directly on the observed data. Instead, we make the following distributional assumptions on the law of {Z,W,S(1),S(0),Y(1),Y(0)}, which are compatible with the identification assumptions. For brevity, here we only give models under the assumptions of Theorem 1. Parameterizations for estimating ΔLL under alternative identification assumptions which are similar in spirit are described in the Appendix.

Model 1. The expectation E{Y(0)∣Z=0,G=LL,X,A} is known up to a finite-dimensional parameter α1; that is, E{Y(0)∣Z=0,G=LL,X,A}=m1(X,A;α1), where m1(⋅,⋅;α1) is a known function and α1 is an unknown parameter. Specifically, for the simulations and data example we consider
 (13) m1(X,A;α1)=α10+XTα11+Aα12. 

Model 2. The expectation E{Y(1)∣Z=1,X,G,A} is known up to a finite-dimensional parameter α2; that is, E{Y(1)∣Z=1,X,G,A}=m2(X,G;α2), where G takes values in {LL,LD}, m2(⋅,⋅;α2) is a known function and α2 is an unknown parameter. Note that due to Assumption 4, E{Y(1)∣Z=1,X,G,A} does not depend on the value of A. Specifically, for the simulations and data example we code LL to be 1 and LD to be 0, and consider
 (14) m2(X,G;α2)=α20+XTα21+Gα23. 

Model 3. The probability pr{S(1)=1∣X,A} is known up to a finite-dimensional parameter β1; that is, pr{S(1)=1∣X,A}=θ1(X,A;β1), where θ1(⋅,⋅;β1) is a known function and β1 is an unknown parameter. Specifically, for the simulations and data example we consider
 (15) θ1(X,A;β)=expit(β10+XTβ11+Aβ12). 

Model 4. The probability pr{S(0)=1∣X,A}/pr{S(1)=1∣X,A} is known up to a finite-dimensional parameter γ; that is, pr{S(0)=1∣X,A}/pr{S(1)=1∣X,A}=θ0/1(X,A;γ), where θ0/1(⋅,⋅;γ) is a known function and γ is an unknown parameter. Specifically, for the simulations and data example we consider
 (16) θ0/1(X,A;γ)=expit(γ0+XTγ1+Aγ2). 

Models 3 and 4 may be replaced by distributional assumptions on pr{S(z)∣X,A} (z=0, 1) (e.g., Lee et al., 2010). However, constraint (8) implies that pr{S(0)=1∣X,A} lies in the range [0,pr{S(1)=1∣X,A}]. Hence the model parameters for pr{S(1)=1∣X,A} live in a constrained space, making estimation and asymptotic analysis difficult. To avoid such constraints, we reparameterize our models as in Models 3 and 4.

To derive the maximum likelihood estimator, we note that Models 1–4 correspond to the following modelling constraints on the observed data distribution:
 pr(S=1∣Z=1,X,A) =θ1(X,A;β1),pr(S=1∣Z=0,X,A) =θ1(X,A;β1)θ0/1(X,A;γ),E(Y∣Z=1,S=1,X,A) =θ0/1(X,A;γ)m2(X,1;α2)+{1−θ0/1(X,A;γ)}m2(X,0;α2),E(Y∣Z=0,S=1,X,A) =m1(X,A;α1). 

These models are compatible with the testable implications described in Proposition 1. Ordinary least squares and maximum likelihood estimation may be used for parameter estimation. The survivor average causal effect ΔLL can then be estimated using (1), in which μz,LL,W can be estimated using (13) and (14), πLL∣W can be estimated using the product of (15) and (16), and the integration is taken with respect to the empirical distribution of W. Using M-estimation theory one can show that the resulting estimate of ΔLL is consistent and asymptotically normally distributed.

Remark 2. An alternative popular approach to estimating causal effects is based on the propensity score e(X), defined as the probability of assignment to exposure conditioning on baseline covariates. However, although the propensity score is sufficient for summarizing the effect of X on Z in the sense that Z⫫X∣e(X), it is not sufficient for summarizing the effect of X on A. Thus, propensity score methods are not directly applicable to estimating the survivor average causal effect under our identification assumptions.

5. Simulation studies
5.1. Settings following Assumptions 1–5
We first consider simulation settings in which data were generated according to Fig. 1. The baseline covariates X=(X1,X2,X3) are a combination of discrete and continuous variables: X1 is a discrete variable taking values 1 or -1 with probability 1/2 each, and (X2,X3) follows a multivariate normal distribution N(μ,Σ) where
 μ=(1−1),Σ=(10⋅50⋅51). 

Conditional on X, the substitution variable A was generated from a Bernoulli distribution such that pr(A=1∣X)=expit(XTu), where u=(1, 1,1)T/2. The exposure variable Z was generated following a logistic model pr(Z=1∣X,A)=expit(δ1Xu+δ1A), where δ1 is a parameter taking values 0 or 1. The survival type G was generated from a multinomial distribution such that pr(G=LL∣X,A)=expit(γ0+XTγ1+Aγ2)expit(β10+XTβ11+Aβ12), pr(G=LD∣X,A)={1-expit(γ0+XTγ1+Aγ2)}expit(β10+XTβ11+Aβ12) and pr(G=DD∣X,A)=1-expit(β10+XTβ11+Aβ12), where (β10,β11,β12)=(4,δ2,δ2,δ2,2)/2, (γ0,γ1,γ2)=(0,-3δ2,δ2,δ2,2)/2 and δ2 is a parameter taking values 0 or 1. The potential outcomes Y(z) were generated from the following normal distributions: Y(1)∣G=LL,X,A∼N(5+XTu,0⋅52), Y(1)∣G=LD,X,A∼N(7+XTu,0⋅52) and Y(0)∣G=LL,X,A∼N(4+XTu,0⋅52). The observed survival S and observed outcome Y follow from these by the consistency assumption. Under our settings, the treatment assignment and outcome are confounded when δ1=1, whereas the survival and outcome processes are confounded when δ2=1. The true value for ΔLL is 1.

We compared four methods for estimating ΔLL: linear regression of Y on Z, X and A among observed survivors; the estimation method of Ding et al. (2011); the proposed method under the exclusion restriction assumption (Assumption 4), i.e., the estimation method using models 1–4; the proposed method under the no-interaction assumption (Assumption 7), i.e., the estimation method using models 3, 4 and 7. We differ from Ding et al. (2011) in both the identification conditions and the estimation method. Table 2 summarizes the results. The naive regression method is biased in all settings because of selection bias. In the presence of confounding between Z and Y or between S and Y, i.e., when δ1≠0 or δ2≠0, the estimator of Ding et al. (2011) is inconsistent. However, even in the absence of confounding between Z and Y or between S and Y, i.e., when δ1=δ2=0, the estimator of Ding et al. (2011) can be unstable, especially if the sample size is small. Although in this case the substitution relevance assumption of Ding et al. (2011) holds since pr(G=LL∣Z=1,S=1,A=1)≠pr(G=LL∣Z=1,S=1,A=0), for some simulated samples the estimates of pr(G=LL∣Z=1,S=1,A=1) can be very close to the estimates of pr(G=LL∣Z=1,S=1,A=0), leading to instability in the causal effect estimates. In contrast, the proposed estimators are more stable, and have biases that decrease with sample size in all the settings considered here.


Table 2 
Bias (×100) and standard error (×100, in parentheses) for various methods of estimating ΔLL under settings following Assumptions 1–5, in which Prop-ER and Prop-NI are expected to be consistent. Here δ1=1 corresponds to the presence of confounding between Z and Y, and δ2=1 corresponds to the presence of confounding between S and Y; results are based on 500 simulated datasets 

Exclusion restriction: true	
Sample size	
δ1
	
δ2
		Estimation method	
				Naive	DGYZ	Prop-ER	Prop-NI	
200	0	0		73 (0⋅61)	3800 (3300)	7⋅2 (7⋅7)	32 (1⋅9)	
		1		46 (0⋅67)	–1100 (1000)	10 (1⋅2)	2⋅9 (0⋅91)	
	1	0		80 (0⋅85)	160 (4⋅7)	–7⋅6 (27)	45 (2⋅4)	
		1		40 (0⋅83)	35 (8⋅4)	35 (1⋅5)	28 (1⋅2)	
1000	0	0		73 (0⋅27)	410 (7⋅0)	–4⋅3 (1⋅5)	8⋅3 (1⋅1)	
		1		48 (0⋅29)	–320 (860)	3⋅3 (0⋅56)	1⋅6 (0⋅41)	
	1	0		80 (0⋅36)	180 (1⋅6)	–8⋅3 (3⋅5)	9⋅7 (1⋅3)	
		1		41 (0⋅36)	79 (2⋅5)	11 (0⋅97)	9⋅3 (0⋅58)	
5000	0	0		73 (0⋅11)	380 (2⋅1)	–0⋅16 (0⋅58)	1⋅7 (0⋅48)	
		1		48 (0⋅13)	–1800 (810)	0⋅72 (0⋅27)	0⋅37 (0⋅21)	
	1	0		81 (0⋅17)	180 (0.65)	–1⋅1 (0⋅62)	1⋅9 (0⋅61)	
		1		41 (0⋅16)	83 (1⋅0)	2⋅6 (0⋅50)	2⋅0 (0⋅24)	
Naive, linear regression among observed survivors; DGYZ, the method of Ding et al. (2011); Prop-ER, the proposed method under the exclusion restriction assumption; Prop-NI, the proposed method under the no-interaction assumption.




5.2. Settings with violation of exclusion restriction
We now evaluate the sensitivity of the proposed method to departures from the exclusion restriction assumption, Assumption 4. We generated data in the same way as in § 5.1, except that the potential outcome Y(z) was generated from the following normal distributions: Y(1)∣G=LL,X,A∼N(5+XTu+A,0⋅52), Y(1)∣G=LD,X,A∼N(7+XTu+A,0⋅52) and Y(0)∣G=LL,X,A∼N(4+XTu+A,0⋅52). The method of Ding et al. (2011) for dealing with exclusion restriction violations is not applicable here, as it requires the substitution variable A to either be continuous or have at least three categories.

The simulation results are presented in Table 3. As expected, the proposed estimator assuming no interaction is consistent for all simulation settings considered here, whereas both the estimator of Ding et al. (2011) and the proposed estimator assuming the exclusion restriction assumption are biased for estimating ΔLL.


Table 3 
Bias (×100) and standard error (×100, in parentheses) for various methods of estimating ΔLL under settings in which the exclusion restriction assumption is violated. In these settings Prop-NI is expected to be consistent but Prop-ER is not. Here δ1=1 corresponds to the presence of confounding between Z and Y, and δ2=1 corresponds to the presence of confounding between S and Y; results are based on 500 simulated datasets 

Exclusion restriction: false	
Sample size	
δ1
	
δ2
		Estimation method	
				Naive	DGYZ	Prop-ER	Prop-NI	
200	0	0		73 (0⋅61)	5500 (4700)	160 (11)	32 (1⋅9)	
		1		46 (0⋅67)	–1700 (1500)	16 (1⋅7)	2⋅9 (0⋅91)	
	1	0		80 (0⋅85)	66 (7⋅6)	140 (13)	45 (2⋅4)	
		1		40 (0⋅83)	–140 (13)	54 (2⋅0)	28 (1⋅2)	
1000	0	0		73 (0⋅27)	580 (10)	160 (1⋅9)	8⋅3 (1⋅1)	
		1		48 (0⋅29)	–540 (1300)	8⋅1 (0⋅62)	1⋅6 (0⋅41)	
	1	0		80 (0⋅36)	94 (2⋅4)	170 (5⋅3)	9⋅7 (1⋅3)	
		1		41 (0⋅36)	–62 (3⋅8)	31 (1⋅6)	9⋅3 (0⋅58)	
5000	0	0		73 (0⋅11)	540 (3⋅1)	160 (0⋅69)	1⋅7 (0⋅48)	
		1		48 (0⋅13)	–2800 (1200)	4⋅7 (0⋅27)	0⋅37 (0⋅21)	
	1	0		81 (0⋅17)	95 (0⋅94)	160 (0⋅77)	1⋅9 (0⋅61)	
		1		41 (0⋅16)	–56 (1⋅6)	20 (0⋅47)	2⋅0 (0⋅24)	



6. Application to a Southwest Oncology Group trial
We illustrate the application of the proposed methods using data from a randomized phase III trial to compare docetaxel plus estramustine with mitoxantrone plus prednisone in men with metastatic, hormone-independent prostate cancer (Petrylak et al., 2004). The dataset we use, which was created by Ding et al. (2011), contains observations on 487 men aged 47 to 88. Of these subjects, 258 were randomly assigned to receive docetaxel plus estramustine and 229 were randomly assigned to receive mitoxantrone plus prednisone. In our analysis, we are interested in comparing these two treatments in terms of health-related quality of life one year after receiving treatment.

A naive analysis shows that among patients who survived to one year after receiving the assigned treatment, the quality of life for those assigned to the docetaxel plus estramustine group is higher by 2⋅46 units than those assigned to the mitoxantrone plus prednisone group; the 95% confidence interval is [-3⋅31, 8⋅24]. However, this estimate is not causally interpretable, as subjects who would survive if assigned to docetaxel plus estramustine are potentially different from subjects who would survive if assigned to mitoxantrone plus prednisone. Moreover, as reported by Petrylak et al. (2004), docetaxel plus estramustine is beneficial for overall survival compared to mitoxantrone plus prednisone. The direct comparison among observed survivors is therefore also subject to selection bias. Instead, we apply the method of Ding et al. (2011) and our proposed methods to deal with truncation due to death. To account for possible common causes of the survival and outcome processes, we adjust for the following variables in the proposed methods: age, race, type of prognosis, bone pain and performance status. Following Ding et al. (2011), we use the baseline quality of life as the substitution variable, and the change in quality of life over the one-year period as the outcome.

We first analyse this dataset under the monotonicity assumption. The point estimates and bootstrap standard errors are displayed in Table 4. The results in Ding et al. (2011) suggest that docetaxel plus estramustine had a significant causal effect on the quality of life among those patients who would survive one year after receiving treatment regardless of which treatment group they were assigned to. In contrast, after accounting for the baseline covariate information that might simultaneously impact the potential survival and the potential quality of life, we were not able to reach such a conclusion. Both of the proposed methods yield a point estimate that is much closer to zero, and their 95% confidence intervals cover zero. These results show that, even in the setting of a randomized trial, adjusting for baseline covariates can lead to different estimates for the survivor average causal effect; this should not be surprising since baseline variables may confound S and Y.


Table 4 
Survivor average causal effect of docetaxel plus estramustine treatment on health-related quality of life 

Estimation method	Point estimate	Bootstrapped SE	2⋅5%	50%	97⋅5%	
DGYZ	7⋅01	3⋅09	1⋅81	6⋅56	13⋅64	
Prop-ER	3⋅06	11⋅79	
-15⋅15	3⋅29	22⋅60	
Prop-NI	2⋅73	3⋅82	
-3⋅97	2⋅95	10⋅83	
DGYZ, results adapted from Ding et al. (2011); Prop-ER, results estimated using the proposed method under the exclusion restriction assumption; Prop-NI, results estimated using the proposed method under the no-interaction assumption.




The proposed estimator Prop-ER, which assumes exclusion restriction and the monotonicity condition, is very unstable. In particular, the point estimate for the model parameter γ in Model 4 is large in magnitude, so that some fitted values of θ0/1 are close to the boundary. This indicates a monotonicity violation. In fact, previous analyses also suggest that the monotonicity assumption could be problematic for this dataset (Ding et al., 2011), and as we discussed earlier, for randomized trials the monotonicity assumption is not plausible a priori. For these reasons, although the overall one-year survival rate in the docetaxel plus estramustine group, 49⋅6% is higher than that in the mitoxantrone plus prednisone group, 38⋅9%, a sensitivity analysis of the monotonicity assumption is warranted. In our analysis the sensitivity parameter is πDL, which has a one-to-one correspondence with the sensitivity parameter ρ but has the interpretation as the overall fraction of patients who would die one year after receiving docetaxel plus estramustine but would survive one year after receiving mitoxantrone plus prednisone. Under our Models 3 and 6, the range for πDL is estimated to be [0⋅01, 0⋅19], with the lower and upper limits corresponding to ρ=1 and 0, respectively. As the lower limit is greater than 0, the monotonicity assumption, Assumption 1, is not compatible with these modelling assumptions. Figure 2 summarizes the results from our sensitivity analysis. As both of the sensitivity lines cross zero, without prior knowledge of the possible values for πDL, we cannot reach any definitive answer about the causal effect of docetaxel plus estramustine versus mitoxantrone plus prednisone on the quality of life one year after receiving treatment. Furthermore, the two curves from the proposed methods agree approximately unless πDL is smaller than 0⋅05. We also note that under a different set of assumptions, Ding et al. (2011) obtained a value of πDL that is much greater than our upper bound. Under our models 3 and 6, such a value is incompatible with the stochastic monotonicity assumption (Assumption 6) and would imply a negative correlation between the potential survival under docetaxel plus estramustine and the potential survival under mitoxantrone plus prednisone.

Fig. 2. Sensitivity analysis for estimating the survivor average causal effect in the Southwest Oncology Group dataset; the solid line represents the proposed method assuming exclusion restriction, and the dashed line the proposed method assuming no interaction.

7. Discussion
In this article, we have considered the identification and estimation of the survivor average causal effect. Compared with previous works that attempted to identify the survivor average causal effect using an exogenous variable, our method adjusts for baseline covariates X, which may be common causes between any pair of treatment, survival and outcome. This role for baseline covariates is unique to our identification framework for the survivor average causal effect. In contrast to the standard estimation problem of the average causal effect, even in randomized studies, the inclusion of baseline covariates is crucial for obtaining unbiased estimates of the survivor average causal effect, since there is likely to be confounding between survival and the post-survival outcome.

In our estimation approach, instead of imposing modelling assumptions on the observed data, we use parametric models for the potential outcomes. This not only simplifies the estimation procedure but also makes it easier to ensure compatibility between our identification and modelling assumptions. We also propose alternative methods to relax the monotonicity assumption and the exclusion restriction assumption. Formal inference under our alternative assumption, Assumption 6, requires a sensitivity analysis framework that accounts for uncertainty due to both nonidentifiability and sampling variability, such as the ones based on ignorance and uncertainty regions described by Vansteelandt et al. (2006) and others. To focus on the main ideas here, we present only point estimates under Assumption 6 for fixed values of ρ.

In the current work we have considered only the binary exposure case. In practical medical studies, the exposure variable may have multiple levels. For example, the smoking variable may be coded as never smokers, past smokers and current smokers. It would therefore be interesting to generalize the proposed methods to deal with ordinal exposure status.

Supplementary Material
Supplementary Data Click here for additional data file.

 Acknowledgement
The authors thank the referees, associate editor, editor and members of the National Alzheimer’s Coordinating Center for helpful comments. The authors also thank Peng Ding, Peter Gilbert, James Robins and Eric Tchetgen Tchetgen for valuable discussions. This work was initiated when the first author was a graduate student at the University of Washington. The second author is also affiliated with Peking University, and was supported in part by the U.S. Department of Veterans Affairs. The third author was supported by the U.S. National Institutes of Health.

Supplementary material

Supplementary material available at Biometrika online includes proofs of the theorems and propositions, as well as alternative causal diagrams that are compatible with the structural equations (4) but which allow for certain dependencies between error terms.

Appendix
Parameterizations under alternative identification assumptions
To estimate ΔLL under the assumptions of Theorem 2, we assume Models 2 and 3 and the following:

Model 5. 
E{Y(0)∣Z=0,X,G,A} is known up to a finite-dimensional parameter α3; that is, E{Y(0)∣Z=0,X,G,A}=m3(X,G;α3), where G takes values in {LL,DL}, m3(⋅,⋅;α3) is a known function and α3 is an unknown parameter. Note that because of condition (i) of Theorem 2, m3(⋅,⋅;α3) does not depend on the value of A. Specifically, for the simulations and data example we code LL to be 1 and DL to be 0, and consider
 m3(X,G;α3)=α30+XTα31+Gα33; 

Model 6. 
pr{S(0)=1∣X,A} is known up to a finite-dimensional parameter β0; that is, pr{S(0)=1∣X,A}=θ0(X,A;β0), where θ0(⋅,⋅;β0) is a known function and β0 is an unknown parameter. Specifically, for the data example we consider
 θ0(X,A;β0)=expit(β00+XTβ01+Aβ02). 

Similarly, to estimate ΔLL under the assumptions of Theorem 3, we assume Models 3 and 4 and the following model:

Model 7. 
E(Y∣X,A,G,Z) is known up to a finite-dimensional parameter α4; that is, E[Y∣X,A,G,Z]=m4(X,A,G,Z;α4), where G takes values in {LL,LD}, m4(⋅,⋅,⋅,⋅;α4) is a known function and α4 is an unknown parameter. Note that by Assumption 7, m4(X,A,G,Z;α4) should not contain interaction terms within the pairs (A,Z) or (A,G). Specifically, for the simulations and data example we code LL to be 1 and LD to be 0, and consider
 m4(X,A,G,Z;α4)=α40+XTα41+Aα42+Gα43+Zα44. 

Finally, if one wishes to relax both the monotonicity assumption, Assumption 1, and the exclusion restriction, Assumption 4, one may assume Models 3 and 4 and the following model:

Model 8. 
E(Y∣X,A,G,Z) is known up to a finite-dimensional parameter α5; that is, E(Y∣X,A,G,Z)=m5(X,A,G,Z;α5), where G takes values in {LL,LD,DL}, m5(⋅,⋅,⋅,⋅;α5) is a known function and α5 is an unknown parameter. Note that by Assumption 7, m5(X,A,G,Z;α5) should not contain interaction terms within the pairs (A,Z) or (A,G). Specifically, for the data example we code LL to be 1 and DL and LD to be 0, and consider
 E(Y∣X,A,G,Z)=α50+XTα51+Aα52+ZGα53+Zα54+(1−Z)Gα55.
==== Refs
References

Angrist J. D. , Imbens G. W.  & Rubin D. B.   (1996 ). Identification of causal effects using instrumental variables. J. Am. Statist. Assoc. 91 , 444 –55 .

Chiba Y.  & VanderWeele T. J.   (2011 ). A simple method for principal strata effects when the outcome has been truncated due to death. Am. J. Epidemiol. 173 , 745 –51 .21354986 

Ding P. , Geng Z. , Yan W.  & Zhou X.-H.   (2011 ). Identifiability and estimation of causal effects by principal stratification with outcomes truncated by death. J. Am. Statist. Assoc. 106 , 1578 –91 .

Ding P.  & Vanderweele T. J.   (2014 ). Generalized Cornfield conditions for the risk difference. Biometrika 101 , 971 –7 .

Egleston B. L. , Scharfstein D. O. , Freeman E. E.  & West S. K.   (2007 ). Causal inference for non-mortality outcomes in the presence of death. Biostatistics 8 , 526 –45 .16980696 

Frangakis C. E.  & Rubin D. B.   (1999 ). Addressing complications of intention-to-treat analysis in the combined presence of all-or-none treatment-noncompliance and subsequent missing outcomes. Biometrika 86 , 365 –79 .

Frangakis C. E.  & Rubin D. B.   (2002 ). Principal stratification in causal inference. Biometrics 58 , 21 –9 .11890317 

Gilbert P. B. , Bosch R. J.  & Hudgens M. G.   (2003 ). Sensitivity analysis for the assessment of causal vaccine effects on viral load in HIV vaccine trials. Biometrics 59 , 531 –41 .14601754 

Hansen L. P.   (1982 ). Large sample properties of generalized method of moments estimators. Econometrica 50 , 1029 –54 .

Hayden D. , Pauler D. K.  & Schoenfeld D.   (2005 ). An estimator for treatment comparisons among survivors in randomized trials. Biometrics 61 , 305 –10 .15737107 

Imai K.   (2008 ). Sharp bounds on the causal effects in randomized experiments with “truncation-by-death”. Statist. Prob. Lett. 78 , 144 –9 .

Imbens G. W.   (2000 ). The role of the propensity score in estimating dose-response functions. Biometrika 87 , 706 –10 .

Imbens G. W.   (2003 ). Sensitivity to exogeneity assumptions in program evaluation. Am. Econ. Rev. 93 , 126 –32 .

Jemiai Y. , Rotnitzky A. , Shepherd B. E.  & Gilbert P. B.   (2007 ). Semiparametric estimation of treatment effects given base-line covariates on an outcome measured after a post-randomization event occurs. J. R. Statist. Soc. B 69 , 879 –901 .

Kurland B. F. , Johnson L. L. , Egleston B. L.  & Diehr P. H.   (2009 ). Longitudinal data with follow-up truncated by death: Match the analysis method to research aims. Statist. Sci. 24 , 211 –22 .

Lee K. , Daniels M. J.  & Sargent D. J.   (2010 ). Causal effects of treatments for informative missing data due to progression/death. J. Am. Statist. Assoc. 105 , 912 –29 .

Long D. M.  & Hudgens M. G.   (2013 ). Sharpening bounds on principal effects with covariates. Biometrics 69 , 812 –9 .24245800 

Pearl J.   (2009 ). Causality . Cambridge : Cambridge University Press. 

Petrylak D. P. , Tangen C. M. , Hussain M. H. A. , Lara Jr P. N. , Jones J. A. , Taplin M. E. , Burch P. A. , Berry D. , Moinpour C. , Kohli M.  
 (2004 ). Docetaxel and estramustine compared with mitoxantrone and prednisone for advanced refractory prostate cancer. New Engl. J. Med. 351 , 1513 –20 .15470214 

Robins J. M.   (1986 ). A new approach to causal inference in mortality studies with a sustained exposure period–-application to control of the healthy worker survivor effect. Math. Mod. 7 , 1393 –512 .

Robins J. M.   (2003 ). Semantics of causal DAG models and the identification of direct and indirect effects.  In Highly Structured Stochastic Systems , Green P. J. Hjort N. L.  & Richardson S.   eds. New York : Oxford University Press,  pp. 70 –81 .

Robins J. M.  & Greenland S.   (1992 ). Identifiability and exchangeability for direct and indirect effects. Epidemiology 3 , 143 –55 .1576220 

Robins J. M.  & Richardson T. S.   (2010 ). Alternative graphical causal models and the identification of directeffects.  In Causality and Psychopathology: Finding the Determinants of Disorders and Their Cures , Shrout P. Keyes K. M.  & Ornstein K.   eds. New York : Oxford University Press,  pp. 103 –58 .

Rosenbaum P. R.   (1984 ). The consequences of adjustment for a concomitant variable that has been affected by the treatment. J. R. Statist. Soc. A 147 , 656 –66 .

Rosenbaum P. R.  & Rubin D. B.   (1983 ). Assessing sensitivity to an unobserved binary covariate in an observational study with binary outcome. J. R. Statist. Soc. B 45 , 212 –8 .

Roy J. , Hogan J. W.  & Marcus B. H.   (2008 ). Principal stratification with predictors of compliance for randomized trials with 2 active treatments. Biostatistics 9 , 277 –89 .17681993 

Rubin D. B.   (1980 ). Comment. J. Am. Statist. Assoc. 75 , 591 –3 .

Rubin D. B.   (1998 ). More powerful randomization-based p-values in double-blind trials with non-compliance. Statist. Med. 17 , 371 –85 .

Rubin D. B.   (2000 ). Comment on “Causal inference without counterfactuals”. J. Am. Statist. Assoc. 95 , 435 –8 .

Rubin D. B.   (2006 ). Causal inference through potential outcomes and principal stratification: Application to studies with “censoring” due to death. Statist. Sci. 21 , 299 –309 .

Shepherd B. E. , Gilbert P. B. , Jemiai Y.  & Rotnitzky A.   (2006 ). Sensitivity analyses comparing outcomes only existing in a subset selected post-randomization, conditional on covariates, with application to HIV vaccine trials. Biometrics 62 , 332 –42 .16918897 

Sperling R. , Mormino E.  & Johnson K.   (2014 ). The evolution of preclinical Alzheimer’s disease: Implications for prevention trials. Neuron 84 , 608 –22 .25442939 

Tchetgen Tchetgen E. J.   (2014 ). Identification and estimation of survivor average causal effects. Statist. Med. 33 , 3601 –28 .

Vansteelandt S. , Goetghebeur E. , Kenward M. G.  & Molenberghs G.   (2006 ). Ignorance and uncertainty regions as inferential tools in a sensitivity analysis. Statist. Sinica 16 , 953 –79 .

Weuve J. , Tchetgen Tchetgen E. J. , Glymour M. M. , Beck T. L. , Aggarwal N. T. , Wilson R. S. , Evans D. A.  & de Leon C. F. M.   (2012 ). Accounting for bias due to selective attrition: The example of smoking and cognitive decline. Epidemiology 23 , 119 –28 .21989136 

Zhang J. L.  & Rubin D. B.   (2003 ). Estimation of causal effects via principal stratification when some outcomes are truncated by “death”. J. Educ. Behav. Statist. 28 , 353 –68 .

