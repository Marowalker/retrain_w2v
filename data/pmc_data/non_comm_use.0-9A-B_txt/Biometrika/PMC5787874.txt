
==== Front
BiometrikaBiometrikabiometBiometrika0006-34441464-3510Oxford University Press 10.1093/biomet/asx029asx029ArticlesMaximum likelihood estimation for semiparametric regression models with multivariate interval-censored data Zeng Donglin *Gao Fei *Lin D. Y. *
* 
Department of Biostatistics, CB#7420, University of North Carolina, Chapel Hill, North Carolina 27599, U.S.A.
dzeng@bios.unc.edu
fgao@live.unc.edu
lin@bios.unc.edu
9 2017 12 7 2017 01 9 2018 104 3 505 525 06 6 2016 © 2017 Biometrika Trust2017Summary
Interval-censored multivariate failure time data arise when there are multiple types of failure or there is clustering of study subjects and each failure time is known only to lie in a certain interval. We investigate the effects of possibly time-dependent covariates on multivariate failure times by considering a broad class of semiparametric transformation models with random effects, and we study nonparametric maximum likelihood estimation under general interval-censoring schemes. We show that the proposed estimators for the finite-dimensional parameters are consistent and asymptotically normal, with a limiting covariance matrix that attains the semiparametric efficiency bound and can be consistently estimated through profile likelihood. In addition, we develop an EM algorithm that converges stably for arbitrary datasets. Finally, we assess the performance of the proposed methods in extensive simulation studies and illustrate their application using data derived from the Atherosclerosis Risk in Communities Study.

Current-status dataEM algorithmMultivariate failure time dataNonparametric likelihoodProfile likelihoodProportional hazardsProportional oddsRandom effectsNational Institutes of Health10.13039/100000002National Heart, Lung, and Blood Institute10.13039/100000050
==== Body
1. Introduction
Multivariate failure time data arise when each study subject may experience multiple events or when study subjects are sampled in clusters such that the failure times are potentially correlated (Kalbfleisch & Prentice, 2002, Ch. 10). The failure times are interval-censored if the events or failures can only be determined through periodic examination. In the special case of one examination per subject, the observations are called current-status data (Huang, 1996). An example of interval-censored multiple-event data is an HIV/AIDS study where laboratory tests were performed periodically on each patient to detect the presence of cytomegalovirus in the blood and urine (Goggins & Finkelstein, 2000). An example of interval-censored clustered data is a study of pandemic H1N1 influenza where blood samples of family members were collected at different time-points to determine whether there is infection with the influenza virus (Kor et al., 2013). Such data allow characterization of the dependence of related events and evaluation of the effects of covariates on the multivariate outcome. The fact that failure times are never exactly observed, together with their dependence, makes the analysis theoretically and computationally challenging.

Several methods for regression analysis of interval-censored multiple-event data have been proposed. Specifically, Goggins & Finkelstein (2000), Kim & Xue (2002), Chen et al. (2007), Tong et al. (2008) and Chen et al. (2013) constructed estimating equations for marginal models by assuming that all subjects are examined at a common set of time-points. Chen et al. (2009) and Chen et al. (2014) considered a frailty proportional hazards model for current-status data and interval-censored data, respectively. The former assumed a piecewise-constant baseline hazard function, while the latter assumed a common set of examination times for all subjects. All the aforementioned work avoids the difficult task of nonparametric estimation by parameterizing the failure time distribution or estimating the survival probabilities at fixed time-points. Wang et al. (2008) studied sieve estimation of a copula proportional hazards model for bivariate current-status data with univariate examination time, which was parameterized by a proportional hazards model. Wen & Chen (2013) established asymptotic theory for the nonparametric maximum likelihood estimation of a gamma-frailty proportional hazards model for bivariate interval-censored data and constructed a self-consistency equation, which involves an artificial tuning constant and may have multiple solutions. Wang et al. (2015) developed an EM algorithm for spline-based sieve estimation of the same model, but for bivariate current-status data.

The literature on interval-censored clustered data is relatively limited. Cook & Tolusso (2009) and Kor et al. (2013) constructed estimating functions for a copula proportional hazards model with a piecewise-constant baseline hazard function for current-status and interval-censored data, respectively. Chang et al. (2007) established a profile likelihood theory for a gamma-frailty proportional hazards model with current-status family data, and Wen & Chen (2011) developed a self-consistency algorithm similar to that in Wen & Chen (2013).

In this paper, we provide efficient estimation methods for a broad class of semiparametric transformation models with random effects for general interval-censored multivariate failure time data. Our work advances the study of multivariate interval-censored data in several directions. First, we deal with the most general form of interval censoring, allowing each subject to have an arbitrary sequence of examination times, and we do not model the examination times. Second, our models accommodate time-dependent covariates and include both proportional and non-proportional hazards structures. Third, our models allow multiple random effects and treat multiple events and clustered data in a unified framework. Fourth, we estimate the failure time distribution in a completely nonparametric manner and avoid any tuning parameters, which are required by sieve methods. Fifth, we establish a rigorous asymptotic theory for the nonparametric maximum likelihood estimators under mild conditions. Finally, we devise an EM algorithm that involves only low-dimensional parameters in each iteration and performs well in a wide variety of situations.

The present paper also substantially extends our recent work on univariate interval-censored data (Zeng et al., 2016). We expand our previous numerical algorithm to handle unobserved random effects and multiple baseline hazard functions. We address new theoretical challenges generated by the presence of random effects, especially in proving the Donsker property of relevant functions in the form of integration over random effects. In addition, the asymptotic theory of Zeng et al. (2016) hinges on the assumption that a subset of study subjects is examined at the study endpoint; here we remove that restrictive assumption and formulate new arguments to prove the consistency of the estimators. Finally, we show that the covariance matrix for the finite-dimensional parameters can be estimated consistently by the inverse empirical covariance matrix of the individual contributions to the gradient of the profile loglikelihood function. This estimator is always positive semidefinite and is numerically more stable than the Hessian matrix used by Zeng et al. (2016) and others.

2. Data, model and likelihood
We consider a general framework for modelling multivariate failure time data that encompasses both multiple events and clustered data. Suppose that there are n independent clusters with Ji subjects in the ith cluster and that each subject can potentially experience K types of events. It is assumed that Ji is small relative to n. For i=1,…,n, j=1,…,Ji and k=1,…,K, let Tijk denote the kth failure time for the jth subject of the ith cluster, and let Xijk(⋅) denote the corresponding p-vector of possibly time-dependent covariates. We specify that the cumulative hazard function of Tijk takes the form
 (1) Λijk(t)=Gk[∫0texp⁡{βTXijk(s)+biTZijk(s)}dΛk(s)], 
where Zijk contains 1 and covariates that may be part of Xijk, bi is a di-vector of random effects from the multivariate normal distribution with mean zero and covariance matrix Σi(γ) indexed by unknown parameters γ, β is a set of unknown regression parameters, Λk(⋅) is an arbitrary increasing function with Λk(0)=0, and Gk(x) is a specific transformation function. It is assumed that Tijk(j=1,…,Ji;k=1,…,K) are independent conditional on bi. By letting Xijk and Zijk depend on k, model (1) allows the regression parameters and random effects to be different among the K types of events; see Lin (1994). In addition, the dependence of Zijk on j allows for subject-specific random effects. Often Σi(γ) does not depend on i, and then γ consists of the upper diagonal elements of the common covariance matrix Σ. An example in which Σi(γ) depends on i is given in the Supplementary Material.

A variety of transformations can be generated through the log-Laplace transform
 (2) Gk(x)=−log⁡∫0∞exp⁡(−xt)fk(t)dt, 
where fk(t) is a density function with support on [0,∞). The choice of the gamma density with mean 1 and variance rk for fk(t) yields the class of logarithmic transformations Gk(x)=rk-1log(1+rkx) with rk>0 (Chen et al., 2002), which includes the proportional odds model, rk=1, and can be extended to include the proportional hazards model by letting rk=0.

Suppose that Tijk is monitored at a sequence of positive time-points Uijk1<⋯<Uijk,Mijk. We assume that {Uijkl:l=1,…,Mijk;j=1,…,Ji;k=1,…,K} are independent of {Tijk:j=1,…,Ji;k=1,…,K} and bi conditional on {Xijk(⋅):j=1,…,Ji;k=1,…,K}. Let (Lijk,Rijk] be the shortest time interval that brackets Tijk, i.e., Lijk=max{Uijkl:Uijkl<Tijk,l=0,…,Mijk} and Rijk=min{Uijkl:Uijkl≥Tijk,l=1,…,Mijk+1}, where Uijk0=0 and Uijk,Mijk+1=∞. Then the likelihood concerning the parameters θ=(βT,γT)T and A=(Λ1,…,ΛK) is
 (3) Ln(θ,A) =∏i=1n∫∏j=1Ji∏k=1K{exp(−Gk[∫0Lijkexp⁡{βTXijk(s)+biTZijk(s)}dΛk(s)]) −exp(−Gk[∫0Rijkexp⁡{βTXijk(s)+biTZijk(s)}dΛk(s)])} ×(2π)−di/2|Σi(γ)|−1/2exp⁡{−biTΣi(γ)−1bi2}dbi, 
in which exp⁡(−Gk[∫0Rijkexp⁡{βTXijk(s)+biTZijk(s)}dΛk(s)])=0 if Rijk=∞.

3. Nonparametric maximum likelihood estimation
We adopt the nonparametric maximum likelihood estimation approach. For each k=1,…,K, let 0=tk0<tk1<…<tkmk<∞ be the ordered sequence of all Lijk and Rijk with Rijk<∞. The estimator for Λk is a step function which jumps only at those time-points with respective jump sizes of λk0=0,λk1,…,λkmk. We introduce a latent variable ξijk with density fk(t) as given in (2). Then (3) can be written as
 (4) Ln(θ,A) =∏i=1n∫∏j=1Ji∏k=1K∫[exp⁡{−ξijk∑tkq≤Lijkexp⁡(βTXijkq+biTZijkq)λkq}  −I(Rijk<∞)exp⁡{−ξijk∑tkq≤Rijkexp⁡(βTXijkq+biTZijkq)λkq}]fk(ξijk)dξijk ×(2π)−di/2|Σi(γ)|−1/2exp⁡{−biTΣi(γ)−1bi2}dbi, 
where Xijkq=Xijk(tkq) and Zijkq=Zijk(tkq).

To make the maximization of the likelihood more tractable, we introduce independent Poisson random variables Wijkq(q=1,…,mk) with means λkqξijkexp(βTXijkq+biTZijkq). Let Aijk=∑tkq≤LijkWijkq and Bijk=I(Rijk<∞)∑Lijk<tkq≤RijkWijkq. Because the joint probability of Aijk=0 and Bijk>0 given ξijk and bi is exp⁡{−ξijk∑tkq≤Lijkexp⁡(βTXijkq+biTZijkq)λkq}−I(Rijk<∞)exp⁡{−ξijk∑tkq≤Rijkexp⁡(βTXijkq+biTZijkq)λkq}, the likelihood arising from the observations (Aijk=0,Bijk>0:i=1,…,n;j=1,…,Ji;k=1,…,K) is the same as (4). Therefore, we develop an EM algorithm to maximize (4) by treating Wijkq(tkq≤Rijk*), ξijk and bi as complete data, where Rijk*=LijkI(Rijk=∞)+RijkI(Rijk<∞).

Remark 1. Conditional on ξijk and bi, the failure time Tijk follows a proportional hazards model. Let Nijk(t) be a Poisson process with value 0 at t=0 and intensity function the same as the hazard function of Tijk. Clearly, Tijk is the first time Nijk(t) jumps from 0 to 1, such that Tijk falling in the interval (Lijk,Rijk] is equivalent to Nijk(t) taking no jump before Lijk but at least one jump in (Lijk,Rijk]. Thus, Aijk and Bijk are indeed the counts of Nijk(t) before Lijk and between Lijk and Rijk, respectively.

The complete-data loglikelihood is
 (5)  ∑i=1n{∑j=1Ji∑k=1K(∑q=1mkI(tkq≤Rijk∗)[Wijkqlog⁡{λkqξijkexp⁡(βTXijkq+biTZijkq)}   ∑j=1Ji−λkqξijkexp⁡(βTXijkq+biTZijkq)−log⁡(Wijkq!)]+log⁡fk(ξijk)) ∑j=1Ji−di2log⁡(2π)−12log⁡|Σi(γ)|−biTΣi(γ)−1bi2}. 

In the M-step, we solve the following equation for β using the one-step Newton–Raphson method:
  ∑i=1n∑j=1Ji∑k=1K∑q=1mkI(tkq≤Rijk∗)E^(Wijkq)  ×[Xijkq−∑i′=1n∑j′=1Ji′I(tkq≤Ri′j′k∗)Xi′j′kqE^{ξi′j′kexp⁡(βTXi′j′kq+bi′TZi′j′kq)}∑i′=1n∑j′=1Ji′I(tkq≤Ri′j′k∗)E^{ξi′j′kexp⁡(βTXi′j′kq+bi′TZi′j′kq)}]=0, 
where E^(⋅) denotes the conditional expectation given the observed data. We then calculate
 λkq=∑i=1n∑j=1JiI(tkq≤Rijk∗)E^(Wijkq)∑i=1n∑j=1JiI(tkq≤Rijk∗)E^{ξijkexp⁡(βTXijkq+biTZijkq)} 
for q=1,…,mk and k=1,…,K, and maximize -​log|Σi(γ)|-E^{biTΣi-1(γ)bi} to estimate γ. If the Σi are the same and nonparametric, then the latter becomes Σ=n−1∑i=1nE^(bi⊗2), where a⊗2=aaT.

In the E-step, we evaluate the conditional expectations involved in the M-step. We use the fact that the joint density of ξijk(j=1,…,Ji;k=1,…,K) and bi given the observed data is proportional to
 ∏j=1Ji∏k=1K[exp⁡{−ξijk∑tkq≤Lijkexp⁡(βTXijkq+biTZijkq)λkq}    −I(Rijk<∞)exp⁡{−ξijk∑tkq≤Rijkexp⁡(βTXijkq+biTZijkq)λkq}]  ×fk(ξijk)(2π)−di/2|Σi(γ)|−1/2exp⁡{−biTΣi(γ)−1bi2}. 

In addition, the conditional mean of Wijkq for tkq≤Rijk* given ξijk(j=1,…,Ji;k=1,…,K), bi and the observed data is
 I(Lijk<tkq≤Rijk<∞)λkqξijkexp⁡(βTXijkq+biTZijkq)1−exp⁡{−∑Lijk<tkq′≤Rijkλkq′ξijkexp⁡(βTXijkq′+biTZijkq′)}. 

We use Gaussian quadrature to approximate integrals over ξijk and bi.

Starting with β=0, λkq=1/mk and Σi as the identity matrix, we iterate between the E-step and the M-step until convergence to obtain the nonparametric maximum likelihood estimators β^, γ^ and Λ^ k(k=1,…,K). The high-dimensional parameters λkq are calculated explicitly in the M-step. We show in the Supplementary Material that each iteration of the algorithm guarantees an increase in the likelihood. Due to the presence of random effects, the conditional expectations in this EM algorithm are more tedious to evaluate than those in Zeng et al. (2016).

4. Asymptotic properties
Let θ^=(β^ T,γ^ T)T and A^=(Λ^ 1,…,Λ^ K). We establish the asymptotic properties of (θ^,A^) under the following regularity conditions, wherein we omit the subscript i when referring to a random variable for a cluster and use the notation Qjk(t,b;β,Λk)=exp⁡(−Gk[∫0texp⁡{βTXjk(s)+bTZjk(s)}dΛk(s)]) and ϕ(b;Σ)=(2π)-d/2|Σ|-1/2exp(-bTΣ-1b/2).

Condition 1. The true value of θ, denoted by θ0=(β0T,γ0T)T, lies in the interior of a known compact set Θ={(βT,γT)T:β∈B,γ∈C}, where B is a compact set in ℝp and C is a compact set in the domain of γ such that Σ(γ) is a positive-definite matrix with eigenvalues bounded away from zero and ∞. The true value of Λk, denoted by Λ0k, is continuously differentiable with positive derivatives in [0,τk], which is the union of the supports of Ujkl(l=1,…,Mjk;j=1,…,J).

Condition 2. With probability one, Xjk(⋅) has bounded total variation in [0,τk]. If there exists a deterministic function a1(t) and a constant vector a2 such that a1(t)+a2TXjk(t)=0 with probability 1, then a1(t)=0 for t∈[0,τk] and a2=0.

Condition 3. With probability one, Zjk(⋅) has bounded total variation in [0,τk].

Condition 4. The cluster size J is bounded by a positive constant and is independent of {Tjk:j=1,…,J;k=1,…,K}, {Ujkl:l=1,…,Mjk;j=1,…,J;k=1,…,K} and b conditional on (Xjk,Zjk)(j=1,…,J;k=1,…,K).

Condition 5. For any j=1,…,J and k=1,…,K, the number of examination times Mjk is positive with E(Mjk)<∞. The conditional densities of (Ujkl,Ujk,l+1) given (J,Mjk,Xjk), denoted by gjkl(u,v)(l=0,…,Mjk), have continuous second-order partial derivatives with respect to u and v when v-u≥η for some positive constant η, and are continuously differentiable functionals with respect to Xjk and Zjk. In addition, pr{min0≤l<Mjk(Ujk,l+1−Ujkl)≥η∣J,Mjk,Xjk}=1.

Condition 6. The transformation function Gk is twice continuously differentiable on [0,∞) with Gk(0)=0, Gk′(x)>0 and Gk(∞)=∞ for k=1,…,K, where Gk′(x)=dGk(x)/dx. In addition, Gk′(x)exp{-Gk(x)} is uniformly bounded in x≥0 and there exists a positive constant rk0 such that exp{-Gk(x)}=O(x-1/rk0) as x→∞.

Condition 7. For a pair of parameters (θ1,A1) and (θ2,A2), if
  ∫{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β1,Λ1k′)}ϕ{b;Σ(γ1)}db =∫{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β2,Λ2k′)}ϕ{b;Σ(γ2)}db 
with probability 1 for any j∈{1,…,J}, k∈{1,…,K} and tj′k′∈[0,τk′] with j′∈{1,…,j} and k′∈{1,…,k}, then β1=β2, γ1=γ2 and Λ1k(t)=Λ2k(t) for t∈[0,τk] and k∈{1,…,K}.

Condition 8. If there exists a vector v and functions ajk(t;b)(j=1,…,J;k=1,…,K) such that
 ∫{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β0,Λ0k′)}{∑j′=1j∑k′=1kaj′k′(tj′k′,b)+vTϕγ′(b;Σ0)ϕ(b;Σ0)}ϕ(b;Σ0)db=0 
with probability one for any j∈{1,…,J}, k∈{1,…,K} and tj′k′∈[0,τk′] with j′∈{1,…,j} and k′∈{1,…,k}, where Σ0=Σ(γ0) and ϕ′γ is the derivative of ϕ{b;Σ(γ)}) with respect to γ, then v=0 and ajk(t,b)=0 for j=1,…,J, t∈[0,τk] and k∈{1,…,K}.

Remark 2. Conditions 1–4 are standard conditions for multivariate failure time regression. Condition 5 requires that two adjacent examination times be separated by at least η; otherwise, the data may contain exact observations, which need a different treatment. This condition also requires smoothness of the joint density of the examination times. Unlike Zeng et al. (2016), we do not require a subset of study subjects to be examined at the end of the study. Condition 6 holds for both the logarithmic family Gr(x)=r-1log(1+rx)(r≥0) and the Box–Cox family Gρ(x)=ρ-1{(1+x)ρ-1}(ρ≥0), where Gr(x)=x if r=0 and Gρ(x)=log(1+x) if ρ=0. Condition 7 pertains to parameter identifiability, and Condition 8 says that the Fisher information along any submodel at the true parameter values should be nonsingular. If Xjk and Zjk are time-independent and Gk(x)=x, then the equations in Conditions 7 and 8 become
  ∫{∏j′=1j∏k′=1kexp⁡(β~1T[1,Xj′k′T]T+bTZj′k′)}ϕ{b;Σ(γ1)}db =∫{∏j′=1j∏k′=1kexp⁡(β~2T[1,Xj′k′T]T+bTZj′k′)}ϕ{b;Σ(γ2)}db, ∫{∏j′=1j∏k′=1kexp⁡(β0TXj′k′+bTZj′k′)}  ×{∑j′=1j∑k′=1kv1T[1,Xj′k′T]T+v2Tϕγ′(b;Σ0)ϕ(b;Σ0)}ϕ(b;Σ0)db=0, 
respectively. It can be shown that the above equations hold if Zjk is linearly independent; that is, any symmetric matrix C satisfying ZjkTCZjk=0 with probability one must be a zero matrix.

We state the strong consistency and weak convergence of the nonparametric maximum likelihood estimators in Theorems 1 and 2, respectively.

Theorem 1. 
Under Conditions 1–7, ‖θ^−θ0‖+∑k=1Ksupt∈[0,τk]|Λ^k(t)−Λ0k(t)|→0 almost surely, where ‖⋅‖ is the Euclidean norm. 

Theorem 2. 
Under Conditions 1–8, n1/2(θ^-θ0) converges in distribution to a zero-mean multivariate normal vector whose covariance matrix attains the semiparametric efficiency bound. 

Remark 3. The proofs of the theorems are given in the Appendix. In the proof of Theorem 1, a major challenge is to show uniform boundedness of Λ^ k without assuming that there is a positive probability of Rjk=τk. To address this challenge, we first obtain a sequence of Λ^ k that converges for any interior compact sets of [0,τk). We then show that the limit of the sequence is the true parameter value by deriving the covering number for the loglikelihood function. In the proof of Theorem 2, we use the bounded inverse theorem to establish the convergence rates of the Λ^ k in terms of n and the Euclidean distance of the other parameter estimators, and we show that the rates obtained are sufficient for the asymptotic normality and efficiency of the estimators.

Let pln(θ)=maxAlog⁡Ln(θ,A), which is obtained by using the above EM algorithm but updating only (Λ1,…,ΛK) in the M-step. One may estimate the covariance matrix of θ^ by the negative inverse of the Hessian matrix of pln(θ) at θ^, which is determined by the numerical differences of second order and a perturbation constant of the order of n-1/2 (Murphy & van der Vaart, 2000; Zeng et al., 2016). The estimated matrix may be negative definite, especially in small samples. We propose to estimate the covariance matrix of θ^ by (nV^ n)-1 with
 V^n=n−1∑i=1n[{ ∂∂θli(θ,A^θ)|θ=θ^}⊗2], 
where A^θ=arg⁡maxAlog⁡Ln(θ,A) for θ∈Θ and li(θ,A) is the loglikelihood function for the ith cluster. Thus, we estimate the information matrix for θ0 by the empirical covariance matrix of the gradient of li(θ,A^θ). We approximate this gradient by a first-order numerical difference, which is quicker to calculate than its second-order counterpart. The resulting covariance matrix estimator is guaranteed to be positive semidefinite and turns out to be more robust with respect to choice of the perturbation constant than the estimator based on the second-order numerical difference. The consistency of this covariance estimator is stated in the following theorem.

Theorem 3. 
Under Conditions 1–8, V^ n-1 is a consistent estimator for the limiting covariance matrix of n1/2(θ^-θ0). 

5. Simulation studies
To evaluate the performance of the proposed methods, we conducted two series of simulation studies. The first series pertained to clustered data, the cluster sizes being 1, 2 and 3 with probabilities 0⋅2, 0⋅7 and 0⋅1, respectively. We considered model (1) with K=1 and Λ(t)=log(1+0⋅5t). We generated two independent cluster-level covariates, the first being Ber(0⋅5) and the second Un(0, 1). We set the corresponding regression parameters β1 and β2 to 0⋅5 and -0⋅5, respectively. We adopted the class of logarithmic transformations indexed by parameter r and obtained the random effect b from N(0,σ2) where σ2=0⋅5. We generated five potential examination times for each subject, with the first being Un(0, 1) and the gap between any two successive examination times being 0⋅1+Un(0, 1). We assumed that the study ended at time 5, beyond which no examinations occurred. We simulated 10 000 replicates.


Table 1 summarizes the results on the estimation of β=(β1,β2)T and σ2 for various values of n and r, and Fig. 1 displays the corresponding results for the estimation of Λ(t). The biases for all parameter estimators are small and decrease as n increases. The variance estimator for β^ is accurate, and the variance of σ^ 2 tends to be overestimated. The confidence intervals for both β and σ2 have proper coverage probabilities. Additional studies revealed that the variance estimator for σ^ 2 and the confidence intervals for σ2 become more accurate as σ2 increases.


Table 1. 
Parameter estimation results for simulation studies with clustered data 

			
n=100
		
n=200
		
n=400
	

r
			Bias	SE	SEE	CP		Bias	SE	SEE	CP		Bias	SE	SEE	CP	

0
	
β1=0⋅5
		0⋅014	0⋅263	0⋅258	94		0⋅005	0⋅182	0⋅180	95		0⋅002	0⋅127	0⋅126	95	
	
β2=-0⋅5
		
-0⋅008	0⋅404	0⋅399	95		
-0⋅005	0⋅278	0⋅277	95		
-0⋅003	0⋅194	0⋅194	95	
	
σ2=0⋅5
		
-0⋅024	0⋅369	0⋅384	96		
-0⋅009	0⋅244	0⋅259	97		
-0⋅001	0⋅166	0⋅177	97	
	

0⋅5
	
β1=0⋅5
		0⋅014	0⋅302	0⋅299	95		0⋅004	0⋅210	0⋅208	95		0⋅002	0⋅147	0⋅146	95	
	
β2=-0⋅5
		
-0⋅010	0⋅483	0⋅479	95		
-0⋅007	0⋅333	0⋅331	95		
-0⋅004	0⋅233	0⋅232	95	
	
σ2=0⋅5
		
-0⋅027	0⋅457	0⋅486	96		
-0⋅010	0⋅309	0⋅330	96		0⋅001	0⋅214	0⋅228	96	
	

1
	
β1=0⋅5
		0⋅015	0⋅341	0⋅341	95		0⋅004	0⋅237	0⋅235	95		0⋅002	0⋅166	0⋅165	95	
	
β2=-0⋅5
		
-0⋅012	0⋅558	0⋅552	95		
-0⋅008	0⋅382	0⋅381	95		
-0⋅005	0⋅268	0⋅266	95	
	
σ2=0⋅5
		
-0⋅036	0⋅558	0⋅607	95		
-0⋅018	0⋅380	0⋅412	95		
-0⋅001	0⋅265	0⋅286	95	
SE, empirical standard error; SEE, mean standard error estimator; CP, empirical coverage percentage of 95% confidence interval. For σ2, Bias and SEE are based on the median instead of the mean, and the confidence interval is based on the log transformation. Each entry is based on 10 000 replicates.




Fig. 1. Estimation of Λ(t) for clustered data: the solid and dashed curves show the true values and averaged estimates, respectively, where each estimate is based on 10 000 replicates.

The second series of studies was concerned with multiple events. We considered model (1) with K=2, J=1, Λ1(t)=log(1+0⋅5t) and Λ2(t)=0⋅5t. We focused on the logarithmic families indexed by r1 and r2. For each subject, we generated covariates and random effects from the same distributions as in the first series of studies. We set the regression parameters for the first event, (β11,β12), to (0⋅5,-0⋅5) and those of the second event, (β21,β22), to (0⋅4, 0⋅2). We generated examination times for each subject in the same manner as in the first series of studies. The results for the second series of studies are presented in the Supplementary Material. The basic conclusions are the same as those from the first series.

The variance estimation was based on the first-order numerical differentiation with a perturbation constant of 5n-1/2. The results are quite stable for perturbation constants between n-1/2 and 10n-1/2. We also evaluated variance estimation based on the second-order numerical differentiation and found that the resulting variance estimates may be negative when n is small and the perturbation constant is far away from 5n-1/2. The two variance estimation methods produced similar estimates in most cases. We recommend using 5n-1/2 for both the first-order and the second-order numerical differences.

6. An example
The Atherosclerosis Risk in Communities Study recruited a cohort of 14 751 Caucasian and African-American individuals from four U.S. communities: Forsyth County, North Carolina; Jackson, Mississippi; suburbs of Minneapolis, Minnesota; and Washington County, Maryland (The ARIC Investigators, 1989). The participants underwent a baseline examination in 1987–1989, three follow-up examinations at approximately three-year intervals, and a further examination in 2011–2013. One important objective of the study was to investigate risk factors for diabetes and hypertension. The definition of diabetes was a fasting glucose level of 126 mg/dL or above, a nonfasting glucose level of 200 mg/dL or above, self-reported physician diagnosis of diabetes, or use of diabetic medication. The definition of hypertension was systolic blood pressure of 140 mmHg or higher, diastolic blood pressure of 90 mmHg or higher, or use of antihypertensive medication. Both events were determined at the examination times and thus interval-censored.

We related the incidence of diabetes and hypertension to race, gender, communities and five baseline risk factors: age, body mass index, glucose level, systolic blood pressure and diastolic blood pressure. We excluded 5890 individuals with prevalent diabetes or hypertension and 124 individuals with unknown status at baseline. After removing another two individuals with missing values of baseline risk factors, we were left with a total of 8735 individuals. We fitted model (1) with K=2, J=1 and b∼N(0,σ2).

The loglikelihood is maximized at r1=2.1 and r2=1.3, which is the combination that would be selected by the Akaike information criterion. The loglikelihood values are -12492⋅67, -12412⋅67 and -12403⋅46 at (r1,r2)=(0, 0), (1, 1) and (2⋅1, 1⋅3), respectively.


Table 2 shows regression analysis results for the aforementioned three combinations of r1 and r2. The p-values are similar. The results indicate that African-Americans are more likely to develop diabetes and hypertension than Caucasians; baseline body mass index is positively associated with the risk of both diabetes and hypertension; and baseline glucose level is positively associated with the risk of diabetes but not hypertension. Not surprisingly, baseline systolic and diastolic blood pressures are positively associated with the risk of hypertension. Because n is large, some of the p-values are extremely small.


Table 2. 
Regression analysis results for the Atherosclerosis Risk in Communities Study 

			Diabetes			Hypertension	

(r1,r2)
	Risk factor		Estimate	Std error	
p-value		Estimate	Std error	
p-value	

(0, 0)
	Jackson		
-0⋅188	0⋅194	0⋅332		
-0⋅251	0⋅139	0⋅070	
	Minneapolis suburbs		
-0⋅436	0⋅085	
<10-4
		
-0⋅129	0⋅054	0⋅018	
	Washington County		0⋅131	0⋅081	0⋅106		0⋅094	0⋅055	0⋅087	
	Age		
-0⋅015	0⋅006	0⋅011		0⋅016	0⋅004	
<10-4
	
	Male		
-0⋅082	0⋅060	0⋅172		
-0⋅268	0⋅041	
<10-4
	
	Caucasian		
-0⋅563	0⋅192	0⋅003		
-0⋅569	0⋅138	
<10-4
	
	Body mass index (kg/m 2)		0⋅088	0⋅006	
<10-4
		0⋅021	0⋅004	
<10-4
	
	Derived glucose value (mg/dl)		0⋅108	0⋅003	
<10-4
		0⋅0003	0⋅002	0⋅914	
	Systolic blood pressure (mmHg)		0⋅006	0⋅003	0⋅070		0⋅072	0⋅003	
<10-4
	
	Diastolic blood pressure (mmHg)		0⋅005	0⋅005	0⋅271		0⋅014	0⋅003	
<10-4
	

(1, 1)
	Jackson		
-0⋅189	0⋅240	0⋅432		
-0⋅311	0⋅163	0⋅056	
	Minneapolis suburbs		
-0⋅526	0⋅101	
<10-4
		
-0⋅164	0⋅070	0⋅019	
	Washington County		0⋅149	0⋅097	0⋅123		0⋅113	0⋅072	0⋅114	
	Age		
-0⋅016	0⋅007	0⋅025		0⋅022	0⋅005	
<10-4
	
	Male		
-0⋅099	0⋅072	0⋅170		
-0⋅303	0⋅053	
<10-4
	
	Caucasian		
-0⋅722	0⋅237	0⋅002		
-0⋅773	0⋅163	
<10-4
	
	Body mass index (kg/m 2)		0⋅108	0⋅008	
<10-4
		0⋅030	0⋅006	
<10-4
	
	Derived glucose value (mg/dl)		0⋅130	0⋅004	
<10-4
		
-0⋅0004	0⋅003	0⋅906	
	Systolic blood pressure (mmHg)		0⋅008	0⋅004	0⋅053		0⋅093	0⋅003	
<10-4
	
	Diastolic blood pressure (mmHg)		0⋅005	0⋅006	0⋅351		0⋅020	0⋅004	
<10-4
	

(2⋅1, 1⋅3)
	Jackson		
-0⋅201	0⋅277	0⋅467		
-0⋅337	0⋅166	0⋅043	
	Minneapolis suburbs		
-0⋅607	0⋅116	
<10-4
		
-0⋅174	0⋅075	0⋅021	
	Washington County		0⋅161	0⋅112	0⋅150		0⋅119	0⋅077	0⋅126	
	Age		
-0⋅016	0⋅008	0⋅044		0⋅024	0⋅005	
<10-4
	
	Male		
-0⋅114	0⋅084	0⋅178		
-0⋅312	0⋅057	
<10-4
	
	Caucasian		
-0⋅875	0⋅271	0⋅001		
-0⋅844	0⋅168	
<10-4
	
	Body mass index (kg/m 2)		0⋅127	0⋅010	
<10-4
		0⋅033	0⋅006	
<10-4
	
	Derived glucose value (mg/dl)		0⋅150	0⋅005	
<10-4
		
-0⋅0006	0⋅003	0⋅864	
	Systolic blood pressure (mmHg)		0⋅010	0⋅005	0⋅036		0⋅101	0⋅004	
<10-4
	
	Diastolic blood pressure (mmHg)		0⋅004	0⋅007	0⋅496		0⋅022	0⋅004	
<10-4
	



The regression parameters have different interpretations under different transformation models. Under the proportional odds model, the regression parameters pertain to the log hazard ratios at baseline, and the hazard ratios decrease over time. Therefore, estimates of the regression parameters tend to have larger magnitudes under the proportional odds model than under the proportional hazards model. The variance component σ2 was estimated at 0⋅591, 0⋅646 and 0⋅758 under the proportional hazards, proportional odds and selected models, respectively, and the corresponding standard error estimates were 0⋅057, 0⋅087 and 0⋅111. Thus, there is strong evidence for dependence of diabetes and hypertension.


Figure 2 shows the prediction of development of diabetes and hypertension for a Caucasian female and an African-American female with all other risk factors equal. The risk of both diseases is considerably higher for the African-American individual than the Caucasian individual. The three models yield appreciably different estimates of disease-free probabilities.

Fig. 2. Estimation of disease-free probabilities for an African-American female and a Caucasian female residing in Forsyth County, North Carolina, of age 53 years, with a body mass index of 30 kg/m 2, glucose level of 97 mg/dl, systolic blood pressure of 125 mmHg and diastolic blood pressure of 70 mmHg: (a) diabetes; (b) hypertension. In each panel the upper solid, dashed and dotted curves represent the Caucasian individual under the proportional hazards, proportional odds and selected models, respectively; the lower solid, dashed and dotted curves pertain to the African-American individual under the proportional hazards, proportional odds and selected models, respectively.

7. Remarks
The proposed EM algorithm, which is used for both parameter estimation and variance estimation, performs remarkably well in practical settings, as demonstrated by the simulation studies and real-data example. We have not encountered nonconvergence with any simulated or empirical datasets. The computing time depends on the number of subjects, the number of distinct interval endpoints and the number of covariates, as well as on the convergence criterion. For the results presented in this paper, the convergence criterion was that the maximal relative change in the parameter estimates at two successive iterations should be less than 0⋅0005. With this criterion, it took less than half a second to analyse one simulated dataset with n=200. It took about 10 hours to analyse the Atherosclerosis Risk in Communities Study data, which involves 8765 subjects with 10 covariates and 2240 or 2303 distinct interval endpoints for diabetes or hypertension, respectively; the computing time was shortened to about one hour when the distinct values were reduced to 133 for diabetes and 138 for hypertension by rounding the examination times to the nearest month. The software implementing the proposed methods is available at http://dlin.web.unc.edu/software.

We have assumed that the support of the examination times for the kth type of event is an interval [0,τk]. We can relax this assumption to let the support consist of intervals or a finite number of discrete time-points. The asymptotic results continue to hold, although the consistency for Λ^ k in Theorem 1 should be stated to hold in the support of the examination times. In the proofs, the integration over [0,τk] should be changed to integration over the support.

The framework presented in this paper can be extended to other types of multivariate data. In particular, model (1) can be extended to panel count data (Zhang, 2002) by treating Λ as the intensity function of a counting process rather than the hazard function of a failure time. In addition, model (1) can be combined with a generalized linear mixed model that shares the random effects to jointly model longitudinal and survival data (Henderson et al., 2000; Zeng & Lin, 2007). There are new theoretical and computational challenges in estimating such multivariate models with interval-censored data.

Supplementary Material
Supplementary Data Click here for additional data file.

 Acknowledgement
This work was supported by the U.S. National Institutes of Health. The authors thank Paul Bunn for programming assistance and the reviewers for helpful comments. The Atherosclerosis Risk in Communities Study was carried out as a collaborative study supported by the National Heart, Lung, and Blood Institute. The authors thank the staff and participants of the ARIC study for their important contributions.

Supplementary material

Supplementary material available at Biometrika online includes three lemmas as well as three figures and six tables presenting additional simulation results.

Appendix
Proofs of the asymptotic results
In this appendix we prove Theorems 1–3. The proofs make use of three lemmas, which are stated and proved in the Supplementary Material. It is convenient to use empirical process notation: ℙn denotes the empirical measure for n independent clusters, ℙ is the true probability measure, and 𝔾n=n1/2(ℙn-ℙ) is the empirical process. Let L(θ,A) be the likelihood for a single cluster, such that the loglikelihood is
 l(θ,A)=log⁡∫{∏j=1J∏k=1KDjk(Ujk,b;β,Λk)}ϕ(b;Σ)db 
where Djk(Ujk,b;β,Λk)=∑l=0MjkΔjkl{Qjk(Ujkl,b;β,Λk)−Qjk(Ujk,l+1,b;β,Λk)}, Ujk=(Ujk1,…,Ujk,Mjk) and Δjkl=I(Ujkl≤Tjk<Ujk,l+1).

Proof of Theorem 1. We first show that limsupnΛ^ k(τk-ϵ)<∞ with probability 1 for any ϵ>0 and k∈{1,…,K}. Write
 m(θ,A)=log⁡{L(θ,A)+L(θ0,A0)2}, 
where A0=(Λ01,…,Λ0K). Since (θ^,A^) maximizes the likelihood,
 Pnl(θ^,A^)≥Pnl(θ0,A0)=Pnm(θ0,A0). 

We show in Lemma 1 that M={m(θ,A):θ∈Θ,A∈L} is a Glivenko–Cantelli class, where L is the set of K-dimensional nondecreasing functions (Λ1,…,ΛK) with Λk(0)=0. Hence, (ℙn-ℙ)m(θ0,A0) converges to zero almost surely. With probability one,
 liminfn⁡Pnl(θ^,A^) ≥liminfn⁡Pnm(θ0,A0)=Pm(θ0,A0)=O(1). 

Let M~=sup1≤k≤Ksupt∈[0,τk]{supXjk,β|βTXjk(t)|+supZjk|Zjk(t)|}, which is finite under Conditions 1–3. For any ϵ>0,
 liminfn⁡Pnl(θ^,A^) ≤limsupn⁡Pn{log⁡(∫∏j=1J∏k=1K{exp(−Gk[∫0UjkMjkexp⁡{β^TXjk(s)+bTZjk(s)}dΛ^k(s)])}ΔjkMjk    ×ϕ{b;Σ(γ^)}db∑j=1Ji)} ≤limsupn⁡Pn[log⁡{∫∏j=1J∏k=1K(exp⁡[−Gk{exp⁡(−M~−M~‖b‖)Λ^k(UjkMjk)}])ΔjkMjk    ×ϕ{b;Σ(γ^)}db∑j=1Ji}] ≤limsupn⁡Pn[log{∫‖b‖≤1∏j=1J∏k=1K(exp⁡[−Gk{exp⁡(−2M~)Λ^k(UjkMjk)}])ΔjkMjkϕ{b;Σ(γ^)}db}] +limsupn⁡Pn(log⁡[∫‖b‖>1ϕ{b;Σ(γ^)}db]) ≤−limsupn⁡Pn[∑j=1J∑k=1KΔjkMjkGk{exp⁡(−2M~)Λ^k(UjkMjk)}] ≤−limsupn⁡Pn[∑j=1J∑k=1KΔjkMjkI(UjkMjk≥τk−ϵ)Gk{exp⁡(−2M~)Λ^k(τk−ϵ)}]. 

Thus,
 limsupn⁡Pn[∑j=1J∑k=1KΔjkMjkI(UjkMjk≥τk−ϵ)Gk{exp⁡(−2M~)Λ^k(τk−ϵ)}]=O(1) 
for any ϵ>0. Since
 Pn{∑j=1JΔjkMjkI(UjkMjk≥τk−ϵ)}→E{∑j=1JΔjkMjkI(UjkMjk≥τk−ϵ)}, 
which is positive under Condition 5, limsupnGk{exp(-2M˜)Λ^ k(τk-ϵ)}<∞. If limsupnΛ^ k(τk-ϵ)=∞, then Gk{exp(-2M˜)Λ^ k(τk-ϵ)}=∞ under Condition 6. This is a contradiction. Therefore limsupnΛ^ k(τk-ϵ)<∞ with probability 1 for any ϵ>0 and any k∈{1,…,K}.

For any k=1,…,K, consider an increasing sequence {τks}(s=1, 2,…) such that lims→∞τks=τk. For any given subsequence of Λ^ k, Helly’s selection theorem, together with the fact that Λ^ k(τks)<∞, allows us at stage s to choose from the subsequence selected at stage s-1 a further subsequence which converges weakly on [0,τks]. We form a final subsequence, still denoted by {Λ^ k}, whose sth element is the sth element of the sequence selected at stage s. It is clear that Λ^ k converges weakly to some function, say Λk*, in any compact subset of [0,τk). Since the Lebesgue measure for the point τk is zero, Λ^ k→Λk* for t∈[0,τk] almost everywhere; that is, the Lebesgue measure of the set {t∈[0,τk]:Λ^ k(t) does not converge to Λk*(t)} is zero. Since β^ and γ^ are bounded, by choosing a further subsequence, which we still denote by (Λ^ 1,…,Λ^ K,β^,γ^), we can assume that Λ^ k converges to Λk* almost everywhere and that (β^,γ^) converges to some constant (β*,γ*).

Write θ*=(β*,γ*) and A*=(Λ1*,…,ΛK*). We wish to show that (θ*,A*)=(θ0,A0). By the concavity of the log function,
 Pnm(θ^,A^)≥12{Pnlog⁡L(θ^,A^)+Pnlog⁡L(θ0,A0)}≥Pnm(θ0,A0). 

Thus (ℙn-ℙ)m(θ^,A^)+ℙm(θ^,A^)≥(ℙn-ℙ)m(θ0,A0)+ℙm(θ0,A0). Since m(θ^,A^)∈M, (ℙn-ℙ)m(θ^,A^)→0 almost surely. Also, since |∏j=1J∏k=1KDjk(Ujk,b;β,Λk)|<1 for any β∈B and A∈L with probability 1, we see that with respect to the probability measure for Ujk(j=1,…,J;k=1,…,K),
 ∏j=1J∏k=1KDjk(Ujk,b;β^,Λ^k)−∏j=1J∏k=1KDjk(Ujk,b;β∗,Λk∗)→0. 

By the dominated convergence theorem,
  |Pm(θ^,A^)−Pm(θ∗,A∗)|  ≤|Pm(θ^,A^)−Pm(β^,γ∗,Λ^)|+|Pm(β^,γ∗,Λ^)−Pm(θ∗,A∗)|  =O(1)‖γ^−γ∗‖+Plog⁡∫{∏j=1J∏k=1KDjk(Ujk,b;β^,Λ^k)}ϕ{b;Σ(γ∗)}db+L(θ0,A0)∫{∏j=1J∏k=1KDjk(Ujk,b;β∗,Λk∗)}ϕ{b;Σ(γ∗)}db+L(θ0,A0). 

Hence |ℙm(θ^,A^)-ℙm(θ*,A*)|→0 almost surely, such that
 Plog⁡L(θ∗,A∗)+L(θ0,A0)2≥Pl(θ0,A0). 

By the properties of the Kullback–Leibler information, L(θ0,A0)=L(θ*,A*) with probability 1. So
 ∫{∏j=1J∏k=1KDjk(Ujk,b;β∗,Λk∗)}ϕ{b;Σ(γ∗)}db=∫{∏j=1J∏k=1KDjk(Ujk,b;β0,Λ0k)}ϕ{b;Σ(γ0)}db 
with probability 1. For any j∈{1,…,J}, k∈{1,…,K} and ljk∈{0,…,Mjk}, we set Δjkl=1 in the above equation for l=ljk,…,Mjk and take the sum of the resulting equations to obtain
  ∫Qjk(Ujkljk,b;β∗,Λk∗){∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β∗,Λk′∗)}ϕ{b;Σ(γ∗)}db  =∫Qjk(Ujkljk,b;β0,Λ0k){∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β0,Λ0k′)}ϕ{b;Σ(γ0)}db. 

This equality holds for arbitrary ljk. Therefore, for any tjk∈[0,τk],
  ∫Qjk(tjk,b;β∗,Λk∗){∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β∗,Λk′∗)}ϕ{b;Σ(γ∗)}db  =∫Qjk(tjk,b;β0,Λ0k){∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β0,Λ0k′)}ϕ{b;Σ(γ0)}db. 

For some fixed j∈{1,…,J} and k∈{1,…,K}, we repeat this process for (j′,k′)∈Cjk={1,…,j}×{1,…,k} to obtain
  ∫[{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β∗,Λk′∗)}{∏(j′,k′)∉CjkDj′k′(Uj′k′,b;β∗,Λk′∗)}]ϕ{b;Σ(γ∗)}db  =∫[{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β0,Λ0k′)}{∏(j′,k′)∉CjkDj′k′(Uj′k′,b;β0,Λ0k′)}]ϕ{b;Σ(γ0)}db. 

Setting Δj′k′l=1 in the above equation for (j′,k′)∉Cjk and l=0,…,Mj′k′ and then taking the sum of the resulting equations gives
  ∫{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β∗,Λk′∗)}ϕ{b;Σ(γ∗)}db=∫{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β0,Λ0k′)}ϕ{b;Σ(γ0)}db. 

By Condition 7, β*=β0, γ*=γ0 and Λk*(t)=Λ0k(t) for k∈{1,…,K} and t∈[0,τk]. Since Λ0k(t) is continuous, ‖θ^−θ0‖+∑k=1Ksupt∈[0,τk]|Λ^k(t)−Λ0k(t)|→0 almost surely. □

Proof of Theorem 2. Let Hjkl(t;θ,A) denote
 ∫Bjk(t,Ujkl,Ujk,l+1,b;β,Λk){∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β,Λk′)}ϕ{b;Σ(γ)}db∫{∏j′=1J∏k′=1KDj′k′(Uj′k′,b;β,Λk′)}ϕ{b;Σ(γ)}db, 
where
 Bjk(t,u,v,b;β,Λk) =exp⁡{βTXjk(t)+bTZjk(t)} ×(Qjk(v,b;β,Λk)Gk′[∫0vexp⁡{βTXjk(s)+bTZjk(s)}dΛk(s)]I(v≥t)  −Qjk(u,b;β,Λk)Gk′[∫0uexp⁡{βTXjk(s)+bTZjk(s)}dΛk(s)]I(u≥t)). 

For a single cluster, the score function for θ is
 lθ(θ,A)=[lβ(θ,A)lγ(θ,A)], 
where
 lβ(θ,A) =∑j=1J∑k=0K∑l=0MjkΔjkl∫0τkHjkl(t;θ,A)Xjk(t)dΛk(t),lγ(θ,A) =∫{∏j=1J∏k=1KDjk(Ujk,b;β,Λk)}ϕγ′{b;Σ(γ)}db∫{∏j=1J∏k=1KDjk(Ujk,b;β,Λk)}ϕ{b;Σ(γ)}db. 

To obtain the score operator for A, we consider a one-dimensional submodel Aϵ(h) where h=(h1,…,hK)T is a vector of functions in L2[0,τk]. Specifically, the submodel specifies that dΛk,ϵ,hk=(1+ϵhk)dΛk. The score function for A along this submodel is
 lA(θ,A)(h)=∑j=1J∑k=1K∑l=0MjkΔjkl∫0τkHjkl(t;θ,A)hk(t)dΛk(t). 

Clearly,
 Gn{lθ(θ^,A^)} =−n1/2[P{lθ(θ^,A^)}−P{lθ(θ0,A0)}],Gn{lA(θ^,A^)}(h) =−n1/2[P{lA(θ^,A^)(h)}−P{lA(θ0,A0)(h)}]. 

We apply Taylor series expansion at (θ0,A0) to the right-hand sides of the above two equations. In light of Lemma 3, the second-order terms are bounded by
 n1/2E([O(1)∑j=1J∑k=1K∑l=0Mjk{Λ^k(Ujkl)−Λ0k(Ujkl)}2]+O(1)‖β^−β0‖2+O(1)‖γ^−γ0‖2) =n1/2{Op(n−2/3)+Op(‖β^−β0‖2+‖γ^−γ0‖2)} =Op(n1/2‖β^−β0‖2+n1/2‖γ^−γ0‖2+n−1/6). 

Therefore
 Gn{lθ(θ^,A^)} = −n1/2[P{lθθ(θ^−θ0)+lθA(A^−A0)}] +Op(n1/2‖β^−β0‖2+n1/2‖γ^−γ0‖2+n−1/6),Gn{lA(θ^,A^)(h)} = −n1/2[P{lAθ(h)(θ^−θ0)+lAA(h,A^−A0)}] +Op(n1/2‖β^−β0‖2+n1/2‖γ^−γ0‖2+n−1/6), 
where lθθ is the second derivative of l(θ,A) with respect to θ, lθA(h) is the derivative of lθ along the submodel dAϵ,h, lAθ(h) is the derivative of lA(h) with respect to θ, and lAA(h,A^-A0) is the derivative of lA(h) along the submodel dA0+ϵd(A^-A0). All the derivatives are evaluated at (θ0,A0).

Let h* denote the least favourable direction such that
 (A1) lA∗lA(h∗)=lA∗lθ, 
where lA* is the adjoint operator of lA. Note that h* is a {p+d(d+1)/2}-dimensional vector of functions in ℋ=L2[0,τ1]×…×L2[0,τK]. We will show later that h* exists and has bounded variation. It then follows that
 E{lAA(h∗,A^−A0)} =−E{lA(h∗)lA(A^−A0)}=−∫lA∗lA(h∗)d(A^−A0) =−∫lA∗lθd(A^−A0)=E{lθA(A^−A0)}, 
so that
 Gn{lθ(θ^,A^)−lA(θ^,A^)(h∗)} =n1/2E[{lθ−lA(h∗)}⊗2](θ^−θ0) +Op(n1/2‖β^−β0‖2+n1/2‖γ^−γ0‖2+n−1/6). 

In addition, if we can show that lθ(θ^,A^)-lA(θ^,A^)(h*) belongs to a Donsker class and that the matrix E[{lθ-lA(h*)}⊗2] is invertible, then n1/2(θ^-θ0)=Op(1) and
 n1/2(θ^−θ0)=(E[{lθ−lA(h∗)}⊗2])−1Gn{lθ−lA(h∗)}+op(1). 

The influence function for θ^ is the efficient influence function, such that n1/2(θ^-θ0) converges weakly to a zero-mean normal random vector whose covariance matrix attains the semiparametric efficiency bound.

It remains to show the existence of h*, the Donsker property of lθ(θ^,A^)-lA(θ^,A^)(h*), and the nonsingularity of the matrix E[{lθ-lA(h*)}⊗2]. To show that there exists a solution h* to (A1), we equip H with an inner product defined by
 ⟨h(1),h(2)⟩=∑k=1K∫0τkhk(1)(t)hk(2)(t)dΛ0k(t). 

For any h(1),h(2)∈H,
 P{lA(h(1))lA(h(2))}=∑k=1K∫0τkΓk(h(1))(t)hk(2)(t)dΛ0k(t), 
where
 Γk(h)(t)=∑k′=1K∫0τk′∑j=1JE[{∑l=0MjkΔjklHjkl(s;θ0,A0)}   ×{∑j′=1J∑l=0Mj′k′Δj′k′lHj′k′l(t;θ0,A0)}]hk′(s)dΛ0k′(s). 

We define a seminorm ‖h‖Γ=〈Γ(h),h〉1/2 on the space H. If ‖h‖Γ=0 for some h∈H, then 0=〈Γ(h),h〉=ℙ{lA(h)2}. Therefore, with probability 1, lA(h)=0, i.e.,
  ∫∑j=1J∑k=1K[{∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β0,Λ0k′)}   ×∑l=0MjkΔjkl∫0τkBjk(t,Ujkl,Ujk,l+1,b;β0,Λ0k)hk(t)dΛ0k(t)]ϕ(b;Σ0)db=0. 

By the arguments in the proof of Lemma 3, hk(t)=0 for any k=1,…,K and t∈[0,τk]. So ‖⋅‖Γ is a norm in H. Clearly, ‖h‖Γ≤c‖h‖ for some constant c. By the bounded inverse theorem in Banach space, ‖h‖Γ≥c′‖h‖ for some constant c′. By the Lax–Milgram theorem (Zeidler, 1995), there exists a solution to (A1). Differentiation of this integral equation with respect to t yields
 g1k(t)hk∗(t)+∑k′=1K{∫tτk′g2k′(s,t)hk′∗(s)ds+∫0tg3k′(s,t)hk′∗(s)ds}=g4k(t), 
where g1k(t)>0 and the gjk(j=1, 2,3,4) are continuously differentiable functions. Thus, hk*(⋅) is continuously differentiable in [0,τk] for k∈{1,…,K}. By the arguments in the proof of Lemma 2, lθ(θ^,A^)-lA(θ^,A^)(h*) belongs to a Donsker class and converges in L2(ℙ)-norm to lθ-lA(h*).

Finally, we verify that E[{lθ-lA(h*)}⊗2] is invertible. If the matrix is singular, then there exist vectors v=(v1,v2) with v1∈ℝp and v2∈ℝd(d+1)/2 such that vTE[{lθ-lA(h*)}⊗2]v=0. It follows that, with probability 1, the score function along the submodel {θ0+ϵv,Aϵ(vTh*)} is zero. That is,
  ∫∑j=1J∑k=1K{∏j′=1,j′≠jJ∏k′=1,k′≠kKDj′k′(Uj′k′,b;β0,Λ0k′)}∑l=0MjkΔjkl∫0τkBjk(t,Ujkl,Ujk,l+1,b;β0,Λ0k)  ×{v1TXjk(t)−vTh∗(t)}dΛ0k(t)ϕ(b;Σ0)db−∫{∏j=1J∏k=1KDjk(Ujk,b;β0,Λ0k)}v2Tϕγ′(b;Σ0)db=0 
with probability 1. For any j∈{1,…,J}, k∈{1,…,K} and lj′k′∈{0,…,Mj′k′}(j′=1,…,j;k′=1,…,k), we evaluate the above equation at all possible values of Δj′k′l with (j′,k′)∈Cjk={1,…,j}×{1,…,k} and l=lj′k′,…,Mj′k′ and take the sum of the resulting equations. We then consider all possible values of Δj′k′l with (j′,k′)∉Cjk and l=0,…,Mj′k′ and take the sum of the resulting equations. This yields
  ∫{∏j′=1j∏k′=1kQj′k′(Uj′k′lj′k′,b;β0,Λ0k′)} ×∑j′=1j∑k′=1kGk′[∫0Uj′k′lj′k′exp⁡{β0TXj′k′(t)+bTZj′k′(t)}dΛ0k′(t)] ×∫0Uj′k′lj′k′exp⁡{β0TXj′k′(t)+bTZj′k′(t)}{v1TXj′k′(t)−vThk′∗(t)}dΛ0k′(t)ϕ(b;Σ0)db  −∫{∏j′=1j∏k′=1kQj′k′(Uj′k′lj′k′,b;β0,Λ0k′)}v2Tϕγ′(b;Σ0)db=0. 

This equality holds for any Uj′k′lj′k′. Hence, for any tj′k′∈[0,τk′](j′=1,…,j;k′=1,…,k),
  ∫{∏j′=1j∏k′=1kQj′k′(tj′k′,b;β0,Λ0k′)}(∑j′=1j∑k′=1kGk′[∫0tj′k′exp⁡{β0TXj′k′(t)+bTZj′k′(t)}dΛ0k′(t)]  ×∫0tj′k′exp⁡{β0TXj′k′(t)+bTZj′k′(t)}{v1TXj′k′(t)−vThk′∗(t)}dΛ0k′(t)−v2Tϕγ′(b;Σ0)ϕ(b;Σ0)∑j′=1j∑k′=1kGk′[∫0tj′k′exp⁡{β0TXj′k′(t)+bTZj′k′(t)}dΛ0k′(t)]) ×ϕ(b;Σ0)db=0. 

By Condition 8, v2=0 and
 Gk′[∫0texp⁡{β0TXjk(s)+bTZjk(s)}dΛ0k(s)]  ×[∫0texp⁡{β0TXjk(s)+bTZjk(s)}{v1TXjk(s)−vThk∗(s)}dΛ0k(s)]=0 
for any j∈{1,…,J}, k∈{1,…,K} and t∈[0,τk]. The term Gk′[∫0texp⁡{β0TXjk(s)+bTZjk(s)}dΛ0k(s)] is bounded away from zero. Therefore
 ∫0texp⁡{β0TXjk(s)+bTZjk(s)}{v1TXjk(s)−vThk∗(s)}dΛ0k(s)=0. 

Differentiating both sides with respect to t gives v1TXjk(s)-vThk*(s)=0. By Condition 7, v1=0. Hence, the matrix E[{lθ-lA(h*)}⊗2] is invertible. □

Proof of Theorem 3. By the chain rule,
 V^n =Pn[{ ∂∂θl(θ,A^θ)|θ=θ^}⊗2]=Pn[{ lθ(θ,A^θ)|θ=θ^+ lA(θ,A^θ)(∂A^θ∂θ)|θ=θ^}⊗2] =Pn[{lθ(θ^,A^)+lA(θ^,A^)(A˙θ^)}⊗2], 
where A˙θ^=∂A^θ/∂θ|θ=θ^. We first prove that the function A˙θ^ has bounded total variation, such that lA(θ^,A^)(A˙θ^) belongs to a Donsker class by Lemma 2. By the definition of A^θ, ℙnlA(θ,A^θ)(h)=0 for any θ∈Θ and h∈H. Differentiation with respect to θ at θ=θ^ yields
 PnlAA(θ^,A^)(A˙θ^,h)=−PnlAθ(θ^,A^)(h) 
for any h∈H. We consider the linear operator ℙnlAA(θ^,A^) which maps u∈H to l∞(H) by the definition of ℙnlAA(θ^,A^)(u,h). According to Theorem 1, ‖ℙnlAA(θ^,A^)-ℙlAA(θ0,A0)‖→0 in probability. Since ℙlAA(θ0,A0) has been shown to be invertible in the proof of Theorem 2, we conclude that ℙnlAA(θ^,A^) is invertible when n is large enough. Hence, there exists a unique solution in H which solves ℙnlAA(θ^,A^)(u,h)=-ℙnlAθ(θ^,A^)(h). Therefore A˙θ^ is the solution and has bounded total variation.

By the arguments for showing the existence of the least favourable direction h* in the proof of Theorem 2, -ℙlAA(θ0,A0)(A˙θ^-h*,A˙θ^-h*)≥c‖A˙θ^-h*‖L2(ℙ)2 for some positive constant c, so ℙnlAA(θ^,A^)(A˙θ^-h*,A˙θ^-h*)≥c‖A˙θ^-h*‖L2(ℙ)2. Since
 PnlAA(θ^,A^)(A˙θ^,A˙θ^−h∗) =−PnlθA(θ^,A^)(A˙θ^−h∗) =op(1)‖A˙θ^−h∗‖L2(P)+PlθA(θ0,A0)(A˙θ^−h∗) 
and
 PnlAA(θ^,A^)(h∗,A˙θ^−h∗) =op(1)‖A˙θ^−h∗‖L2(P)+PlAA(θ0,A0)(h∗,A˙θ^−h∗) =op(1)‖A˙θ^−h∗‖L2(P)+PlθA(θ0,A0)(A˙θ^−h∗), 
we obtain op(1)‖A˙θ^-h*‖L2(ℙ)≥c‖A˙θ^-h*‖L2(ℙ)2. Consequently, ‖A˙θ^-h*‖L2(ℙ)=op(1).

By the consistency of (θ^,A^) and the Donsker property of lA(θ^,A^)(A˙θ^),
 V^n =P[{lθ(θ^,A^)+lA(θ^,A^)(A˙θ^)}⊗2]+op(1) =P[{lθ(θ0,A0)+lA(θ0,A0)(A˙θ^)}⊗2]+op(1) =P[{lθ(θ0,A0)+lA(θ0,A0)(h∗)}⊗2]+op(1), 
where the last equality follows from the convergence of A˙θ^ to h*. Hence, the theorem follows from the fact that ℙ[{lθ(θ0,A0)+lA(θ0,A0)(h*)}⊗2] is the efficient information for θ0, which is the inverse covariance matrix of n1/2(θ^-θ0) by Theorem 2. □
==== Refs
References

Chang I. S. , Wen C. C.  & Wu Y. J.   (2007 ). A profile likelihood theory for the correlated gamma-frailty model with current status family data. Statist. Sinica 17 , 1023 –46 .

Chen K. , Jin Z.  & Ying Z.   (2002 ). Semiparametric analysis of transformation models with censored data. Biometrika 89 , 659 –68 .

Chen M. H. , Chen L. C. , Lin K. H.  & Tong X.   (2014 ). Analysis of multivariate interval censoring by Diabetic Retinopathy Study. Commun. Statist.  B 43 , 1825 –35 .

Chen M. H. , Tong X.  & Sun J.   (2007 ). The proportional odds model for multivariate interval-censored failure time data. Statist. Med. 26 , 5147 –61 .

Chen M. H. , Tong X.  & Sun J.   (2009 ). A frailty model approach for regression analysis of multivariate current status data. Statist. Med. 28 , 3424 –36 .

Chen M. H. , Tong X.  & Zhu L.   (2013 ). A linear transformation model for multivariate interval-censored failure time data. Can. J. Statist. 41 , 275 –90 .

Cook R. J.  & Tolusso D.   (2009 ). Second-order estimating equations for the analysis of clustered current status data. Biostatistics 10 , 756 –72 .19635760 

Goggins W. B.  & Finkelstein D. M.   (2000 ). A proportional hazards model for multivariate interval-censored failure time data. Biometrics 56 , 940 –3 .10985240 

Henderson R. , Diggle P.  & Dobson A.   (2000 ). Joint modelling of longitudinal measurements and event time data. Biostatistics 1 , 465 –80 .12933568 

Huang J.   (1996 ). Efficient estimation for the proportional hazards model with interval censoring. Ann. Statist. 24 , 540 –68 .

Kalbfleisch J. D.  & Prentice R. L.   (2002 ). The Statistical Analysis of Failure Time Data . Hoboken, New Jersey : Wiley, 2nd ed. 

Kim M. Y.  & Xue X.   (2002 ). The analysis of multivariate interval-censored survival data. Statist. Med. 21 , 3715 –26 .

Kor C. T. , Cheng K. F.  & Chen Y. H.   (2013 ). A method for analyzing clustered interval-censored data based on Cox’s model. Statist. Med. 32 , 822 –32 .

Lin D. Y.   (1994 ). Cox regression analysis of multivariate failure time data: The marginal approach. Statist. Med. 13 , 2233 –47 .

Murphy S. A.  & van der Vaart A. W.   (2000 ). On profile likelihood. J. Am. Statist. Assoc. 95 , 449 –65 .

The ARIC Investigators  (1989 ). The Atherosclerosis Risk in Communities (ARIC) study: Design and objectives. Am. J. Epidemiol. 129 , 687 –702 .2646917 

Tong X. , Chen M. H.  & Sun J.   (2008 ). Regression analysis of multivariate interval-censored failure time data with application to tumorigenicity experiments. Biomet. J. 50 , 364 –74 .

Wang L. , Sun J.  & Tong X.   (2008 ). Efficient estimation for the proportional hazards model with bivariate current status data. Lifetime Data Anal. 14 , 134 –53 .17899375 

Wang N. , Wang L.  & McMahan C. S.   (2015 ). Regression analysis of bivariate current status data under the gamma-frailty proportional hazards model using the EM algorithm. Comp. Statist. Data Anal. 83 , 140 –50 .

Wen C. C.  & Chen Y. H.   (2011 ). Nonparametric maximum likelihood analysis of clustered current status data with the gamma-frailty Cox model. Comp. Statist. Data Anal. 55 , 1053 –60 .

Wen C. C.  & Chen Y. H.   (2013 ). A frailty model approach for regression analysis of bivariate interval-censored survival data. Statist. Sinica 23 , 383 –408 .

Zeidler E.   (1995 ). Applied Functional Analysis: Applications to Mathematical Physics . New York : Springer. 

Zeng D.  & Lin D. Y.   (2007 ). Maximum likelihood estimation in semiparametric regression models with censored data (with Discussion). J. R. Statist. Soc.  B 69 , 507 –64 .

Zeng D. , Mao L.  & Lin D. Y.   (2016 ). Maximum likelihood estimation for semiparametric transformation models with interval-censored data. Biometrika 103 , 253 –71 .27279656 

Zhang Y.   (2002 ). A semiparametric pseudolikelihood estimation method for panel count data. Biometrika 89 , 39 –48 .

