
==== Front
BiometrikaBiometrikabiometbiometBiometrika0006-34441464-3510Oxford University Press 10.1093/biomet/asw016asw016MiscellaneaOn varieties of doubly robust estimators under missingness not at random with a shadow variable Miao Wang Beijing International Center for Mathematical Research, Peking University, 5 Summer Palace Road, Haidian District, Beijing 100871, P.R.C.Tchetgen Tchetgen Eric J. Department of Biostatistics, Harvard University, 677 Huntington Avenue, Boston, Massachusetts 02115, U.S.A., etchetge@hsph.harvard.edumwfy@pku.edu.cn6 2016 10 5 2016 103 2 475 482 9 2015 3 2016 © 2016 Biometrika Trust2016Suppose we are interested in the mean of an outcome variable missing not at random. Suppose however that one has available a fully observed shadow variable, which is associated with the outcome but independent of the missingness process conditional on covariates and the possibly unobserved outcome. Such a variable may be a proxy or a mismeasured version of the outcome and is available for all individuals. We have previously established necessary and sufficient conditions for identification of the full data law in such a setting, and have described semiparametric estimators including a doubly robust estimator of the outcome mean. Here, we propose two alternative estimators, which may be viewed as extensions of analogous methods under missingness at random, but enjoy different properties. We assess the correctness of the required working models via straightforward goodness-of-fit tests.

Doubly robust estimationMissingness not at randomShadow variable
==== Body
1. Introduction
Doubly robust methods are designed to mitigate estimation bias due to model misspecification in observational studies and imperfect experiments. Such methods have grown in popularity in recent years for estimation with missing data and other forms of coarsening (Robins et al., 1994; Scharfstein et al., 1999; Van der Laan & Robins, 2003; Bang & Robins, 2005; Tsiatis, 2006). There exist various constructions of doubly robust estimators for the mean of an outcome that is missing at random; see Kang & Schafer (2007). In contrast, for data missing not at random, the difficulty of identification undermines one's ability to obtain accurate inferences, and doubly robust estimation is far more challenging. Identification of a full data model means that the parameters indexing the model are uniquely determined by the data that are actually observed. Statistical inference based on non-identifiable models may be misleading and of limited interest in practice; see Miao et al. (2015). Under missingness at random, the full data law, i.e., the joint distribution of all variables of interest, is nonparametrically identified from the observed data. However, under missingness not at random, identification is not possible without further restrictions on the missingness process. Although no general identification results are available for data missing not at random, one may identify the full data law under specific assumptions. Building on earlier work by D'Haultfoeuille (2010), Wang et al. (2014) and Zhao & Shao (2015), we have previously used a fully observed shadow variable to establish a general identification framework for data missing not at random, in a 2015 technical report available from the authors. Such a variable is associated with the outcome conditional on covariates, but independent of the missingness conditional on covariates and the outcome (Kott, 2014); it may be available in many empirical studies, where a fully observed proxy or a mismeasured version of the outcome is available. For example, in a study of the mental health of children in Connecticut (Zahner et al., 1992; Ibrahim et al., 2001), researchers were interested in evaluating the prevalence of students with abnormal psychopathological status based on their teacher's assessment, which was subject to missingness. A separate parent report available for all children in the study is a proxy for the teacher's assessment, but is unlikely to be related to the teacher's response rate conditional on covariates and her assessment of the student; in this case the parental assessment constitutes a valid shadow variable. Other examples can be found in Wang et al. (2014).

Throughout, let \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} denote the outcome, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R$\end{document} is its missingness indicator, with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R=1$\end{document} if \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} is observed, otherwise \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R=0$\end{document}, and let \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document} denote fully observed covariates. Suppose that one has also fully observed a shadow variable \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z$\end{document} that satisfies
Assumption 1.
(i) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\def\Vbar{\unicode{x2568}}Z\not {\Vbar} Y \mid X$\end{document}; (ii) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z \Vbar R \mid (Y,X)$\end{document}.



Assumption 1 formalizes the idea that the shadow variable only affects the missingness through its association with the outcome. We provide a directed acyclic graph in the Supplementary Material that can help understand the assumption. The shadow variable introduces additional conditional independence conditions, which impose further restrictions on the missingness process, and thus provides better opportunity for identification under missingness not at random. In the 2015 technical report, we presented a brief review of such problems, and gave necessary and sufficient conditions as well as sufficient conditions for identification with a shadow variable. In particular, if the outcome is binary, the full data law is identifiable with a binary shadow variable. But for a continuous outcome, a binary shadow variable does not impose enough restrictions to identify the full data law; see the Supplementary Material for a counterexample. Identification for a continuous outcome requires at least one continuous shadow variable, but even then, additional conditions are needed. We consider a location-scale model for the density function:
 (1) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} f(y\mid x,z,r) = \frac{1}{\sigma_r(z,x)}f_{r}\left\{ \frac{y-\mu_r(z,x)}{\sigma_r(z,x)}\right\} ,\quad r=0,1, \end{equation*}\end{document} 
with unrestricted functions \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu _r$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sigma _r$\end{document}, and density functions \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_{r}$\end{document}. Under certain regularity conditions summarized in the Appendix, we have previously proved identification of the full data law if either \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(y\mid x,z,r=1)$\end{document} or \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(y\mid x,z,r=0)$\end{document} follows model (1), even if the missingness process is unrestricted. Model (1) includes many commonly-used models, for instance, Gaussian models, and thus demonstrates that lack of identification is not an issue in many familiar situations. Assumption 1 plays a central role for identification of model (1). If Assumption 1 is violated, i.e., the shadow variable is not available, model (1) is not identified even if one assumes a parametric missingness model. For additional discussion about identification under missingness not at random, see Miao et al. (2015) and Wang et al. (2014).

With models satisfying the corresponding identification conditions, previous authors have developed several non-doubly robust estimators. Among them, inverse probability weighted estimation (Wang et al., 2014) and pseudo-likelihood estimation (Zhao & Shao, 2015) are sensitive to model misspecification, and nonparametric estimation (D'Haultfoeuille, 2010) requires an unrealistically large sample for reasonable performance when the covariate dimension is moderate to large. In contrast, a doubly robust approach remains consistent and asymptotically normal under partial misspecification. In the 2015 technical report, we developed a doubly robust estimator based on a three-part model for the full data: a model for the joint distribution of the outcome and the shadow variable in complete cases; a model for the propensity score evaluated at a reference value of the outcome; and a log odds ratio model encoding the association of the outcome and the missingness process. Under correct specification of the log odds ratio model, the doubly robust estimator is consistent if either of the other two models is correct, but not necessarily both. However, the construction of a doubly robust estimator is not unique. In this paper, we develop two alternative doubly robust estimators of the outcome mean that enjoy different properties, and we compare them both in theory and via simulations reported in the Supplementary Material.

2. Doubly robust estimators
Under Assumption 1, we factorize the conditional density function of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(Z,Y,R)$\end{document} given \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document} as
 (2) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} f(z,y,r\mid x) = c(x)\exp\{(1-r){\rm OR}(y\mid x)\}{\rm pr}(r\mid y=0,x)f(z,y\mid r=1,x), \end{equation*}\end{document} 
where \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c(x)={\rm pr}(r=1\mid x)/{\rm pr}(r=1\mid y=0,x)$\end{document}; \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1\mid y=0,x)$\end{document} is the response probability evaluated at the reference level \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y=0$\end{document}, and is referred to as the baseline propensity score; \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(z,y\mid r=1,x)$\end{document} is the joint density function of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(Z,Y)$\end{document} conditional on \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document} among the complete cases, i.e., the subset with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$r=1$\end{document}, and is referred to as the baseline outcome density;
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[ {\rm OR}(y\mid x)=\log \frac{{\rm pr}(r=0\mid y,x) {\rm pr}(r=1 \mid y=0,x)}{{\rm pr} (r=0 \mid y=0,x) {\rm pr}(r=1 \mid y,x)}, \]\end{document} 
is the log of the conditional odds ratio function relating \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R$\end{document} given \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document}, with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E[\exp \{{\rm OR}(y \mid x)\} \mid r=1,x] < \infty $\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y=0 \mid x)=0$\end{document}. For a continuous outcome, we require that \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(z,y \mid r=1,x)$\end{document} satisfies model (1) to guarantee identification. For estimation, we specify separate parametric models \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid y=0,x;\alpha )$\end{document}, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(z,y \mid r=1,x;\beta )$\end{document}, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y \mid x;\gamma )$\end{document}. We suppose throughout that \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y\mid x;\gamma )$\end{document} is correctly specified, which can be achieved by specifying a relatively flexible model, or following the approach suggested by Higgins et al. (2008) if information on the reasons for missingness are available. From (2), we have
 (3) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{align} {\rm pr}(r=1\mid y,x) &=\frac{{\rm pr}(r=1 \mid y=0,x)}{{\rm pr}(r=1 \mid y=0,x)+\exp\{{\rm OR}(y \mid x)\}\{{\rm pr}(r=0 \mid y=0,x)\}}, \end{align}\end{document} 
 (4) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{align} f(z,y \mid r=0,x) &=\frac{\exp\{{\rm OR}(y \mid x)\}}{E[\exp\{{\rm OR}(y \mid x)\} \mid r=1,x]}f(z,y \mid r=1,x), \end{align}\end{document} 
 (5) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{align} E(y \mid r=0,x) &=\frac{ E[\exp\{{\rm OR}(y \mid x)\}y \mid r=1,x]}{ E[\exp\{{\rm OR}(y \mid x)\} \mid r=1,x]}. \end{align}\end{document} 

The propensity score, and its reciprocal, i.e., the inverse probability weight function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W(x,y;\alpha ,\gamma )= 1/{\rm pr}(r=1\mid x,y;\alpha ,\gamma )$\end{document}, are determined by the baseline propensity score model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid x,y=0;\alpha )$\end{document} and the log odds ratio model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y \mid x;\gamma )$\end{document} as in (3); the conditional outcome mean among the incomplete cases \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ E(y \mid r=0,x;\beta ,\gamma )$\end{document} is determined by the baseline outcome model and the log odds ratio model as in (5).

Estimation of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\beta $\end{document} only involves complete cases. Letting \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E$\end{document} denote the empirical mean, we solve
 (6) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \hat E \{rS(z,y,x;\hat \beta)\}=0, \end{equation*}\end{document} 
with score function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S(z,y,x;\beta )=\partial \log \{P(z,y \mid r=1,x;\beta )\}/\partial \beta $\end{document}. Estimation of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \alpha $\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \gamma $\end{document} is motivated from a classical estimating equation following the fact that the respective weighted mean of any vector functions \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G(x,y)$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H(x)$\end{document} among the complete cases equals their population mean: \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W(x,y;\hat \alpha ,\hat \gamma ) r -1\} \{G(x,y)^{\rm T},H(x)^{\rm T}\}^{\rm T}] =0$\end{document}, where \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G(x,y)$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H(x)$\end{document} are user-specified vector functions of dimension equal to that of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\gamma $\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\alpha $\end{document}, respectively, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E[\partial W(x,y;\alpha ,\gamma ) r /\partial (\alpha ,\gamma )\{G(x,z)^{\rm T},H(x)^{\rm T}\}]$\end{document} is nonsingular for all \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\alpha ,\gamma )$\end{document}. For example, if \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1\mid y,x;\alpha ,\gamma )$\end{document} follows a logistic model and thus \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W(x,y;\alpha ,\gamma )=1+\exp \{-(1,x^{\rm T})\alpha -\gamma y\}$\end{document}, we may naturally choose \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G(x,y)=y$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H(x)=(1,x^{\rm T})^{\rm T}$\end{document}. Because \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document} is missing for \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$r=0$\end{document}, the classical estimating equation is not feasible. However, Assumption 1 allows us to replace \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document} with the shadow variable \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$z$\end{document} and to replace \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G(x,y)$\end{document} with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G(x,z)$\end{document}. To make the estimating equation doubly robust, we incorporate the baseline outcome model into the estimating equation for \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\alpha ,\gamma )$\end{document}. Let \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G_1(x,z;\beta ,\gamma )=G(x,z)-E\{G(x,z)\mid r=0,x;\beta ,\gamma \}$\end{document}, we solve
 (7) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \hat E [ \{W(x,y;\hat\alpha ,\hat\gamma ) r -1\} \{G_1(x,z;\hat\beta,\hat\gamma)^{\rm T},H(x)^{\rm T}\}^{\rm T} ] =0,\end{equation*}\end{document} 
with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G(x,z)$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H(x)$\end{document} such that \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E[\partial W(x,y;\alpha ,\gamma ) r /\partial (\alpha ,\gamma )\{G_1(x,z;\beta ,\gamma )^{\rm T},H(x)^{\rm T}\}]$\end{document} is nonsingular for all \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\alpha ,\beta ,\gamma )$\end{document}. The shadow variable \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z$\end{document} is used as a proxy of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document}, thus, a choice of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z$\end{document} that is highly correlated with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} is desirable to maximize efficiency.

Using \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\hat \alpha ,\hat \beta ,\hat \gamma )$\end{document} obtained from equations (6) and (7), we construct three different estimators for the outcome mean that are consistent if either the baseline outcome model or the baseline propensity score model is correctly specified, together with the log odds ratio model.

A regression estimator with residual bias correction was previously described in our 2015 technical report. We use the weighted residual to correct the bias of the conditional mean among incomplete cases. Letting \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_0(x;\hat \beta ,\hat \gamma )= E(y \mid r=0,x;\hat \beta ,\hat \gamma )$\end{document}, the estimator is
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[ \hat\mu_1 = \hat E [ W (x,y;\hat\alpha,\hat\gamma) r \{ y-M_0(x;\hat \beta,\hat\gamma) \} +M_0(x;\hat \beta,\hat\gamma) ]. \]\end{document} 

A Horvitz–Thompson estimator with extended weights employs an extended baseline propensity score model and an extended weight function. The extended baseline propensity score model with unknown parameter \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\phi $\end{document} satisfies \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}_{\rm ext}(r=1 \mid y=0,x;\phi )={\rm pr}(r=1 \mid y=0,x;\hat \alpha )$\end{document} only at \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\phi =0$\end{document}. For example, we can specify
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[ {\rm pr}_{\rm ext}(r=1 \mid y=0,x;\phi)=\frac{{\rm pr}(r=1 \mid y=0,x;\hat\alpha)}{{\rm pr}(r=1 \mid y=0,x;\hat\alpha)+\exp\{\phi g(x)\}{\rm pr}(r=0 \mid y=0,x;\hat\alpha)}, \]\end{document} 
with user-specified scalar function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g(x)$\end{document}. The extended weight function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W_{\rm ext}(x,y;\phi )$\end{document}, and its reciprocal is determined as in (3) with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y\mid x)$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid y=0,x)$\end{document} replaced by \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y\mid x;\hat \gamma )$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}_{\rm ext}(r=1 \mid y=0,x;\phi )$\end{document} respectively. We estimate \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\phi $\end{document} by solving
 (8) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \hat E [\{W_{\rm ext}( x,y;\hat\phi) r -1\} \{M_0(x;\hat\beta,\hat\gamma) - \hat\mu_{\rm reg}\} ] =0, \end{equation*}\end{document} 
with previously obtained \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\hat \beta ,\hat \gamma )$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _{\rm reg} = \hat E \{(1-r)M_0(x;\hat \beta ,\hat \gamma )+ry\}$\end{document}. The Horvitz–Thompson estimator with extended weights is
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[ \hat \mu_{2} = \hat E \left\{ \frac{W_{\rm ext}(x,y;\hat\phi )r}{\hat E \{W_{\rm ext}( x,y;\hat\phi )r\}} y\right\} . \]\end{document} 

A regression estimator with an extended outcome model involves an extended outcome model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm 0ext}(x;\psi )$\end{document} with parameter \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\psi $\end{document} satisfying \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm 0ext}(x;\psi )=M_{0}(x;\hat \beta ,\hat \gamma )$\end{document} only at \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\psi =0$\end{document}. If \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_0(x;\hat \beta ,\hat \gamma )=\lambda \{Q(x;\hat \beta ,\hat \gamma )\}$\end{document} for some inverse link \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda $\end{document} and some function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Q$\end{document}, we can specify \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm 0ext}(x;\psi )=\lambda \{Q(x;\hat \beta ,\hat \gamma )+\psi q(x)\}$\end{document} with a scalar function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$q(x)$\end{document}. We estimate \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\psi $\end{document} by solving
 (9) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \hat E [ \{W( x,y;\hat\alpha,\hat\gamma) -1 \} r\{y-M_{\rm 0ext}(x;\hat\psi) \}]=0,\end{equation*}\end{document} 
with previously obtained \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\hat \alpha ,\hat \gamma )$\end{document}. The regression estimator with an extended outcome model is
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[ \hat \mu_3= \hat E \{(1-r)M_{\rm 0ext}(x;\hat\psi) + ry\}. \]\end{document} 
All three estimators \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _1,\hat \mu _2$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3$\end{document} are doubly robust.
Theorem 1.
Under Assumption 1, if the log odds ratio model
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y \mid x;\gamma )$\end{document}
is correct, and the probability limit of equations (6), (7), (8) and (9) has a unique solution, then
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _1$\end{document},
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _2$\end{document}
and
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3$\end{document}
are consistent if either
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(z,y \mid r=1,x;\beta )$\end{document}
or
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid y=0,x;\alpha )$\end{document}
is correctly specified.



The extended models not only provide double robustness, but also provide a strategy to check whether the working models are correct. We prove in the Appendix that if the baseline propensity score model is correct, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \phi $\end{document} converges to zero in probability; and if the baseline outcome model is correct, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \psi $\end{document} converges to zero in probability. Therefore, one may use this property to assess whether the working models are correctly specified by checking whether \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \phi $\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \psi $\end{document} are within sampling variability of zero, respectively. However, the space of possible departures from the assumed model may be prohibitively large relative to the proposed test so that the resulting goodness-of-fit test will generally have good power against certain alternatives but not in all possible directions away from the specified working model. We explore the power of the proposed goodness-of-fit test via simulation in the Supplementary Material.

All three doubly robust estimators rely on a correct log odds ratio model, since inference about the law of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} requires an accurate evaluation of the dependence between the missingness process and the outcome, which is captured by the log odds ratio model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y \mid x;\gamma )$\end{document}. To the best of our knowledge, previous doubly robust estimators have assumed that this log odds ratio is known, either to equal the null value of zero under missingness at random (Bang & Robins, 2005; Tsiatis, 2006; Van der Laan & Robins, 2003), or to be of a known functional form with no unknown parameters (Vansteelandt et al., 2007; Robins et al., 2008). We have relaxed these more stringent assumptions.

3. Relation to previous doubly robust estimators and comparisons
Previous doubly robust estimators under missingness at random can be viewed as special cases of our estimators. Under missingness at random, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm OR}(y \mid x)=0$\end{document}, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid x,y=0)={\rm pr}(r=1 \mid x)$\end{document}, the inverse probability weight function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W(x;\alpha )=1/{\rm pr}(r=1 \mid x;\alpha )$\end{document} does not vary with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document}, and the conditional mean among the population \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M(x;\beta )$\end{document} equals that among the incomplete cases \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_0(x;\beta ,\gamma )$\end{document}. The estimator \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _1'=\hat E [W(x;\hat \alpha )r\{y-M(x;\hat \beta )\}+ M(x;\hat \beta )]$\end{document} of Kang & Schafer (2007) is a special case of the regression estimator with residual bias correction; the estimator \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _2' = \hat E [W_{\rm ext}(x;\hat \phi )r/\hat E \{W_{\rm ext}( x;\hat \phi )r\} y]$\end{document} proposed by Robins et al. (2007), with an extended logistic propensity score model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\text {logit pr}_{\rm ext}(r=1 \mid x;\phi )=(1,x^{\rm T})\hat \alpha +\phi g(x)$\end{document}, is a special case of the Horvitz–Thompson estimator with extended weights; the estimator \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3' =\hat E \{M_{\rm ext}(x;\hat \psi )\}$\end{document} proposed by Robins et al. (2007), with an extended outcome model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm ext}(x;\hat \psi )$\end{document} satisfying \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [W( x;\hat \alpha )r\{y-M_{\rm ext}(x;\hat \psi )\}]=0$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [r\{y-M_{\rm ext}(x;\hat \psi )\}]=0$\end{document}, is a special case of the regression estimator with an extended outcome model.

The three proposed doubly robust estimators enjoy some of the properties of their missingness at random analogs. The estimator \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _2$\end{document} is a convex combination of the observed outcome values. It satisfies the boundedness property (Robins et al., 2007) that the estimator falls in the parameter space for the outcome mean almost surely. Such estimators are preferred when the inverse probability weights are highly variable, because they rule out estimates outside the sample space. Boundedness is not guaranteed for \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _1$\end{document}. If the range of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm 0ext}(x;\psi )$\end{document} is contained in the sample space of the outcome, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3$\end{document} also satisfies the boundedness condition, but this does not hold in general. For example, if the outcome is continuous, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm 0ext}(x;\psi )=M_0(x;\hat \beta ,\hat \gamma )+\psi $\end{document}, the range of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3$\end{document} may be outside the sample space of the outcome mean.

The three proposed estimators offer certain improvements in terms of bias when both models are misspecified. The asymptotic bias of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _1$\end{document} can be written as
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[ {\rm Bias}_1= E[\{W(x,y;\alpha^*,\gamma^*)r-1\}\{y-M_0(x;\beta^*,\gamma^*)\}], \]\end{document} 
and the asymptotic bias of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3$\end{document} has the same form with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_0(x;\beta ,\gamma ^*)$\end{document} replaced by \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_{\rm 0ext}(x;\psi ^*)$\end{document}, with probability limits \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\alpha ^*,\beta ^*,\gamma ^*,\psi ^*)$\end{document} of the corresponding estimators. The asymptotic bias of doubly robust estimators is a product of the bias of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W(x,y;\alpha ^*,\gamma ^*)$\end{document} and the bias of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M_0(x;\beta ^*,\gamma ^*)$\end{document}. When both of these models are nearly correct, doubly robust estimators will generally have smaller bias than non-doubly robust estimators based on one of the two models only; but this is unlikely to hold if both models are seriously misspecified, especially when the weights are highly variable (Robins et al., 2007; Vermeulen & Vansteelandt, 2015). However, if \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H(x)$\end{document} in equation (7) includes a constant function, then \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E \{W(x,y;\alpha ^*,\gamma ^*)r\}=1$\end{document}, which restricts the amount of variability of the inverse probability weights. Thus, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm Bias}_1$\end{document} does not explode with large weights.

In simulation studies, we found that the three doubly robust estimators approximate the true outcome mean if either of the baseline models is correct, but they are biased if neither baseline model is correct. For the case with moderately variable weights, the relative magnitude of the bias depends on the specific data generating process, but for the case with highly-variable weights, the Horvitz–Thompson estimator with extended weights has smaller bias. If the baseline outcome model is correct, the parameter of the extended outcome model, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \psi $\end{document} is close to zero; and if the baseline propensity score model is correct, the parameter of the extended weight model, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \phi $\end{document} is close to zero. We also perform formal tests of the null hypotheses \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbb H_0:\ \phi =0$\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathbb H}_0:\ \psi =0$\end{document} respectively under level \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$0{\cdot }05$\end{document}. The results show an empirical Type I error approximating \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$0{\cdot }05$\end{document} if the required baseline propensity score model or baseline outcome model is correct, respectively, i.e., the true values of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\phi $\end{document} and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\psi $\end{document} equal zero respectively. Such tests have good power in moderate samples if the required model is incorrect, respectively. We recommend the proposed hypothesis tests to check for severe misspecification of the baseline models in practice.

4. Discussion
Extensions of the doubly robust methods described in this work to other functionals, such as a parameter \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\delta $\end{document} solving a full data estimating equation \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E\{U(z,y,x;\delta )\}=0$\end{document}, can be achieved by replacing \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$U$\end{document} wherever \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y$\end{document} occurs in the estimating equations and solving the doubly robust estimating equation for the parameter of interest. The methods also have potential application in related areas, such as longitudinal data analysis and causal inference.

Acknowledgments
The work is partially supported by the China Scholarship Council and the National Institute of Health. The authors are grateful to the referees and the editor for their helpful comments.

Supplementary material
Supplementary material available at Biometrika online includes the proof of Lemma A1, a counterexample to identification with a continuous outcome, a graph model for the shadow variable, and simulation studies.

Appendix

Proof of Theorem 1
We need the following lemma, which we prove in the Supplementary Material.
Lemma A1.
Under Assumption 1, suppose that the log odds ratio model is correct, and that the probability limit of equations (6) and (7) has a unique solution. For any square integrable vector function
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D(z,y,x)$\end{document}, scalar function
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V(x)$\end{document}, and
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\hat \alpha ,\hat \beta ,\hat \gamma )$\end{document}
solving equations (6) and (7),
if
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid y=0,x;\alpha )$\end{document}
is correct, then
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W( x,y;\hat \alpha ,\hat \gamma ) r -1\}D(z,y,x)]$\end{document}
converges to zero in probability;

if
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(z,y \mid r=1,x;\beta )$\end{document}
is correct, then
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \hat E [r\exp \{{\rm OR}(y \mid x;\hat \gamma )\} V(x) \{D(z,y,x)-E[D(z,y,x) \mid r=0,x;\hat \beta ,\hat \gamma ]\}]$\end{document}
converges to zero in probability;

if either of the baseline models is correct, then
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W(x,y;\hat \alpha ,\hat \gamma )r-1\}\{D(z,y,x)-E [D(z,y,x) \mid r=0,x;\hat \beta ,\hat \gamma ]\}]$\end{document}
converges to zero in probability.




Proof of Theorem 1.
Suppose that the log odds ratio model is correctly specified, and that the probability limit of the estimating equations has a unique solution.
Double robustness of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _1$\end{document}. If either of the baseline models is correct, from (iii) of Lemma A1, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W(x,y;\hat \alpha ,\hat \gamma )r-1\}\{y- E (y \mid r=0,x;\hat \beta ,\hat \gamma )\}]$\end{document} converges to zero, therefore \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [ W (x,y;\hat \alpha ,\hat \gamma ) r \{ y-M_0(x;\hat \beta ,\hat \gamma ) \} +M_0(x;\hat \beta ,\hat \gamma ) ]$\end{document} converges to the true outcome mean.

Double robustness of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _2$\end{document}. From (i) of Lemma A1, if the baseline propensity score model is correct, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W_{\rm ext}( x,y;\phi =0) r -1\}\{M_0(x;\hat \beta ,\hat \gamma )-\hat \mu _{\rm reg}\}] = \hat E [\{W( x,y;\hat \alpha , \hat \gamma ) r -1\}\{M_0(x;\hat \beta ,\hat \gamma )-\hat \mu _{\rm reg}\}]$\end{document} converges to zero, i.e., \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\phi =0$\end{document} is a solution of the probability limit of equation (8). Thus, the solution of equation (8) \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \phi $\end{document} converges to zero, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lim _{n\rightarrow +\infty } \hat E \{W_{\rm ext}( x,y;\hat \phi )r \}=1$\end{document}, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lim _{n\rightarrow +\infty } \hat E \{W_{\rm ext}( x,y;\hat \phi )r y\}=\lim _{n\rightarrow +\infty } \hat E \{W( x,y;\hat \alpha , \hat \gamma )r y\}= E(Y)$\end{document}. If the baseline outcome model is correct, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [(1-r)\{y-M_0(x;\hat \beta ,\hat \gamma )\}]$\end{document} converges to zero; \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _{\rm reg} = \hat E [(1-r)M_0(x;\hat \beta ,\hat \gamma )+ry]$\end{document} converges to the true outcome mean; and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E (y-\hat \mu _{\rm reg})$\end{document} converges to zero. By definition of the extended weight function, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{W_{\rm ext} (x,y;\hat \phi ) -1 \}r = r\exp \{{\rm OR}(y \mid x;\hat \gamma )\}V(x)$\end{document} with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V(x)={\rm pr}_{\rm ext}(r=0 \mid y=0,x;\hat \phi )/{\rm pr}_{\rm ext}(r=1 \mid y=0,x;\hat \phi )$\end{document}. From (ii) of Lemma A1, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W_{\rm ext}(x,y;\hat \phi ) -1\}r\{y-M_0(x;\hat \beta ,\hat \gamma )\}]$\end{document} converges to zero. Thus, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W_{\rm ext}(x,y;\hat \phi )r -1\}\{y-M_0(x;\hat \beta ,\hat \gamma )\}]$\end{document} must converge to zero, and
 \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{align*} \hat\mu_2& =1/\hat E \{W_{\rm ext}(x,y;\hat\phi)r\} \times \hat E [\{W_{\rm ext}(x,y;\hat\phi ) r -1\}\{y-M_0(x;\hat \beta,\hat \gamma)\}] \\
&\quad +1/\hat E \{W_{\rm ext}(x,y;\hat\phi)r\} \times \hat E [\{W_{\rm ext}( x,y;\hat\phi) r -1\} \{M_0(x;\hat\beta,\hat\gamma) - \hat\mu_{\rm reg}\} ] \\
&\quad + 1/\hat E \{W_{\rm ext}(x,y;\hat\phi)r\} \times \hat E (y-\hat\mu_{\rm reg}) + \hat\mu_{\rm reg} \end{align*} \end{document} 
converges to the true outcome mean in probability.

Double robustness of \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3$\end{document}. If \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm pr}(r=1 \mid x,y=0;\alpha )$\end{document} is correct, from (i) of Lemma A1, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W(x,y;\hat \alpha ,\hat \gamma )r-1\}\{y-M_{0{\rm ext}}(x;\hat \psi )\}]$\end{document} converges to zero. Note equation (9), we have that \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [(1-r)\{y-M_{\rm 0ext}(x;\hat \psi )\}]$\end{document} converges to zero. Thus, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \mu _3=\hat E \{(1-r)M_{\rm 0ext}(x;\hat \psi ) + ry\}$\end{document} converges to the true outcome mean. If \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(z,y \mid r=1,x;\beta )$\end{document} is correct, then \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [(1-r)\{y-M_0(x;\hat \beta ,\hat \gamma )\}]$\end{document} converges to zero. Since \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{W (x,y;\hat \alpha ,\hat \gamma ) -1 \}r = r\exp \{{\rm OR}(y \mid x;\hat \gamma )\}V(x)$\end{document} with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V(x)={\rm pr}(r=0 \mid y=0,x;\hat \alpha )/{\rm pr}(r=1\mid y=0,x;\hat \alpha )$\end{document}, from (ii) of Lemma A1, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat E [\{W(x,y;\hat \alpha ,\hat \gamma ) - 1\}r\{ y - M_{\rm 0ext}(x;\psi =0)\} ] = \hat E [\{W( x,y;\hat \alpha ,\hat \gamma ) - 1\}r\{ y - M_0(x;\hat \beta ,\hat \gamma )\} ]$\end{document} converges to zero. That is, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\psi =0$\end{document} is a solution of the probability limit of equation (9). Thus, the solution of equation (9), \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat \psi $\end{document} converges to zero, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lim _{n\rightarrow +\infty } \hat E \{(1-r)M_{\rm 0ext}(x;\hat \psi ) + ry\} =\lim _{n\rightarrow +\infty } \hat E \{(1-r)M_0(x;\hat \beta ,\hat \gamma ) + ry\} = E(Y)$\end{document}.





Regularity conditions for model \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(1)$\end{document}
The full data law is identifiable if either \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(y\mid z,x,r=1)$\end{document} or \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(y\mid z,x,r=0)$\end{document} follows the location-scale model (1), and the corresponding density function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_{r=1}$\end{document} or \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_{r=0}$\end{document} satisfies the following conditions:
the characteristic function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\varphi (t)$\end{document} of the density function \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(v)$\end{document} satisfies \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$0<\vert \varphi (t)\vert <C\exp (-\delta \vert t\vert )$\end{document} for \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t\in \mathbb {R}$\end{document} and some constants \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C,\delta >0$\end{document};

conditional on \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x$\end{document}, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu (z,x)$\end{document}, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sigma (z,x)$\end{document} are continuously differentiable and integrable with respect to \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$z$\end{document}; \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f(v)$\end{document} is continuously differentiable, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\int _{-\infty }^{+\infty }\vert v \times \partial f(v)/\partial v\vert ^2 {\rm d}v$\end{document} is finite;

there exist some linear one-to-one mapping \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M: f\{(v-a)/b\}\longmapsto h(t,a,b)$\end{document} and some value \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$-\infty \leq t_0\leq +\infty $\end{document} such that \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lim _{t\rightarrow t_0}h(t,a,b)/h(t,a',b')$\end{document} either equals zero or infinity for any \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$a,a'\in \mathbb R$\end{document}, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$b,b'>0$\end{document} with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(a,b)\neq (a',b')$\end{document}.



Many commonly-used models satisfy conditions (a)–(c), for example, the Gaussian models with \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f$\end{document} the standard normal density function, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M$\end{document} the inverse Laplace transform, \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t,a,b)$\end{document} the moment-generating function of a normal density function with mean \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$a$\end{document} and variance \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$b^2$\end{document}, and \documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t_0=+\infty $\end{document}.
==== Refs
References
Bang H.  & Robins J. M.   (2005 ). Doubly robust estimation in missing data and causal inference models . Biometrics 
61 , 962 –73 .16401269 
D'Haultfoeuille X.   (2010 ). A new instrumental method for dealing with endogenous selection . J. Economet. 
154 , 1 –15 .
Higgins J. P. , White I. R.  & Wood A. M.   (2008 ). Imputation methods for missing outcome data in meta-analysis of clinical trials . Clin. Trials 
5 , 225 –39 .18559412 
Ibrahim J. G. , Lipsitz S. R.  & Horton N.   (2001 ). Using auxiliary data for parameter estimation with non-ignorably missing outcomes . Appl. Statist. 
50 , 361 –73 .
Kang J. D.  & Schafer J. L.   (2007 ). Demystifying double robustness: A comparison of alternative strategies for estimating a population mean from incomplete data . Statist. Sci. 
22 , 523 –39 .
Kott P. S.   (2014 ). Calibration weighting when model and calibration variables can differ. In Contributions to Sampling Statistics, F. Mecatti, L. P. Conti & G. M. Ranalli, eds. Cham: Springer, pp. 1–18 .
Miao W. , Ding P.  & Geng Z.   (2015 ). Identifiability of normal and normal mixture models with nonignorable missing data. J. Am. Statist. Assoc. doi: 10.1080/01621459.2015.1105808 .
Robins J. M. , Rotnitzky A.  & Zhao L. P.   (1994 ). Estimation of regression coefficients when some regressors are not always observed . J. Am. Statist. Assoc. 
89 , 846 –66 .
Robins J. , Sued M. , Lei-Gomez Q.  & Rotnitzky A.   (2007 ). Comment: Performance of double-robust estimators when “inverse probability” weights are highly variable . Statist. Sci. 
22 , 544 –59 .
Robins J. , Li L. , Tchetgen Tchetgen E.  & van der Vaart A.   (2008 ). Higher order influence functions and minimax estimation of nonlinear functionals. In Probability and Statistics: Essays in Honor of David A. Freedman, D. Nolan & T. P. Speed, eds., vol. 2. Beachwood, Ohio: Institute of Mathematical Statistics, pp. 335–421 .
Scharfstein D. O. , Rotnitzky A.  & Robins J. M.   (1999 ). Adjusting for nonignorable drop-out using semiparametric nonresponse models . J. Am. Statist. Assoc. 
94 , 1096 –120 .
Tsiatis A.   (2006 ). Semiparametric Theory and Missing Data . New York : Springer .
Van der Laan M. J.  & Robins J. M.   (2003 ). Unified Methods for Censored Longitudinal Data and Causality . New York : Springer .
Vansteelandt S. , Rotnitzky A.  & Robins J.   (2007 ). Estimation of regression models for the mean of repeated outcomes under nonignorable nonmonotone nonresponse . Biometrika 
94 , 841 –60 .
Vermeulen K.  & Vansteelandt S.   (2015 ). Biased-reduced doubly robust estimation . J. Am. Statist. Assoc. 
110 , 1024 –36 .
Wang S. , Shao J.  & Kim J. K.   (2014 ). An instrumental variable approach for identification and estimation with nonignorable nonresponse . Statist. Sinica 
24 , 1097 –116 .
Zahner G. E. , Pawelkiewicz W. , DeFrancesco J. J.  & Adnopoz J.   (1992 ). Children's mental health service needs and utilization patterns in an urban community: an epidemiological assessment . J. Am. Acad. Child Adolesc. Psychiat. 
31 , 951 –60 .
Zhao J.  & Shao J.   (2015 ). Semiparametric pseudo-likelihoods in generalized linear models with nonignorable missing data . J. Am. Statist. Assoc. 
110 , 1577 –90 .
